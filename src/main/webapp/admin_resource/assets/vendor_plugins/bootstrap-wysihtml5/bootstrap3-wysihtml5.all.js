if(Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get){(function(){var a=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return a.get.call(this)},set:function(b){return a.set.call(this,b)}})})()}if(!Array.isArray){Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}}var wysihtml5={version:"0.4.15",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\uFEFF",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};(function(a,b){if(typeof define=="function"&&define.amd){define(a)}else{b.rangy=a()}})(function(){var A="object",o="function",H="undefined";var m=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var l=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];var G=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];var F=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function t(J,K){var L=typeof J[K];return L==o||(!!(L==A&&J[K]))||L=="unknown"}function u(J,K){return !!(typeof J[K]==A&&J[K])}function v(J,K){return typeof J[K]!=H}function j(J){return function(L,M){var K=M.length;while(K--){if(!J(L,M[K])){return false}}return true}}var e=j(t);var f=j(u);var g=j(v);function w(J){return J&&e(J,F)&&g(J,G)}function p(J){return u(J,"body")?J.body:J.getElementsByTagName("body")[0]}var z={};var d={version:"1.3alpha.20140804",initialized:false,supported:true,util:{isHostMethod:t,isHostObject:u,isHostProperty:v,areHostMethods:e,areHostObjects:f,areHostProperties:g,isTextRange:w,getBody:p},features:{},modules:z,config:{alertOnFail:true,alertOnWarn:false,preferTextRange:false,autoInitialize:(typeof rangyAutoInitialize==H)?true:rangyAutoInitialize}};function h(J){if(u(window,"console")&&t(window.console,"log")){window.console.log(J)}}function b(J,K){if(K){window.alert(J)}else{h(J)}}function n(J){d.initialized=true;d.supported=false;b("Rangy is not supported on this page in your browser. Reason: "+J,d.config.alertOnFail)}d.fail=n;function I(J){b("Rangy warning: "+J,d.config.alertOnWarn)}d.warn=I;if({}.hasOwnProperty){d.util.extend=function(M,O,J){var L,N;for(var K in O){if(O.hasOwnProperty(K)){L=M[K];N=O[K];if(J&&L!==null&&typeof L=="object"&&N!==null&&typeof N=="object"){d.util.extend(L,N,true)}M[K]=N}}if(O.hasOwnProperty("toString")){M.toString=O.toString}return M}}else{n("hasOwnProperty not supported")}(function(){var K=document.createElement("div");K.appendChild(document.createElement("span"));var L=[].slice;var M;try{if(L.call(K.childNodes,0)[0].nodeType==1){M=function(N){return L.call(N,0)}}}catch(J){}if(!M){M=function(O){var N=[];for(var P=0,Q=O.length;P<Q;++P){N[P]=O[P]}return N}}d.util.toArray=M})();var a;if(t(document,"addEventListener")){a=function(L,J,K){L.addEventListener(J,K,false)}}else{if(t(document,"attachEvent")){a=function(L,J,K){L.attachEvent("on"+J,K)}}else{n("Document does not have required addEventListener or attachEvent method")}}d.util.addListener=a;var s=[];function q(J){return J.message||J.description||String(J)}function r(){if(d.initialized){return}var S;var N=false,O=false;if(t(document,"createRange")){S=document.createRange();if(e(S,l)&&g(S,m)){N=true}}var J=p(document);if(!J||J.nodeName.toLowerCase()!="body"){n("No body element found");return}if(J&&t(J,"createTextRange")){S=J.createTextRange();if(w(S)){O=true}}if(!N&&!O){n("Neither Range nor TextRange are available");return}d.initialized=true;d.features={implementsDomRange:N,implementsTextRange:O};var Q,K;for(var R in z){if((Q=z[R]) instanceof y){Q.init(Q,d)}}for(var M=0,P=s.length;M<P;++M){try{s[M](d)}catch(L){K="Rangy init listener threw an exception. Continuing. Detail: "+q(L);h(K)}}}d.init=r;d.addInitListener=function(J){if(d.initialized){J(d)}else{s.push(J)}};var E=[];d.addShimListener=function(J){E.push(J)};function D(L){L=L||window;r();for(var J=0,K=E.length;J<K;++J){E[J](L)}}d.shim=d.createMissingNativeApi=D;function y(L,J,K){this.name=L;this.dependencies=J;this.initialized=false;this.supported=false;this.initializer=K}y.prototype={init:function(){var N=this.dependencies||[];for(var J=0,K=N.length,M,L;J<K;++J){L=N[J];M=z[L];if(!M||!(M instanceof y)){throw new Error("required module '"+L+"' not found")}M.init();if(!M.supported){throw new Error("required module '"+L+"' not supported")}}this.initializer(this)},fail:function(J){this.initialized=true;this.supported=false;throw new Error("Module '"+this.name+"' failed to load: "+J)},warn:function(J){d.warn("Module "+this.name+": "+J)},deprecationNotice:function(J,K){d.warn("DEPRECATED: "+J+" in module "+this.name+"is deprecated. Please use "+K+" instead")},createError:function(J){return new Error("Error in Rangy "+this.name+" module: "+J)}};function i(L,M,J,K){var N=new y(M,J,function(Q){if(!Q.initialized){Q.initialized=true;try{K(d,Q);Q.supported=true}catch(P){var O="Module '"+M+"' failed to load: "+q(P);h(O)}}});z[M]=N}d.createModule=function(M){var K,J;if(arguments.length==2){K=arguments[1];J=[]}else{K=arguments[2];J=arguments[1]}var L=i(false,M,J,K);if(d.initialized){L.init()}};d.createCoreModule=function(L,J,K){i(true,L,J,K)};function B(){}d.RangePrototype=B;d.rangePrototype=new B();function C(){}d.selectionPrototype=new C();var k=false;var x=function(J){if(!k){k=true;if(!d.initialized&&d.config.autoInitialize){r()}}};if(typeof window==H){n("No window found");return}if(typeof document==H){n("No document found");return}if(t(document,"addEventListener")){document.addEventListener("DOMContentLoaded",x,false)}a(window,"load",x);d.createCoreModule("DomUtil",[],function(J,am){var ar="undefined";var at=J.util;if(!at.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){am.fail("document missing a Node creation method")}if(!at.isHostMethod(document,"getElementsByTagName")){am.fail("document missing getElementsByTagName method")}var Q=document.createElement("div");if(!at.areHostMethods(Q,["insertBefore","appendChild","cloneNode"]||!at.areHostObjects(Q,["previousSibling","nextSibling","childNodes","parentNode"]))){am.fail("Incomplete Element implementation")}if(!at.isHostProperty(Q,"innerHTML")){am.fail("Element is missing innerHTML property")}var aq=document.createTextNode("test");if(!at.areHostMethods(aq,["splitText","deleteData","insertData","appendData","cloneNode"]||!at.areHostObjects(Q,["previousSibling","nextSibling","childNodes","parentNode"])||!at.areHostProperties(aq,["data"]))){am.fail("Incomplete Text Node implementation")}var K=function(au,aw){var av=au.length;while(av--){if(au[av]===aw){return true}}return false};function ai(au){var av;return typeof au.namespaceURI==ar||((av=au.namespaceURI)===null||av=="http://www.w3.org/1999/xhtml")}function ao(au){var av=au.parentNode;return(av.nodeType==1)?av:null}function Z(av){var au=0;while((av=av.previousSibling)){++au}return au}function aa(au){switch(au.nodeType){case 7:case 10:return 0;case 3:case 8:return au.length;default:return au.childNodes.length}}function T(aw,ax){var au=[],av;for(av=aw;av;av=av.parentNode){au.push(av)}for(av=ax;av;av=av.parentNode){if(K(au,av)){return av}}return null}function af(au,av,ax){var aw=ax?av:av.parentNode;while(aw){if(aw===au){return true}else{aw=aw.parentNode}}return false}function aj(au,av){return af(au,av,true)}function S(aw,au,ay){var ax,av=ay?aw:aw.parentNode;while(av){ax=av.parentNode;if(ax===au){return av}av=ax}return null}function ah(au){var av=au.nodeType;return av==3||av==4||av==8}function ak(au){if(!au){return false}var av=au.nodeType;return av==3||av==8}function ad(av,ax){var au=ax.nextSibling,aw=ax.parentNode;if(au){aw.insertBefore(av,au)}else{aw.appendChild(av)}return av}function ap(ax,av,az){var aw=ax.cloneNode(false);aw.deleteData(0,av);ax.deleteData(av,ax.length-av);ad(aw,ax);if(az){for(var au=0,ay;ay=az[au++];){if(ay.node==ax&&ay.offset>av){ay.node=aw;ay.offset-=av}else{if(ay.node==ax.parentNode&&ay.offset>Z(ax)){++ay.offset}}}}return aw}function W(au){if(au.nodeType==9){return au}else{if(typeof au.ownerDocument!=ar){return au.ownerDocument}else{if(typeof au.document!=ar){return au.document}else{if(au.parentNode){return W(au.parentNode)}else{throw am.createError("getDocument: no document found for node")}}}}}function ac(av){var au=W(av);if(typeof au.defaultView!=ar){return au.defaultView}else{if(typeof au.parentWindow!=ar){return au.parentWindow}else{throw am.createError("Cannot get a window object for node")}}}function X(au){if(typeof au.contentDocument!=ar){return au.contentDocument}else{if(typeof au.contentWindow!=ar){return au.contentWindow.document}else{throw am.createError("getIframeDocument: No Document object found for iframe element")}}}function Y(au){if(typeof au.contentWindow!=ar){return au.contentWindow}else{if(typeof au.contentDocument!=ar){return au.contentDocument.defaultView}else{throw am.createError("getIframeWindow: No Window object found for iframe element")}}}function al(au){return au&&at.isHostMethod(au,"setTimeout")&&at.isHostObject(au,"document")}function V(ax,aw,av){var au;if(!ax){au=document}else{if(at.isHostProperty(ax,"nodeType")){au=(ax.nodeType==1&&ax.tagName.toLowerCase()=="iframe")?X(ax):W(ax)}else{if(al(ax)){au=ax.document}}}if(!au){throw aw.createError(av+"(): Parameter must be a Window object or DOM node")}return au}function ab(au){var av;while((av=au.parentNode)){au=av}return au}function L(ax,aA,ay,aB){var az,aC,au,av,aw;if(ax==ay){return aA===aB?0:(aA<aB)?-1:1}else{if((az=S(ay,ax,true))){return aA<=Z(az)?-1:1}else{if((az=S(ax,ay,true))){return Z(az)<aB?-1:1}else{aC=T(ax,ay);if(!aC){throw new Error("comparePoints error: nodes have no common ancestor")}au=(ax===aC)?aC:S(ax,aC,true);av=(ay===aC)?aC:S(ay,aC,true);if(au===av){throw am.createError("comparePoints got to case 4 and childA and childB are the same!")}else{aw=aC.firstChild;while(aw){if(aw===au){return -1}else{if(aw===av){return 1}}aw=aw.nextSibling}}}}}}var M=false;function ag(aw){var av;try{av=aw.parentNode;return false}catch(au){return true}}(function(){var au=document.createElement("b");au.innerHTML="1";var av=au.firstChild;au.innerHTML="<br>";M=ag(av);J.features.crashyTextNodes=M})();function ae(av){if(!av){return"[No node]"}if(M&&ag(av)){return"[Broken node]"}if(ah(av)){return'"'+av.data+'"'}if(av.nodeType==1){var au=av.id?' id="'+av.id+'"':"";return"<"+av.nodeName+au+">[index:"+Z(av)+",length:"+av.childNodes.length+"]["+(av.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return av.nodeName}function R(aw){var av=W(aw).createDocumentFragment(),au;while((au=aw.firstChild)){av.appendChild(au)}return av}var U;if(typeof window.getComputedStyle!=ar){U=function(au,av){return ac(au).getComputedStyle(au,null)[av]}}else{if(typeof document.documentElement.currentStyle!=ar){U=function(au,av){return au.currentStyle[av]}}else{am.fail("No means of obtaining computed style properties found")}}function an(au){this.root=au;this._next=au}an.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){var av=this._current=this._next;var au,aw;if(this._current){au=av.firstChild;if(au){this._next=au}else{aw=null;while((av!==this.root)&&!(aw=av.nextSibling)){av=av.parentNode}this._next=aw}}return this._current},detach:function(){this._current=this._next=this.root=null}};function N(au){return new an(au)}function P(au,av){this.node=au;this.offset=av}P.prototype={equals:function(au){return !!au&&this.node===au.node&&this.offset==au.offset},inspect:function(){return"[DomPosition("+ae(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function O(au){this.code=this[au];this.codeName=au;this.message="DOMException: "+this.codeName}O.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};O.prototype.toString=function(){return this.message};J.dom={arrayContains:K,isHtmlNamespace:ai,parentElement:ao,getNodeIndex:Z,getNodeLength:aa,getCommonAncestor:T,isAncestorOf:af,isOrIsAncestorOf:aj,getClosestAncestorIn:S,isCharacterDataNode:ah,isTextOrCommentNode:ak,insertAfter:ad,splitDataNode:ap,getDocument:W,getWindow:ac,getIframeWindow:Y,getIframeDocument:X,getBody:at.getBody,isWindow:al,getContentDocument:V,getRootContainer:ab,comparePoints:L,isBrokenNode:ag,inspectNode:ae,getComputedStyleProperty:U,fragmentFromNodeChildren:R,createIterator:N,DomPosition:P};J.DOMException=O});d.createCoreModule("DomRange",["DomUtil"],function(J,aI){var ad=J.dom;var a2=J.util;var af=ad.DomPosition;var ae=J.DOMException;var aB=ad.isCharacterDataNode;var aq=ad.getNodeIndex;var aD=ad.isOrIsAncestorOf;var ao=ad.getDocument;var U=ad.comparePoints;var aW=ad.splitDataNode;var am=ad.getClosestAncestorIn;var ar=ad.getNodeLength;var K=ad.arrayContains;var aw=ad.getRootContainer;var X=J.features.crashyTextNodes;function aC(a3,a4){return(a3.nodeType!=3)&&(aD(a3,a4.startContainer)||aD(a3,a4.endContainer))}function au(a3){return a3.document||ao(a3.startContainer)}function al(a3){return new af(a3.parentNode,aq(a3))}function ak(a3){return new af(a3.parentNode,aq(a3)+1)}function az(a5,a4,a6){var a3=a5.nodeType==11?a5.firstChild:a5;if(aB(a4)){if(a6==a4.length){ad.insertAfter(a5,a4)}else{a4.parentNode.insertBefore(a5,a6==0?a4:aW(a4,a6))}}else{if(a6>=a4.childNodes.length){a4.appendChild(a5)}else{a4.insertBefore(a5,a4.childNodes[a6])}}return a3}function aQ(a4,a5,a7){O(a4);O(a5);if(au(a5)!=au(a4)){throw new ae("WRONG_DOCUMENT_ERR")}var a6=U(a4.startContainer,a4.startOffset,a5.endContainer,a5.endOffset),a3=U(a4.endContainer,a4.endOffset,a5.startContainer,a5.startOffset);return a7?a6<=0&&a3>=0:a6<0&&a3>0}function T(a4){var a6;for(var a5,a3=au(a4.range).createDocumentFragment(),a7;a5=a4.next();){a6=a4.isPartiallySelectedSubtree();a5=a5.cloneNode(!a6);if(a6){a7=a4.getSubtreeIterator();a5.appendChild(T(a7));a7.detach()}if(a5.nodeType==10){throw new ae("HIERARCHY_REQUEST_ERR")}a3.appendChild(a5)}return a3}function aH(a8,a3,a5){var a4,a6;a5=a5||{stop:false};for(var a7,a9;a7=a8.next();){if(a8.isPartiallySelectedSubtree()){if(a3(a7)===false){a5.stop=true;return}else{a9=a8.getSubtreeIterator();aH(a9,a3,a5);a9.detach();if(a5.stop){return}}}else{a4=ad.createIterator(a7);while((a6=a4.next())){if(a3(a6)===false){a5.stop=true;return}}}}}function ac(a3){var a4;while(a3.next()){if(a3.isPartiallySelectedSubtree()){a4=a3.getSubtreeIterator();ac(a4);a4.detach()}else{a3.remove()}}}function aj(a4){for(var a5,a3=au(a4.range).createDocumentFragment(),a6;a5=a4.next();){if(a4.isPartiallySelectedSubtree()){a5=a5.cloneNode(false);a6=a4.getSubtreeIterator();a5.appendChild(aj(a6));a6.detach()}else{a4.remove()}if(a5.nodeType==10){throw new ae("HIERARCHY_REQUEST_ERR")}a3.appendChild(a5)}return a3}function at(a8,a7,a3){var a5=!!(a7&&a7.length),a9;var a4=!!a3;if(a5){a9=new RegExp("^("+a7.join("|")+")$")}var a6=[];aH(new aO(a8,false),function(bb){if(a5&&!a9.test(bb.nodeType)){return}if(a4&&!a3(bb)){return}var bc=a8.startContainer;if(bb==bc&&aB(bc)&&a8.startOffset==bc.length){return}var ba=a8.endContainer;if(bb==ba&&aB(ba)&&a8.endOffset==0){return}a6.push(bb)});return a6}function aA(a4){var a3=(typeof a4.getName=="undefined")?"Range":a4.getName();return"["+a3+"("+ad.inspectNode(a4.startContainer)+":"+a4.startOffset+", "+ad.inspectNode(a4.endContainer)+":"+a4.endOffset+")]"}function aO(a4,a3){this.range=a4;this.clonePartiallySelectedTextNodes=a3;if(!a4.collapsed){this.sc=a4.startContainer;this.so=a4.startOffset;this.ec=a4.endContainer;this.eo=a4.endOffset;var a5=a4.commonAncestorContainer;if(this.sc===this.ec&&aB(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=(this.sc===a5&&!aB(this.sc))?this.sc.childNodes[this.so]:am(this.sc,a5,true);this._last=(this.ec===a5&&!aB(this.ec))?this.ec.childNodes[this.eo-1]:am(this.ec,a5,true)}}}aO.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return !!this._next},next:function(){var a3=this._current=this._next;if(a3){this._next=(a3!==this._last)?a3.nextSibling:null;if(aB(a3)&&this.clonePartiallySelectedTextNodes){if(a3===this.ec){(a3=a3.cloneNode(true)).deleteData(this.eo,a3.length-this.eo)}if(this._current===this.sc){(a3=a3.cloneNode(true)).deleteData(0,this.so)}}}return a3},remove:function(){var a3=this._current,a5,a4;if(aB(a3)&&(a3===this.sc||a3===this.ec)){a5=(a3===this.sc)?this.so:0;a4=(a3===this.ec)?this.eo:a3.length;if(a5!=a4){a3.deleteData(a5,a4-a5)}}else{if(a3.parentNode){a3.parentNode.removeChild(a3)}else{}}},isPartiallySelectedSubtree:function(){var a3=this._current;return aC(a3,this.range)},getSubtreeIterator:function(){var a8;if(this.isSingleCharacterDataNode){a8=this.range.cloneRange();a8.collapse(false)}else{a8=new aN(au(this.range));var a3=this._current;var a6=a3,a7=0,a4=a3,a5=ar(a3);if(aD(a3,this.sc)){a6=this.sc;a7=this.so}if(aD(a3,this.ec)){a4=this.ec;a5=this.eo}a0(a8,a6,a7,a4,a5)}return new aO(a8,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var S=[1,3,4,5,7,8,10];var aT=[2,9,11];var aS=[5,6,10,12];var ay=[1,3,4,5,7,8,10,11];var aZ=[1,3,4,5,7,8];function Y(a3){return function(a5,a6){var a7,a4=a6?a5:a5.parentNode;while(a4){a7=a4.nodeType;if(K(a3,a7)){return a4}a4=a4.parentNode}return null}}var ap=Y([9,11]);var av=Y(aS);var an=Y([6,10,12]);function N(a4,a3){if(an(a4,a3)){throw new ae("INVALID_NODE_TYPE_ERR")}}function Q(a4,a3){if(!K(a3,a4.nodeType)){throw new ae("INVALID_NODE_TYPE_ERR")}}function R(a3,a4){if(a4<0||a4>(aB(a3)?a3.length:a3.childNodes.length)){throw new ae("INDEX_SIZE_ERR")}}function P(a3,a4){if(ap(a3,true)!==ap(a4,true)){throw new ae("WRONG_DOCUMENT_ERR")}}function M(a3){if(av(a3,true)){throw new ae("NO_MODIFICATION_ALLOWED_ERR")}}function L(a4,a3){if(!a4){throw new ae(a3)}}function aE(a3){return(X&&ad.isBrokenNode(a3))||!K(aT,a3.nodeType)&&!ap(a3,true)}function aG(a3,a4){return a4<=(aB(a3)?a3.length:a3.childNodes.length)}function aF(a3){return(!!a3.startContainer&&!!a3.endContainer&&!aE(a3.startContainer)&&!aE(a3.endContainer)&&aG(a3.startContainer,a3.startOffset)&&aG(a3.endContainer,a3.endOffset))}function O(a3){if(!aF(a3)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+a3.inspect()+")")}}var aY=document.createElement("style");var ax=false;try{aY.innerHTML="<b>x</b>";ax=(aY.firstChild.nodeType==3)}catch(ag){}J.features.htmlParsingConforms=ax;var Z=ax?function(a5){var a6=this.startContainer;var a3=ao(a6);if(!a6){throw new ae("INVALID_STATE_ERR")}var a4=null;if(a6.nodeType==1){a4=a6}else{if(aB(a6)){a4=ad.parentElement(a6)}}if(a4===null||(a4.nodeName=="HTML"&&ad.isHtmlNamespace(ao(a4).documentElement)&&ad.isHtmlNamespace(a4))){a4=a3.createElement("body")}else{a4=a4.cloneNode(false)}a4.innerHTML=a5;return ad.fragmentFromNodeChildren(a4)}:function(a5){var a3=au(this);var a4=a3.createElement("body");a4.innerHTML=a5;return ad.fragmentFromNodeChildren(a4)};function aX(a6,a5){O(a6);var a7=a6.startContainer,a8=a6.startOffset,a3=a6.endContainer,a4=a6.endOffset;var a9=(a7===a3);if(aB(a3)&&a4>0&&a4<a3.length){aW(a3,a4,a5)}if(aB(a7)&&a8>0&&a8<a7.length){a7=aW(a7,a8,a5);if(a9){a4-=a8;a3=a7}else{if(a3==a7.parentNode&&a4>=aq(a7)){a4++}}a8=0}a6.setStartAndEnd(a7,a8,a3,a4)}function aR(a4){O(a4);var a3=a4.commonAncestorContainer.parentNode.cloneNode(false);a3.appendChild(a4.cloneContents());return a3.innerHTML}var aP=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var aV=0,aU=1,ah=2,ai=3;var aK=0,aJ=1,aL=2,aM=3;a2.extend(J.rangePrototype,{compareBoundaryPoints:function(a3,ba){O(this);P(this.startContainer,ba.startContainer);var a4,a6,a5,a7;var a8=(a3==ai||a3==aV)?"start":"end";var a9=(a3==aU||a3==aV)?"start":"end";a4=this[a8+"Container"];a6=this[a8+"Offset"];a5=ba[a9+"Container"];a7=ba[a9+"Offset"];return U(a4,a6,a5,a7)},insertNode:function(a4){O(this);Q(a4,ay);M(this.startContainer);if(aD(a4,this.startContainer)){throw new ae("HIERARCHY_REQUEST_ERR")}var a3=az(a4,this.startContainer,this.startOffset);this.setStartBefore(a3)},cloneContents:function(){O(this);var a3,a4;if(this.collapsed){return au(this).createDocumentFragment()}else{if(this.startContainer===this.endContainer&&aB(this.startContainer)){a3=this.startContainer.cloneNode(true);a3.data=a3.data.slice(this.startOffset,this.endOffset);a4=au(this).createDocumentFragment();a4.appendChild(a3);return a4}else{var a5=new aO(this,true);a3=T(a5);a5.detach()}return a3}},canSurroundContents:function(){O(this);M(this.startContainer);M(this.endContainer);var a4=new aO(this,true);var a3=(a4._first&&(aC(a4._first,this))||(a4._last&&aC(a4._last,this)));a4.detach();return !a3},surroundContents:function(a4){Q(a4,aZ);if(!this.canSurroundContents()){throw new ae("INVALID_STATE_ERR")}var a3=this.extractContents();if(a4.hasChildNodes()){while(a4.lastChild){a4.removeChild(a4.lastChild)}}az(a4,this.startContainer,this.startOffset);a4.appendChild(a3);this.selectNode(a4)},cloneRange:function(){O(this);var a5=new aN(au(this));var a3=aP.length,a4;while(a3--){a4=aP[a3];a5[a4]=this[a4]}return a5},toString:function(){O(this);var a4=this.startContainer;if(a4===this.endContainer&&aB(a4)){return(a4.nodeType==3||a4.nodeType==4)?a4.data.slice(this.startOffset,this.endOffset):""}else{var a5=[],a3=new aO(this,true);aH(a3,function(a6){if(a6.nodeType==3||a6.nodeType==4){a5.push(a6.data)}});a3.detach();return a5.join("")}},compareNode:function(a4){O(this);var a6=a4.parentNode;var a5=aq(a4);if(!a6){throw new ae("NOT_FOUND_ERR")}var a7=this.comparePoint(a6,a5),a3=this.comparePoint(a6,a5+1);if(a7<0){return(a3>0)?aL:aK}else{return(a3>0)?aJ:aM}},comparePoint:function(a3,a4){O(this);L(a3,"HIERARCHY_REQUEST_ERR");P(a3,this.startContainer);if(U(a3,a4,this.startContainer,this.startOffset)<0){return -1}else{if(U(a3,a4,this.endContainer,this.endOffset)>0){return 1}}return 0},createContextualFragment:Z,toHtml:function(){return aR(this)},intersectsNode:function(a4,a8){O(this);L(a4,"NOT_FOUND_ERR");if(ao(a4)!==au(this)){return false}var a6=a4.parentNode,a5=aq(a4);L(a6,"NOT_FOUND_ERR");var a7=U(a6,a5,this.endContainer,this.endOffset),a3=U(a6,a5+1,this.startContainer,this.startOffset);return a8?a7<=0&&a3>=0:a7<0&&a3>0},isPointInRange:function(a3,a4){O(this);L(a3,"HIERARCHY_REQUEST_ERR");P(a3,this.startContainer);return(U(a3,a4,this.startContainer,this.startOffset)>=0)&&(U(a3,a4,this.endContainer,this.endOffset)<=0)},intersectsRange:function(a3){return aQ(this,a3,false)},intersectsOrTouchesRange:function(a3){return aQ(this,a3,true)},intersection:function(a5){if(this.intersectsRange(a5)){var a6=U(this.startContainer,this.startOffset,a5.startContainer,a5.startOffset),a3=U(this.endContainer,this.endOffset,a5.endContainer,a5.endOffset);var a4=this.cloneRange();if(a6==-1){a4.setStart(a5.startContainer,a5.startOffset)}if(a3==1){a4.setEnd(a5.endContainer,a5.endOffset)}return a4}return null},union:function(a3){if(this.intersectsOrTouchesRange(a3)){var a4=this.cloneRange();if(U(a3.startContainer,a3.startOffset,this.startContainer,this.startOffset)==-1){a4.setStart(a3.startContainer,a3.startOffset)}if(U(a3.endContainer,a3.endOffset,this.endContainer,this.endOffset)==1){a4.setEnd(a3.endContainer,a3.endOffset)}return a4}else{throw new ae("Ranges do not intersect")}},containsNode:function(a4,a3){if(a3){return this.intersectsNode(a4,false)}else{return this.compareNode(a4)==aM}},containsNodeContents:function(a3){return this.comparePoint(a3,0)>=0&&this.comparePoint(a3,ar(a3))<=0},containsRange:function(a4){var a3=this.intersection(a4);return a3!==null&&a4.equals(a3)},containsNodeText:function(a4){var a5=this.cloneRange();a5.selectNode(a4);var a6=a5.getNodes([3]);if(a6.length>0){a5.setStart(a6[0],0);var a3=a6.pop();a5.setEnd(a3,a3.length);return this.containsRange(a5)}else{return this.containsNodeContents(a4)}},getNodes:function(a4,a3){O(this);return at(this,a4,a3)},getDocument:function(){return au(this)},collapseBefore:function(a3){this.setEndBefore(a3);this.collapse(false)},collapseAfter:function(a3){this.setStartAfter(a3);this.collapse(true)},getBookmark:function(a3){var a4=au(this);var a6=J.createRange(a4);a3=a3||ad.getBody(a4);a6.selectNodeContents(a3);var a7=this.intersection(a6);var a8=0,a5=0;if(a7){a6.setEnd(a7.startContainer,a7.startOffset);a8=a6.toString().length;a5=a8+a7.toString().length}return{start:a8,end:a5,containerNode:a3}},moveToBookmark:function(a3){var a6=a3.containerNode;var a4=0;this.setStart(a6,0);this.collapse(true);var bb=[a6],ba,a7=false,bc=false;var a9,a8,a5;while(!bc&&(ba=bb.pop())){if(ba.nodeType==3){a9=a4+ba.length;if(!a7&&a3.start>=a4&&a3.start<=a9){this.setStart(ba,a3.start-a4);a7=true}if(a7&&a3.end>=a4&&a3.end<=a9){this.setEnd(ba,a3.end-a4);bc=true}a4=a9}else{a5=ba.childNodes;a8=a5.length;while(a8--){bb.push(a5[a8])}}}},getName:function(){return"DomRange"},equals:function(a3){return aN.rangesEqual(this,a3)},isValid:function(){return aF(this)},inspect:function(){return aA(this)},detach:function(){}});function W(a3){a3.START_TO_START=aV;a3.START_TO_END=aU;a3.END_TO_END=ah;a3.END_TO_START=ai;a3.NODE_BEFORE=aK;a3.NODE_AFTER=aJ;a3.NODE_BEFORE_AND_AFTER=aL;a3.NODE_INSIDE=aM}function V(a3){W(a3);W(a3.prototype)}function ab(a4,a3){return function(){O(this);var ba=this.startContainer,bb=this.startOffset,a9=this.commonAncestorContainer;var a6=new aO(this,true);var a7,a5;if(ba!==a9){a7=am(ba,a9,true);a5=ak(a7);ba=a5.node;bb=a5.offset}aH(a6,M);a6.reset();var a8=a4(a6);a6.detach();a3(this,ba,bb,ba,bb);return a8}}function aa(a4,a3){function a5(a9,ba){return function(bc){Q(bc,S);Q(aw(bc),aT);var bb=(a9?al:ak)(bc);(ba?a8:a7)(this,bb.node,bb.offset)}}function a8(bd,bb,bc){var a9=bd.endContainer,ba=bd.endOffset;if(bb!==bd.startContainer||bc!==bd.startOffset){if(aw(bb)!=aw(a9)||U(bb,bc,a9,ba)==1){a9=bb;ba=bc}a3(bd,bb,bc,a9,ba)}}function a7(bb,a9,ba){var bc=bb.startContainer,bd=bb.startOffset;if(a9!==bb.endContainer||ba!==bb.endOffset){if(aw(a9)!=aw(bc)||U(a9,ba,bc,bd)==-1){bc=a9;bd=ba}a3(bb,bc,bd,a9,ba)}}var a6=function(){};a6.prototype=J.rangePrototype;a4.prototype=new a6();a2.extend(a4.prototype,{setStart:function(a9,ba){N(a9,true);R(a9,ba);a8(this,a9,ba)},setEnd:function(a9,ba){N(a9,true);R(a9,ba);a7(this,a9,ba)},setStartAndEnd:function(){var a9=arguments;var bc=a9[0],bd=a9[1],ba=bc,bb=bd;switch(a9.length){case 3:bb=a9[2];break;case 4:ba=a9[2];bb=a9[3];break}a3(this,bc,bd,ba,bb)},setBoundary:function(ba,bb,a9){this["set"+(a9?"Start":"End")](ba,bb)},setStartBefore:a5(true,true),setStartAfter:a5(false,true),setEndBefore:a5(true,false),setEndAfter:a5(false,false),collapse:function(a9){O(this);if(a9){a3(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)}else{a3(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)}},selectNodeContents:function(a9){N(a9,true);a3(this,a9,0,a9,ar(a9))},selectNode:function(ba){N(ba,false);Q(ba,S);var bb=al(ba),a9=ak(ba);a3(this,bb.node,bb.offset,a9.node,a9.offset)},extractContents:ab(aj,a3),deleteContents:ab(ac,a3),canSurroundContents:function(){O(this);M(this.startContainer);M(this.endContainer);var ba=new aO(this,true);var a9=(ba._first&&aC(ba._first,this)||(ba._last&&aC(ba._last,this)));ba.detach();return !a9},splitBoundaries:function(){aX(this)},splitBoundariesPreservingPositions:function(a9){aX(this,a9)},normalizeBoundaries:function(){O(this);var bf=this.startContainer,bg=this.startOffset,a9=this.endContainer,bb=this.endOffset;var bd=function(bi){var bj=bi.nextSibling;if(bj&&bj.nodeType==bi.nodeType){a9=bi;bb=bi.length;bi.appendData(bj.data);bj.parentNode.removeChild(bj)}};var bc=function(bi){var bl=bi.previousSibling;if(bl&&bl.nodeType==bi.nodeType){bf=bi;var bk=bi.length;bg=bl.length;bi.insertData(0,bl.data);bl.parentNode.removeChild(bl);if(bf==a9){bb+=bg;a9=bf}else{if(a9==bi.parentNode){var bj=aq(bi);if(bb==bj){a9=bi;bb=bk}else{if(bb>bj){bb--}}}}}};var be=true;if(aB(a9)){if(a9.length==bb){bd(a9)}}else{if(bb>0){var ba=a9.childNodes[bb-1];if(ba&&aB(ba)){bd(ba)}}be=!this.collapsed}if(be){if(aB(bf)){if(bg==0){bc(bf)}}else{if(bg<bf.childNodes.length){var bh=bf.childNodes[bg];if(bh&&aB(bh)){bc(bh)}}}}else{bf=a9;bg=bb}a3(this,bf,bg,a9,bb)},collapseToPoint:function(a9,ba){N(a9,true);R(a9,ba);this.setStartAndEnd(a9,ba)}});V(a4)}function a1(a3){a3.collapsed=(a3.startContainer===a3.endContainer&&a3.startOffset===a3.endOffset);a3.commonAncestorContainer=a3.collapsed?a3.startContainer:ad.getCommonAncestor(a3.startContainer,a3.endContainer)}function a0(a5,a6,a7,a3,a4){a5.startContainer=a6;a5.startOffset=a7;a5.endContainer=a3;a5.endOffset=a4;a5.document=ad.getDocument(a6);a1(a5)}function aN(a3){this.startContainer=a3;this.startOffset=0;this.endContainer=a3;this.endOffset=0;this.document=a3;a1(this)}aa(aN,a0);a2.extend(aN,{rangeProperties:aP,RangeIterator:aO,copyComparisonConstants:V,createPrototypeRange:aa,inspect:aA,toHtml:aR,getRangeDocument:au,rangesEqual:function(a3,a4){return a3.startContainer===a4.startContainer&&a3.startOffset===a4.startOffset&&a3.endContainer===a4.endContainer&&a3.endOffset===a4.endOffset}});J.DomRange=aN});d.createCoreModule("WrappedRange",["DomRange"],function(J,U){var Y,Z;var L=J.dom;var X=J.util;var M=L.DomPosition;var N=J.DomRange;var O=L.getBody;var P=L.getContentDocument;var T=L.isCharacterDataNode;if(J.features.implementsDomRange){(function(){var ah;var ag=N.rangeProperties;function al(ao){var am=ag.length,an;while(am--){an=ag[am];ao[an]=ao.nativeRange[an]}ao.collapsed=(ao.startContainer===ao.endContainer&&ao.startOffset===ao.endOffset)}function ak(aq,ar,au,am,ao){var at=(aq.startContainer!==ar||aq.startOffset!=au);var an=(aq.endContainer!==am||aq.endOffset!=ao);var ap=!aq.equals(aq.nativeRange);if(at||an||ap){aq.setEnd(am,ao);aq.setStart(ar,au)}}var ab;Y=function(am){if(!am){throw U.createError("WrappedRange: Range must be specified")}this.nativeRange=am;al(this)};N.createPrototypeRange(Y,ak);ah=Y.prototype;ah.selectNode=function(am){this.nativeRange.selectNode(am);al(this)};ah.cloneContents=function(){return this.nativeRange.cloneContents()};ah.surroundContents=function(am){this.nativeRange.surroundContents(am);al(this)};ah.collapse=function(am){this.nativeRange.collapse(am);al(this)};ah.cloneRange=function(){return new Y(this.nativeRange.cloneRange())};ah.refresh=function(){al(this)};ah.toString=function(){return this.nativeRange.toString()};var ai=document.createTextNode("test");O(document).appendChild(ai);var ae=document.createRange();ae.setStart(ai,0);ae.setEnd(ai,0);try{ae.setStart(ai,1);ah.setStart=function(am,an){this.nativeRange.setStart(am,an);al(this)};ah.setEnd=function(am,an){this.nativeRange.setEnd(am,an);al(this)};ab=function(am){return function(an){this.nativeRange[am](an);al(this)}}}catch(ad){ah.setStart=function(an,ao){try{this.nativeRange.setStart(an,ao)}catch(am){this.nativeRange.setEnd(an,ao);this.nativeRange.setStart(an,ao)}al(this)};ah.setEnd=function(an,ao){try{this.nativeRange.setEnd(an,ao)}catch(am){this.nativeRange.setStart(an,ao);this.nativeRange.setEnd(an,ao)}al(this)};ab=function(am,an){return function(ap){try{this.nativeRange[am](ap)}catch(ao){this.nativeRange[an](ap);this.nativeRange[am](ap)}al(this)}}}ah.setStartBefore=ab("setStartBefore","setEndBefore");ah.setStartAfter=ab("setStartAfter","setEndAfter");ah.setEndBefore=ab("setEndBefore","setStartBefore");ah.setEndAfter=ab("setEndAfter","setStartAfter");ah.selectNodeContents=function(am){this.setStartAndEnd(am,0,L.getNodeLength(am))};ae.selectNodeContents(ai);ae.setEnd(ai,3);var af=document.createRange();af.selectNodeContents(ai);af.setEnd(ai,4);af.setStart(ai,2);if(ae.compareBoundaryPoints(ae.START_TO_END,af)==-1&&ae.compareBoundaryPoints(ae.END_TO_START,af)==1){ah.compareBoundaryPoints=function(an,am){am=am.nativeRange||am;if(an==am.START_TO_END){an=am.END_TO_START}else{if(an==am.END_TO_START){an=am.START_TO_END}}return this.nativeRange.compareBoundaryPoints(an,am)}}else{ah.compareBoundaryPoints=function(an,am){return this.nativeRange.compareBoundaryPoints(an,am.nativeRange||am)}}var ac=document.createElement("div");ac.innerHTML="123";var aj=ac.firstChild;var aa=O(document);aa.appendChild(ac);ae.setStart(aj,1);ae.setEnd(aj,2);ae.deleteContents();if(aj.data=="13"){ah.deleteContents=function(){this.nativeRange.deleteContents();al(this)};ah.extractContents=function(){var am=this.nativeRange.extractContents();al(this);return am}}else{}aa.removeChild(ac);aa=null;if(X.isHostMethod(ae,"createContextualFragment")){ah.createContextualFragment=function(am){return this.nativeRange.createContextualFragment(am)}}O(document).removeChild(ai);ah.getName=function(){return"WrappedRange"};J.WrappedRange=Y;J.createNativeRange=function(am){am=P(am,U,"createNativeRange");return am.createRange()}})()}if(J.features.implementsTextRange){var R=function(af){var ab=af.parentElement();var ac=af.duplicate();ac.collapse(true);var ad=ac.parentElement();ac=af.duplicate();ac.collapse(false);var aa=ac.parentElement();var ae=(ad==aa)?ad:L.getCommonAncestor(ad,aa);return ae==ab?ae:L.getCommonAncestor(ab,ae)};var W=function(aa){return aa.compareEndPoints("StartToEnd",aa)==0};var Q=function(ar,at,ah,ag,ap){var aw=ar.duplicate();aw.collapse(ah);var ae=aw.parentElement();if(!L.isOrIsAncestorOf(at,ae)){ae=at}if(!ae.canHaveHTML){var al=new M(ae.parentNode,L.getNodeIndex(ae));return{boundaryPosition:al,nodeInfo:{nodeIndex:al.offset,containerElement:al.node}}}var av=L.getDocument(ae).createElement("span");if(av.parentNode){av.parentNode.removeChild(av)}var ad,au=ah?"StartToStart":"StartToEnd";var am,ai,ab,aa;var ao=(ap&&ap.containerElement==ae)?ap.nodeIndex:0;var ac=ae.childNodes.length;var af=ac;var aj=af;while(true){if(aj==ac){ae.appendChild(av)}else{ae.insertBefore(av,ae.childNodes[aj])}aw.moveToElementText(av);ad=aw.compareEndPoints(au,ar);if(ad==0||ao==af){break}else{if(ad==-1){if(af==ao+1){break}else{ao=aj}}else{af=(af==ao+1)?ao:aj}}aj=Math.floor((ao+af)/2);ae.removeChild(av)}aa=av.nextSibling;if(ad==-1&&aa&&T(aa)){aw.setEndPoint(ah?"EndToStart":"EndToEnd",ar);var ak;if(/[\r\n]/.test(aa.data)){var aq=aw.duplicate();var an=aq.text.replace(/\r\n/g,"\r").length;ak=aq.moveStart("character",an);while((ad=aq.compareEndPoints("StartToEnd",aq))==-1){ak++;aq.moveStart("character",1)}}else{ak=aw.text.length}ab=new M(aa,ak)}else{am=(ag||!ah)&&av.previousSibling;ai=(ag||ah)&&av.nextSibling;if(ai&&T(ai)){ab=new M(ai,0)}else{if(am&&T(am)){ab=new M(am,am.data.length)}else{ab=new M(ae,L.getNodeIndex(av))}}}av.parentNode.removeChild(av);return{boundaryPosition:ab,nodeInfo:{nodeIndex:aj,containerElement:ae}}};var K=function(ad,ag){var aa,ac,ab=ad.offset;var af=L.getDocument(ad.node);var ai,ae,aj=O(af).createTextRange();var ah=T(ad.node);if(ah){aa=ad.node;ac=aa.parentNode}else{ae=ad.node.childNodes;aa=(ab<ae.length)?ae[ab]:null;ac=ad.node}ai=af.createElement("span");ai.innerHTML="&#feff;";if(aa){ac.insertBefore(ai,aa)}else{ac.appendChild(ai)}aj.moveToElementText(ai);aj.collapse(!ag);ac.removeChild(ai);if(ah){aj[ag?"moveStart":"moveEnd"]("character",ab)}return aj};Z=function(aa){this.textRange=aa;this.refresh()};Z.prototype=new N(document);Z.prototype.refresh=function(){var ac,aa,ad;var ab=R(this.textRange);if(W(this.textRange)){aa=ac=Q(this.textRange,ab,true,true).boundaryPosition}else{ad=Q(this.textRange,ab,true,false);ac=ad.boundaryPosition;aa=Q(this.textRange,ab,false,false,ad.nodeInfo).boundaryPosition}this.setStart(ac.node,ac.offset);this.setEnd(aa.node,aa.offset)};Z.prototype.getName=function(){return"WrappedTextRange"};N.copyComparisonConstants(Z);var V=function(ab){if(ab.collapsed){return K(new M(ab.startContainer,ab.startOffset),true)}else{var ac=K(new M(ab.startContainer,ab.startOffset),true);var aa=K(new M(ab.endContainer,ab.endOffset),false);var ad=O(N.getRangeDocument(ab)).createTextRange();ad.setEndPoint("StartToStart",ac);ad.setEndPoint("EndToEnd",aa);return ad}};Z.rangeToTextRange=V;Z.prototype.toTextRange=function(){return V(this)};J.WrappedTextRange=Z;if(!J.features.implementsDomRange||J.config.preferTextRange){var S=(function(){return this})();if(typeof S.Range=="undefined"){S.Range=Z}J.createNativeRange=function(aa){aa=P(aa,U,"createNativeRange");return O(aa).createTextRange()};J.WrappedRange=Z}}J.createRange=function(aa){aa=P(aa,U,"createRange");return new J.WrappedRange(J.createNativeRange(aa))};J.createRangyRange=function(aa){aa=P(aa,U,"createRangyRange");return new N(aa)};J.createIframeRange=function(aa){U.deprecationNotice("createIframeRange()","createRange(iframeEl)");return J.createRange(aa)};J.createIframeRangyRange=function(aa){U.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)");return J.createRangyRange(aa)};J.addShimListener(function(ab){var aa=ab.document;if(typeof aa.createRange=="undefined"){aa.createRange=function(){return J.createRange(aa)}}aa=ab=null})});d.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(N,au){N.config.checkSelectionRanges=true;var Q="boolean";var av="number";var X=N.dom;var aQ=N.util;var ar=aQ.isHostMethod;var aa=N.DomRange;var aS=N.WrappedRange;var Y=N.DOMException;var Z=X.DomPosition;var ag;var aE;var ab=N.features;var T="Control";var ae=X.getDocument;var ac=X.getBody;var ax=aa.rangesEqual;function aq(aU){return(typeof aU=="string")?/^backward(s)?$/i.test(aU):!!aU}function ak(aW,aV){if(!aW){return window}else{if(X.isWindow(aW)){return aW}else{if(aW instanceof aT){return aW.win}else{var aU=X.getContentDocument(aW,au,aV);return X.getWindow(aU)}}}}function al(aU){return ak(aU,"getWinSelection").getSelection()}function ad(aU){return ak(aU,"getDocSelection").document.selection}function aR(aV){var aU=false;if(aV.anchorNode){aU=(X.comparePoints(aV.anchorNode,aV.anchorOffset,aV.focusNode,aV.focusOffset)==1)}return aU}var ao=ar(window,"getSelection"),an=aQ.isHostObject(document,"selection");ab.implementsWinGetSelection=ao;ab.implementsDocSelection=an;var aP=an&&(!ao||N.config.preferTextRange);if(aP){ag=ad;N.isSelectionValid=function(aW){var aU=ak(aW,"isSelectionValid").document,aV=aU.selection;return(aV.type!="None"||ae(aV.createRange().parentElement())==aU)}}else{if(ao){ag=al;N.isSelectionValid=function(){return true}}else{au.fail("Neither document.selection or window.getSelection() detected.")}}N.getNativeSelection=ag;var aJ=ag();var aI=N.createNativeRange(document);var P=ac(document);var aA=aQ.areHostProperties(aJ,["anchorNode","focusNode","anchorOffset","focusOffset"]);ab.selectionHasAnchorAndFocus=aA;var aB=ar(aJ,"extend");ab.selectionHasExtend=aB;var aC=(typeof aJ.rangeCount==av);ab.selectionHasRangeCount=aC;var aF=false;var S=true;var L=aB?function(aW,aX){var aU=aa.getRangeDocument(aX);var aV=N.createRange(aU);aV.collapseToPoint(aX.endContainer,aX.endOffset);aW.addRange(af(aV));aW.extend(aX.startContainer,aX.startOffset)}:null;if(aQ.areHostMethods(aJ,["addRange","getRangeAt","removeAllRanges"])&&typeof aJ.rangeCount==av&&ab.implementsDomRange){(function(){var a2=window.getSelection();if(a2){var aY=a2.rangeCount;var a3=(aY>1);var aZ=[];var aX=aR(a2);for(var aW=0;aW<aY;++aW){aZ[aW]=a2.getRangeAt(aW)}var aU=ac(document);var a4=aU.appendChild(document.createElement("div"));a4.contentEditable="false";var a5=a4.appendChild(document.createTextNode("\u00a0\u00a0\u00a0"));var a0=document.createRange();a0.setStart(a5,1);a0.collapse(true);a2.addRange(a0);S=(a2.rangeCount==1);a2.removeAllRanges();if(!a3){var aV=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(aV&&parseInt(aV[1])>=36){aF=false}else{var a1=a0.cloneRange();a0.setStart(a5,0);a1.setEnd(a5,3);a1.setStart(a5,2);a2.addRange(a0);a2.addRange(a1);aF=(a2.rangeCount==2)}}aU.removeChild(a4);a2.removeAllRanges();for(aW=0;aW<aY;++aW){if(aW==0&&aX){if(L){L(a2,aZ[aW])}else{N.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend");a2.addRange(aZ[aW])}}else{a2.addRange(aZ[aW])}}}})()}ab.selectionSupportsMultipleRanges=aF;ab.collapsedNonEditableSelectionsSupported=S;var am=false,aH;if(P&&ar(P,"createControlRange")){aH=P.createControlRange();if(aQ.areHostProperties(aH,["item","add"])){am=true}}ab.implementsControlRange=am;if(aA){aE=function(aU){return aU.anchorNode===aU.focusNode&&aU.anchorOffset===aU.focusOffset}}else{aE=function(aU){return aU.rangeCount?aU.getRangeAt(aU.rangeCount-1).collapsed:false}}function aL(aY,aX,aV){var aU=aV?"end":"start",aW=aV?"start":"end";aY.anchorNode=aX[aU+"Container"];aY.anchorOffset=aX[aU+"Offset"];aY.focusNode=aX[aW+"Container"];aY.focusOffset=aX[aW+"Offset"]}function aK(aV){var aU=aV.nativeSelection;aV.anchorNode=aU.anchorNode;aV.anchorOffset=aU.anchorOffset;aV.focusNode=aU.focusNode;aV.focusOffset=aU.focusOffset}function aN(aU){aU.anchorNode=aU.focusNode=null;aU.anchorOffset=aU.focusOffset=0;aU.rangeCount=0;aU.isCollapsed=true;aU._ranges.length=0}function af(aV){var aU;if(aV instanceof aa){aU=N.createNativeRange(aV.getDocument());aU.setEnd(aV.endContainer,aV.endOffset);aU.setStart(aV.startContainer,aV.startOffset)}else{if(aV instanceof aS){aU=aV.nativeRange}else{if(ab.implementsDomRange&&(aV instanceof X.getWindow(aV.startContainer).Range)){aU=aV}}}return aU}function aw(aW){if(!aW.length||aW[0].nodeType!=1){return false}for(var aU=1,aV=aW.length;aU<aV;++aU){if(!X.isAncestorOf(aW[0],aW[aU])){return false}}return true}function aj(aV){var aU=aV.getNodes();if(!aw(aU)){throw au.createError("getSingleElementFromRange: range "+aV.inspect()+" did not consist of a single element")}return aU[0]}function at(aU){return !!aU&&typeof aU.text!="undefined"}function aO(aV,aU){var aW=new aS(aU);aV._ranges=[aW];aL(aV,aW,false);aV.rangeCount=1;aV.isCollapsed=aW.collapsed}function aM(aY){aY._ranges.length=0;if(aY.docSelection.type=="None"){aN(aY)}else{var aU=aY.docSelection.createRange();if(at(aU)){aO(aY,aU)}else{aY.rangeCount=aU.length;var aX,aV=ae(aU.item(0));for(var aW=0;aW<aY.rangeCount;++aW){aX=N.createRange(aV);aX.selectNode(aU.item(aW));aY._ranges.push(aX)}aY.isCollapsed=aY.rangeCount==1&&aY._ranges[0].collapsed;aL(aY,aY._ranges[aY.rangeCount-1],false)}}}function M(a2,a0){var aU=a2.docSelection.createRange();var a1=aj(a0);var aV=ae(aU.item(0));var aZ=ac(aV).createControlRange();for(var aX=0,aY=aU.length;aX<aY;++aX){aZ.add(aU.item(aX))}try{aZ.add(a1)}catch(aW){throw au.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}aZ.select();aM(a2)}var ai;if(ar(aJ,"getRangeAt")){ai=function(aW,aV){try{return aW.getRangeAt(aV)}catch(aU){return null}}}else{if(aA){ai=function(aW){var aU=ae(aW.anchorNode);var aV=N.createRange(aU);aV.setStartAndEnd(aW.anchorNode,aW.anchorOffset,aW.focusNode,aW.focusOffset);if(aV.collapsed!==this.isCollapsed){aV.setStartAndEnd(aW.focusNode,aW.focusOffset,aW.anchorNode,aW.anchorOffset)}return aV}}}function aT(aV,aU,aW){this.nativeSelection=aV;this.docSelection=aU;this._ranges=[];this.win=aW;this.refresh()}aT.prototype=N.selectionPrototype;function W(aU){aU.win=aU.anchorNode=aU.focusNode=aU._ranges=null;aU.rangeCount=aU.anchorOffset=aU.focusOffset=0;aU.detached=true}var R=[];function J(aY,aU){var aW=R.length,aV,aX;while(aW--){aV=R[aW];aX=aV.selection;if(aU=="deleteAll"){W(aX)}else{if(aV.win==aY){if(aU=="delete"){R.splice(aW,1);return true}else{return aX}}}}if(aU=="deleteAll"){R.length=0}return null}var ah=function(aX){if(aX&&aX instanceof aT){aX.refresh();return aX}aX=ak(aX,"getNativeSelection");var aW=J(aX);var aV=ag(aX),aU=an?ad(aX):null;if(aW){aW.nativeSelection=aV;aW.docSelection=aU;aW.refresh()}else{aW=new aT(aV,aU,aX);R.push({win:aX,selection:aW})}return aW};N.getSelection=ah;N.getIframeSelection=function(aU){au.deprecationNotice("getIframeSelection()","getSelection(iframeEl)");return N.getSelection(X.getIframeWindow(aU))};var aG=aT.prototype;function U(a1,a0){var aV=ae(a0[0].startContainer);var aU=ac(aV).createControlRange();for(var aY=0,aW,aZ=a0.length;aY<aZ;++aY){aW=aj(a0[aY]);try{aU.add(aW)}catch(aX){throw au.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}aU.select();aM(a1)}if(!aP&&aA&&aQ.areHostMethods(aJ,["removeAllRanges","addRange"])){aG.removeAllRanges=function(){this.nativeSelection.removeAllRanges();aN(this)};var K=function(aV,aU){L(aV.nativeSelection,aU);aV.refresh()};if(aC){aG.addRange=function(aX,aU){if(am&&an&&this.docSelection.type==T){M(this,aX)}else{if(aq(aU)&&aB){K(this,aX)}else{var aW;if(aF){aW=this.rangeCount}else{this.removeAllRanges();aW=0}this.nativeSelection.addRange(af(aX).cloneRange());this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==aW+1){if(N.config.checkSelectionRanges){var aV=ai(this.nativeSelection,this.rangeCount-1);if(aV&&!ax(aV,aX)){aX=new aS(aV)}}this._ranges[this.rangeCount-1]=aX;aL(this,aX,aD(this.nativeSelection));this.isCollapsed=aE(this)}else{this.refresh()}}}}}else{aG.addRange=function(aV,aU){if(aq(aU)&&aB){K(this,aV)}else{this.nativeSelection.addRange(af(aV));this.refresh()}}}aG.setRanges=function(aW){if(am&&an&&aW.length>1){U(this,aW)}else{this.removeAllRanges();for(var aU=0,aV=aW.length;aU<aV;++aU){this.addRange(aW[aU])}}}}else{if(ar(aJ,"empty")&&ar(aI,"select")&&am&&aP){aG.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var aV;if(this.anchorNode){aV=ae(this.anchorNode)}else{if(this.docSelection.type==T){var aU=this.docSelection.createRange();if(aU.length){aV=ae(aU.item(0))}}}if(aV){var aX=ac(aV).createTextRange();aX.select();this.docSelection.empty()}}}catch(aW){}aN(this)};aG.addRange=function(aU){if(this.docSelection.type==T){M(this,aU)}else{N.WrappedTextRange.rangeToTextRange(aU).select();this._ranges[0]=aU;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;aL(this,aU,false)}};aG.setRanges=function(aV){this.removeAllRanges();var aU=aV.length;if(aU>1){U(this,aV)}else{if(aU){this.addRange(aV[0])}}}}else{au.fail("No means of selecting a Range or TextRange was found");return false}}aG.getRangeAt=function(aU){if(aU<0||aU>=this.rangeCount){throw new Y("INDEX_SIZE_ERR")}else{return this._ranges[aU].cloneRange()}};var ay;if(aP){ay=function(aV){var aU;if(N.isSelectionValid(aV.win)){aU=aV.docSelection.createRange()}else{aU=ac(aV.win.document).createTextRange();aU.collapse(true)}if(aV.docSelection.type==T){aM(aV)}else{if(at(aU)){aO(aV,aU)}else{aN(aV)}}}}else{if(ar(aJ,"getRangeAt")&&typeof aJ.rangeCount==av){ay=function(aW){if(am&&an&&aW.docSelection.type==T){aM(aW)}else{aW._ranges.length=aW.rangeCount=aW.nativeSelection.rangeCount;if(aW.rangeCount){for(var aU=0,aV=aW.rangeCount;aU<aV;++aU){aW._ranges[aU]=new N.WrappedRange(aW.nativeSelection.getRangeAt(aU))}aL(aW,aW._ranges[aW.rangeCount-1],aD(aW.nativeSelection));aW.isCollapsed=aE(aW)}else{aN(aW)}}}}else{if(aA&&typeof aJ.isCollapsed==Q&&typeof aI.collapsed==Q&&ab.implementsDomRange){ay=function(aW){var aV,aU=aW.nativeSelection;if(aU.anchorNode){aV=ai(aU,0);aW._ranges=[aV];aW.rangeCount=1;aK(aW);aW.isCollapsed=aE(aW)}else{aN(aW)}}}else{au.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}}}aG.refresh=function(aU){var aY=aU?this._ranges.slice(0):null;var aW=this.anchorNode,aX=this.anchorOffset;ay(this);if(aU){var aV=aY.length;if(aV!=this._ranges.length){return true}if(this.anchorNode!=aW||this.anchorOffset!=aX){return true}while(aV--){if(!ax(aY[aV],this._ranges[aV])){return true}}return false}};var az=function(aY,aW){var aX=aY.getAllRanges();aY.removeAllRanges();for(var aU=0,aV=aX.length;aU<aV;++aU){if(!ax(aW,aX[aU])){aY.addRange(aX[aU])}}if(!aY.rangeCount){aN(aY)}};if(am&&an){aG.removeRange=function(a0){if(this.docSelection.type==T){var aU=this.docSelection.createRange();var a1=aj(a0);var aV=ae(aU.item(0));var aZ=ac(aV).createControlRange();var aW,a2=false;for(var aX=0,aY=aU.length;aX<aY;++aX){aW=aU.item(aX);if(aW!==a1||a2){aZ.add(aU.item(aX))}else{a2=true}}aZ.select();aM(this)}else{az(this,a0)}}}else{aG.removeRange=function(aU){az(this,aU)}}var aD;if(!aP&&aA&&ab.implementsDomRange){aD=aR;aG.isBackward=function(){return aD(this)}}else{aD=aG.isBackward=function(){return false}}aG.isBackwards=aG.isBackward;aG.toString=function(){var aW=[];for(var aU=0,aV=this.rangeCount;aU<aV;++aU){aW[aU]=""+this._ranges[aU]}return aW.join("")};function O(aV,aU){if(aV.win.document!=ae(aU)){throw new Y("WRONG_DOCUMENT_ERR")}}aG.collapse=function(aU,aV){O(this,aU);var aW=N.createRange(aU);aW.collapseToPoint(aU,aV);this.setSingleRange(aW);this.isCollapsed=true};aG.collapseToStart=function(){if(this.rangeCount){var aU=this._ranges[0];this.collapse(aU.startContainer,aU.startOffset)}else{throw new Y("INVALID_STATE_ERR")}};aG.collapseToEnd=function(){if(this.rangeCount){var aU=this._ranges[this.rangeCount-1];this.collapse(aU.endContainer,aU.endOffset)}else{throw new Y("INVALID_STATE_ERR")}};aG.selectAllChildren=function(aU){O(this,aU);var aV=N.createRange(aU);aV.selectNodeContents(aU);this.setSingleRange(aV)};aG.deleteFromDocument=function(){if(am&&an&&this.docSelection.type==T){var aU=this.docSelection.createRange();var aV;while(aU.length){aV=aU.item(0);aU.remove(aV);aV.parentNode.removeChild(aV)}this.refresh()}else{if(this.rangeCount){var aY=this.getAllRanges();if(aY.length){this.removeAllRanges();for(var aW=0,aX=aY.length;aW<aX;++aW){aY[aW].deleteContents()}this.addRange(aY[aX-1])}}}};aG.eachRange=function(aU,aX){for(var aV=0,aW=this._ranges.length;aV<aW;++aV){if(aU(this.getRangeAt(aV))){return aX}}};aG.getAllRanges=function(){var aU=[];this.eachRange(function(aV){aU.push(aV)});return aU};aG.setSingleRange=function(aV,aU){this.removeAllRanges();this.addRange(aV,aU)};aG.callMethodOnEachRange=function(aU,aV){var aW=[];this.eachRange(function(aX){aW.push(aX[aU].apply(aX,aV))});return aW};function V(aU){return function(aV,aW){var aX;if(this.rangeCount){aX=this.getRangeAt(0);aX["set"+(aU?"Start":"End")](aV,aW)}else{aX=N.createRange(this.win.document);aX.setStartAndEnd(aV,aW)}this.setSingleRange(aX,this.isBackward())}}aG.setStart=V(true);aG.setEnd=V(false);N.rangePrototype.select=function(aU){ah(this.getDocument()).setSingleRange(this,aU)};aG.changeEachRange=function(aV){var aW=[];var aU=this.isBackward();this.eachRange(function(aX){aV(aX);aW.push(aX)});this.removeAllRanges();if(aU&&aW.length==1){this.addRange(aW[0],"backward")}else{this.setRanges(aW)}};aG.containsNode=function(aV,aU){return this.eachRange(function(aW){return aW.containsNode(aV,aU)},true)||false};aG.getBookmark=function(aU){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[aU])}};aG.moveToBookmark=function(aU){var aY=[];for(var aV=0,aX,aW;aX=aU.rangeBookmarks[aV++];){aW=N.createRange(this.win);aW.moveToBookmark(aX);aY.push(aW)}if(aU.backward){this.setSingleRange(aY[0],"backward")}else{this.setRanges(aY)}};aG.toHtml=function(){var aU=[];this.eachRange(function(aV){aU.push(aa.toHtml(aV))});return aU.join("")};if(ab.implementsTextRange){aG.getNativeTextRange=function(){var aV,aW;if((aV=this.docSelection)){var aU=aV.createRange();if(at(aU)){return aU}else{throw au.createError("getNativeTextRange: selection is a control selection")}}else{if(this.rangeCount>0){return N.WrappedTextRange.rangeToTextRange(this.getRangeAt(0))}else{throw au.createError("getNativeTextRange: selection contains no range")}}}}function ap(a0){var aZ=[];var aU=new Z(a0.anchorNode,a0.anchorOffset);var aV=new Z(a0.focusNode,a0.focusOffset);var aY=(typeof a0.getName=="function")?a0.getName():"Selection";if(typeof a0.rangeCount!="undefined"){for(var aW=0,aX=a0.rangeCount;aW<aX;++aW){aZ[aW]=aa.inspect(a0.getRangeAt(aW))}}return"["+aY+"(Ranges: "+aZ.join(", ")+")(anchor: "+aU.inspect()+", focus: "+aV.inspect()+"]"}aG.getName=function(){return"WrappedSelection"};aG.inspect=function(){return ap(this)};aG.detach=function(){J(this.win,"delete");W(this)};aT.detachAll=function(){J(null,"deleteAll")};aT.inspect=ap;aT.isDirectionBackward=aq;N.Selection=aT;N.selectionPrototype=aG;N.addShimListener(function(aU){if(typeof aU.getSelection=="undefined"){aU.getSelection=function(){return ah(aU)}}aU=null})});return d},this);(function(a,b){if(typeof define=="function"&&define.amd){define(["rangy"],a)}else{a(b.rangy)}})(function(a){a.createModule("SaveRestore",["WrappedRange"],function(b,i){var e=b.dom;var h="\ufeff";function f(t,s){return(s||document).getElementById(t)}function g(x,s){var w="selectionBoundary_"+(+new Date())+"_"+(""+Math.random()).slice(2);var v;var u=e.getDocument(x.startContainer);var t=x.cloneRange();t.collapse(s);v=u.createElement("span");v.id=w;v.style.lineHeight="0";v.style.display="none";v.className="rangySelectionBoundary";v.appendChild(u.createTextNode(h));t.insertNode(v);return v}function r(t,w,v,s){var u=f(v,t);if(u){w[s?"setStartBefore":"setEndBefore"](u);u.parentNode.removeChild(u)}else{i.warn("Marker element has been removed. Cannot restore selection.")}}function d(s,t){return t.compareBoundaryPoints(s.START_TO_START,s)}function o(v,s){var w,u,t=b.DomRange.getRangeDocument(v),x=v.toString();if(v.collapsed){u=g(v,false);return{document:t,markerId:u.id,collapsed:true}}else{u=g(v,false);w=g(v,true);return{document:t,startMarkerId:w.id,endMarkerId:u.id,collapsed:false,backward:s,toString:function(){return"original text: '"+x+"', new text: '"+v.toString()+"'"}}}}function l(x,u){var s=x.document;if(typeof u=="undefined"){u=true}var w=b.createRange(s);if(x.collapsed){var t=f(x.markerId,s);if(t){t.style.display="inline";var v=t.previousSibling;if(v&&v.nodeType==3){t.parentNode.removeChild(t);w.collapseToPoint(v,v.length)}else{w.collapseBefore(t);t.parentNode.removeChild(t)}}else{i.warn("Marker element has been removed. Cannot restore selection.")}}else{r(s,w,x.startMarkerId,true);r(s,w,x.endMarkerId,false)}if(u){w.normalizeBoundaries()}return w}function p(y,s){var x=[],w,t;y=y.slice(0);y.sort(d);for(var u=0,v=y.length;u<v;++u){x[u]=o(y[u],s)}for(u=v-1;u>=0;--u){w=y[u];t=b.DomRange.getRangeDocument(w);if(w.collapsed){w.collapseAfter(f(x[u].markerId,t))}else{w.setEndBefore(f(x[u].endMarkerId,t));w.setStartAfter(f(x[u].startMarkerId,t))}}return x}function q(w){if(!b.isSelectionValid(w)){i.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.");return null}var v=b.getSelection(w);var u=v.getAllRanges();var s=(u.length==1&&v.isBackward());var t=p(u,s);if(s){v.setSingleRange(u[0],"backward")}else{v.setRanges(u)}return{win:w,rangeInfos:t,restored:false}}function m(u){var v=[];var t=u.length;for(var s=t-1;s>=0;s--){v[s]=l(u[s],true)}return v}function n(w,s){if(!w.restored){var u=w.rangeInfos;var x=b.getSelection(w.win);var v=m(u),t=u.length;if(t==1&&s&&b.features.selectionHasExtend&&u[0].backward){x.removeAllRanges();x.addRange(v[0],true)}else{x.setRanges(v)}w.restored=true}}function j(s,u){var t=f(u,s);if(t){t.parentNode.removeChild(t)}}function k(w){var v=w.rangeInfos;for(var s=0,t=v.length,u;s<t;++s){u=v[s];if(u.collapsed){j(w.doc,u.markerId)}else{j(w.doc,u.startMarkerId);j(w.doc,u.endMarkerId)}}}b.util.extend(b,{saveRange:o,restoreRange:l,saveRanges:p,restoreRanges:m,saveSelection:q,restoreSelection:n,removeMarkerElement:j,removeMarkers:k})})},this);var Base=function(){};Base.extend=function(a,b){var e=Base.prototype.extend;Base._prototyping=true;var g=new this;e.call(g,a);g.base=function(){};delete Base._prototyping;var d=g.constructor;var f=g.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==f){this._constructing=true;d.apply(this,arguments);delete this._constructing}else{if(arguments[0]!=null){return(arguments[0].extend||e).call(arguments[0],g)}}}};f.ancestor=this;f.extend=this.extend;f.forEach=this.forEach;f.implement=this.implement;f.prototype=g;f.toString=this.toString;f.valueOf=function(h){return(h=="object")?f:d.valueOf()};e.call(f,b);if(typeof f.init=="function"){f.init()}return f};Base.prototype={extend:function(j,k){if(arguments.length>1){var a=this[j];if(a&&(typeof k=="function")&&(!a.valueOf||a.valueOf()!=k.valueOf())&&/\bbase\b/.test(k)){var g=k.valueOf();k=function(){var i=this.base||Base.prototype.base;this.base=a;var l=g.apply(this,arguments);this.base=i;return l};k.valueOf=function(i){return(i=="object")?k:g};k.toString=Base.toString}this[j]=k}else{if(j){var b=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){b=this.extend||b}var h={toSource:null};var d=["constructor","toString","valueOf"];var e=Base._prototyping?0:1;while(f=d[e++]){if(j[f]!=h[f]){b.call(this,f,j[f])}}for(var f in j){if(!h[f]){b.call(this,f,j[f])}}}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,a,b){for(var d in e){if(this.prototype[d]===undefined){a.call(b,e[d],d,e)}}},implement:function(){for(var a=0;a<arguments.length;a++){if(typeof arguments[a]=="function"){arguments[a](this.prototype)}else{this.prototype.extend(arguments[a])}}return this},toString:function(){return String(this.valueOf())}});wysihtml5.browser=(function(){var j=navigator.userAgent,i=document.createElement("div"),e=j.indexOf("Gecko")!==-1&&j.indexOf("KHTML")===-1,h=j.indexOf("AppleWebKit/")!==-1,d=j.indexOf("Chrome/")!==-1,g=j.indexOf("Opera/")!==-1;function b(k){return +((/ipad|iphone|ipod/.test(k)&&k.match(/ os (\d+).+? like mac os x/))||[undefined,0])[1]}function a(k){return +(k.match(/android (\d+)/)||[undefined,0])[1]}function f(n,k){var m=-1,l;if(navigator.appName=="Microsoft Internet Explorer"){l=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})")}else{if(navigator.appName=="Netscape"){l=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")}}if(l&&l.exec(navigator.userAgent)!=null){m=parseFloat(RegExp.$1)}if(m===-1){return false}if(!n){return true}if(!k){return n===m}if(k==="<"){return n<m}if(k===">"){return n>m}if(k==="<="){return n<=m}if(k===">="){return n>=m}}return{USER_AGENT:j,supported:function(){var o=this.USER_AGENT.toLowerCase(),k="contentEditable" in i,l=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,m=document.querySelector&&document.querySelectorAll,n=(this.isIos()&&b(o)<5)||(this.isAndroid()&&a(o)<4)||o.indexOf("opera mobi")!==-1||o.indexOf("hpwos/")!==-1;return k&&l&&m&&!n},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return(/ipad|iphone|ipod/i).test(this.USER_AGENT)},isAndroid:function(){return this.USER_AGENT.indexOf("Android")!==-1},supportsSandboxedIframes:function(){return f()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return f()},hasCurrentStyleProperty:function(){return"currentStyle" in i},hasHistoryIssue:function(){return e&&navigator.platform.substr(0,3)==="Mac"},insertsLineBreaksOnReturn:function(){return e},supportsPlaceholderAttributeOn:function(k){return"placeholder" in k},supportsEvent:function(k){return"on"+k in i||(function(){i.setAttribute("on"+k,"return;");return typeof(i["on"+k])==="function"})()},supportsEventsInIframeCorrectly:function(){return !g},supportsHTML5Tags:function(k){var l=k.createElement("div"),m="<article>foo</article>";l.innerHTML=m;return l.innerHTML.toLowerCase()===m},supportsCommand:(function(){var k={formatBlock:f(10,"<="),insertUnorderedList:f(),insertOrderedList:f()};var l={insertHTML:e};return function(n,m){var q=k[m];if(!q){try{return n.queryCommandSupported(m)}catch(o){}try{return n.queryCommandEnabled(m)}catch(p){return !!l[m]}}return false}})(),doesAutoLinkingInContentEditable:function(){return f()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return e||g||h},supportsGetAttributeCorrectly:function(){var k=document.createElement("td");return k.getAttribute("rowspan")!="1"},canSelectImagesInContentEditable:function(){return e||f()||g},autoScrollsToCaret:function(){return !h},autoClosesUnclosedTags:function(){var k=i.cloneNode(false),m,l;k.innerHTML="<p><div></div>";l=k.innerHTML.toLowerCase();m=l==="<p></p><div></div>"||l==="<p><div></div></p>";this.autoClosesUnclosedTags=function(){return m};return m},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()},needsSpaceAfterLineBreak:function(){return g},supportsSpeechApiOn:function(l){var k=j.match(/Chrome\/(\d+)/)||[undefined,0];return k[1]>=11&&("onwebkitspeechchange" in l||"speech" in l)},crashesWhenDefineProperty:function(k){return f(9)&&(k==="XMLHttpRequest"||k==="XDomainRequest")},doesAsyncFocus:function(){return f()},hasProblemsSettingCaretAfterImg:function(){return f()},hasUndoInContextMenu:function(){return e||d||g},hasInsertNodeIssue:function(){return g},hasIframeFocusIssue:function(){return f()},createsNestedInvalidMarkupAfterPaste:function(){return h},supportsMutationEvents:function(){return("MutationEvent" in window)},supportsModenPaste:function(){return !("clipboardData" in window)}}})();wysihtml5.lang.array=function(a){return{contains:function(d){if(Array.isArray(d)){for(var b=d.length;b--;){if(wysihtml5.lang.array(a).indexOf(d[b])!==-1){return true}}return false}else{return wysihtml5.lang.array(a).indexOf(d)!==-1}},indexOf:function(e){if(a.indexOf){return a.indexOf(e)}else{for(var b=0,d=a.length;b<d;b++){if(a[b]===e){return b}}return -1}},without:function(b){b=wysihtml5.lang.array(b);var f=[],d=0,e=a.length;for(;d<e;d++){if(!b.contains(a[d])){f.push(a[d])}}return f},get:function(){var b=0,d=a.length,e=[];for(;b<d;b++){e.push(a[b])}return e},map:function(d,g){if(Array.prototype.map){return a.map(d,g)}else{var f=a.length>>>0,b=new Array(f),e=0;for(;e<f;e++){b[e]=d.call(g,a[e],e,a)}return b}},unique:function(){var e=[],d=a.length,b=0;while(b<d){if(!wysihtml5.lang.array(e).contains(a[b])){e.push(a[b])}b++}return e}}};wysihtml5.lang.Dispatcher=Base.extend({on:function(a,b){this.events=this.events||{};this.events[a]=this.events[a]||[];this.events[a].push(b);return this},off:function(a,b){this.events=this.events||{};var e=0,d,f;if(a){d=this.events[a]||[],f=[];for(;e<d.length;e++){if(d[e]!==b&&b){f.push(d[e])}}this.events[a]=f}else{this.events={}}return this},fire:function(a,e){this.events=this.events||{};var b=this.events[a]||[],d=0;for(;d<b.length;d++){b[d].call(this,e)}return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}});wysihtml5.lang.object=function(a){return{merge:function(d){for(var b in d){a[b]=d[b]}return this},get:function(){return a},clone:function(b){var e={},d;if(a===null||!wysihtml5.lang.object(a).isPlainObject()){return a}for(d in a){if(a.hasOwnProperty(d)){if(b){e[d]=wysihtml5.lang.object(a[d]).clone(b)}else{e[d]=a[d]}}}return e},isArray:function(){return Object.prototype.toString.call(a)==="[object Array]"},isFunction:function(){return Object.prototype.toString.call(a)==="[object Function]"},isPlainObject:function(){return Object.prototype.toString.call(a)==="[object Object]"}}};(function(){var e=/^\s+/,d=/\s+$/,b=/[&<>\t"]/g,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(f){f=String(f);return{trim:function(){return f.replace(e,"").replace(d,"")},interpolate:function(h){for(var g in h){f=this.replace("#{"+g+"}").by(h[g])}return f},replace:function(g){return{by:function(h){return f.split(g).join(h)}}},escapeHTML:function(i,g){var h=f.replace(b,function(j){return a[j]});if(i){h=h.replace(/(?:\r\n|\r|\n)/g,"<br />")}if(g){h=h.replace(/  /gi,"&nbsp; ")}return h}}}})();(function(m){var i=m.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,k=/([^\w\/\-](,?))$/i,j=100,h={")":"(","]":"[","}":"{"};function g(n,o){if(d(n,o)){return n}if(n===n.ownerDocument.documentElement){n=n.ownerDocument.body}return e(n,o)}function a(n){return n.replace(l,function(p,t){var r=(t.match(k)||[])[1]||"",q=h[r];t=t.replace(k,"");if(t.split(q).length>t.split(r).length){t=t+r;r=""}var s=t,o=t;if(t.length>j){o=o.substr(0,j)+"..."}if(s.substr(0,4)==="www."){s="http://"+s}return'<a href="'+s+'">'+o+"</a>"+r})}function b(n){var o=n._wysihtml5_tempElement;if(!o){o=n._wysihtml5_tempElement=n.createElement("div")}return o}function f(q){var o=q.parentNode,n=m.lang.string(q.data).escapeHTML(),p=b(o.ownerDocument);p.innerHTML="<span></span>"+a(n);p.removeChild(p.firstChild);while(p.firstChild){o.insertBefore(p.firstChild,q)}o.removeChild(q)}function d(o,n){var p;while(o.parentNode){o=o.parentNode;p=o.nodeName;if(o.className&&m.lang.array(o.className.split(" ")).contains(n)){return true}if(i.contains(p)){return true}else{if(p==="body"){return false}}}return false}function e(p,r){if(i.contains(p.nodeName)){return}if(p.className&&m.lang.array(p.className.split(" ")).contains(r)){return}if(p.nodeType===m.TEXT_NODE&&p.data.match(l)){f(p);return}var n=m.lang.array(p.childNodes).get(),o=n.length,q=0;for(;q<o;q++){e(n[q],r)}return p}m.dom.autoLink=g;m.dom.autoLink.URL_REG_EXP=l})(wysihtml5);(function(b){var a=b.dom;a.addClass=function(f,e){var d=f.classList;if(d){return d.add(e)}if(a.hasClass(f,e)){return}f.className+=" "+e};a.removeClass=function(f,e){var d=f.classList;if(d){return d.remove(e)}f.className=f.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ")};a.hasClass=function(f,e){var d=f.classList;if(d){return d.contains(e)}var g=f.className;return(g.length>0&&(g==e||new RegExp("(^|\\s)"+e+"(\\s|$)").test(g)))}})(wysihtml5);wysihtml5.dom.contains=(function(){var a=document.documentElement;if(a.contains){return function(b,d){if(d.nodeType!==wysihtml5.ELEMENT_NODE){d=d.parentNode}return b!==d&&b.contains(d)}}else{if(a.compareDocumentPosition){return function(b,d){return !!(b.compareDocumentPosition(d)&16)}}}})();wysihtml5.dom.convertToList=(function(){function b(e,f){var g=e.createElement("li");f.appendChild(g);return g}function a(e,f){return e.createElement(f)}function d(k,s,u){if(k.nodeName==="UL"||k.nodeName==="OL"||k.nodeName==="MENU"){return k}var j=k.ownerDocument,r=a(j,s),p=k.querySelectorAll("br"),q=p.length,f,g,e,o,t,m,n,h,l;for(l=0;l<q;l++){o=p[l];while((t=o.parentNode)&&t!==k&&t.lastChild===o){if(wysihtml5.dom.getStyle("display").from(t)==="block"){t.removeChild(o);break}wysihtml5.dom.insert(o).after(o.parentNode)}}f=wysihtml5.lang.array(k.childNodes).get();g=f.length;for(l=0;l<g;l++){h=h||b(j,r);e=f[l];m=wysihtml5.dom.getStyle("display").from(e)==="block";n=e.nodeName==="BR";if(m&&(!u||!wysihtml5.dom.hasClass(e,u))){h=h.firstChild?b(j,r):h;h.appendChild(e);h=null;continue}if(n){h=h.firstChild?null:h;continue}h.appendChild(e)}if(f.length===0){b(j,r)}k.parentNode.replaceChild(r,k);return r}return d})();wysihtml5.dom.copyAttributes=function(a){return{from:function(b){return{to:function(e){var d,f=0,g=a.length;for(;f<g;f++){d=a[f];if(typeof(b[d])!=="undefined"&&b[d]!==""){e[d]=b[d]}}return{andTo:arguments.callee}}}}}};(function(b){var a=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"];var e=function(f){if(d(f)){return parseInt(b.getStyle("width").from(f),10)<f.offsetWidth}return false};var d=function(f){var g=0,h=a.length;for(;g<h;g++){if(b.getStyle(a[g]).from(f)==="border-box"){return a[g]}}};b.copyStyles=function(f){return{from:function(h){if(e(h)){f=wysihtml5.lang.array(f).without(a)}var g="",k=f.length,j=0,l;for(;j<k;j++){l=f[j];g+=l+":"+b.getStyle(l).from(h)+";"}return{to:function(i){b.setStyles(g).on(i);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);(function(a){a.dom.delegate=function(b,f,d,e){return a.dom.observe(b,d,function(g){var i=g.target,h=a.lang.array(b.querySelectorAll(f));while(i&&i!==b){if(h.contains(i)){e.call(i,g);break}i=i.parentNode}})}})(wysihtml5);(function(a){a.dom.domNode=function(e){var d=[a.ELEMENT_NODE,a.TEXT_NODE];var b=function(f){return f.nodeType===a.TEXT_NODE&&(/^\s*$/g).test(f.data)};return{prev:function(f){var g=e.previousSibling,h=(f&&f.nodeTypes)?f.nodeTypes:d;if(!g){return null}if((!a.lang.array(h).contains(g.nodeType))||(f&&f.ignoreBlankTexts&&b(g))){return a.dom.domNode(g).prev(f)}return g},next:function(g){var f=e.nextSibling,h=(g&&g.nodeTypes)?g.nodeTypes:d;if(!f){return null}if((!a.lang.array(h).contains(f.nodeType))||(g&&g.ignoreBlankTexts&&b(f))){return a.dom.domNode(f).next(g)}return f}}}})(wysihtml5);wysihtml5.dom.getAsDom=(function(){var b=function(h,f){var i=f.createElement("div");i.style.display="none";f.body.appendChild(i);try{i.innerHTML=h}catch(g){}f.body.removeChild(i);return i};var a=function(e){if(e._wysihtml5_supportsHTML5Tags){return}for(var f=0,g=d.length;f<g;f++){e.createElement(d[f])}e._wysihtml5_supportsHTML5Tags=true};var d=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(f,e){e=e||document;var g;if(typeof(f)==="object"&&f.nodeType){g=e.createElement("div");g.appendChild(f)}else{if(wysihtml5.browser.supportsHTML5Tags(e)){g=e.createElement("div");g.innerHTML=f}else{a(e);g=b(f,e)}}return g}})();wysihtml5.dom.getParentElement=(function(){function e(g,f){if(!f||!f.length){return true}if(typeof(f)==="string"){return g===f}else{return wysihtml5.lang.array(f).contains(g)}}function d(f){return f.nodeType===wysihtml5.ELEMENT_NODE}function a(i,f,h){var g=(i.className||"").match(h)||[];if(!f){return !!g.length}return g[g.length-1]===f}function b(g,f,h){var i=(g.getAttribute("style")||"").match(h)||[];if(!f){return !!i.length}return i[i.length-1]===f}return function(k,j,i,f){var h=(j.cssStyle||j.styleRegExp),g=(j.className||j.classRegExp);i=i||50;while(i--&&k&&k.nodeName!=="BODY"&&(!f||k!==f)){if(d(k)&&e(k.nodeName,j.nodeName)&&(!h||b(k,j.cssStyle,j.styleRegExp))&&(!g||a(k,j.className,j.classRegExp))){return k}k=k.parentNode}return null}})();wysihtml5.dom.getStyle=(function(){var d={"float":("styleFloat" in document.createElement("div").style)?"styleFloat":"cssFloat"},b=/\-[a-z]/g;function a(e){return e.replace(b,function(f){return f.charAt(1).toUpperCase()})}return function(e){return{from:function(j){if(j.nodeType!==wysihtml5.ELEMENT_NODE){return}var h=j.ownerDocument,f=d[e]||a(e),n=j.style,g=j.currentStyle,o=n[f];if(o){return o}if(g){try{return g[f]}catch(i){}}var p=h.defaultView||h.parentWindow,k=(e==="height"||e==="width")&&j.nodeName==="TEXTAREA",l,m;if(p.getComputedStyle){if(k){l=n.overflow;n.overflow="hidden"}m=p.getComputedStyle(j,null).getPropertyValue(e);if(k){n.overflow=l||""}return m}}}}})();wysihtml5.dom.getTextNodes=function(d,b){var a=[];for(d=d.firstChild;d;d=d.nextSibling){if(d.nodeType==3){if(!b||!(/^\s*$/).test(d.innerText||d.textContent)){a.push(d)}}else{a=a.concat(wysihtml5.dom.getTextNodes(d,b))}}return a};wysihtml5.dom.hasElementWithTagName=(function(){var d={},b=1;function a(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=b++)}return function(f,h){var g=a(f)+":"+h,e=d[g];if(!e){e=d[g]=f.getElementsByTagName(h)}return e.length>0}})();(function(e){var d={},b=1;function a(f){return f._wysihtml5_identifier||(f._wysihtml5_identifier=b++)}e.dom.hasElementWithClassName=function(h,g){if(!e.browser.supportsNativeGetElementsByClassName()){return !!h.querySelector("."+g)}var i=a(h)+":"+g,f=d[i];if(!f){f=d[i]=h.getElementsByClassName(g)}return f.length>0}})(wysihtml5);wysihtml5.dom.insert=function(a){return{after:function(b){b.parentNode.insertBefore(a,b.nextSibling)},before:function(b){b.parentNode.insertBefore(a,b)},into:function(b){b.appendChild(a)}}};wysihtml5.dom.insertCSS=function(a){a=a.join("\n");return{into:function(b){var f=b.createElement("style");f.type="text/css";if(f.styleSheet){f.styleSheet.cssText=a}else{f.appendChild(b.createTextNode(a))}var e=b.querySelector("head link");if(e){e.parentNode.insertBefore(f,e);return}else{var d=b.querySelector("head");if(d){d.appendChild(f)}}}}};(function(a){a.dom.lineBreaks=function(e){function b(f){return f.nodeName==="BR"}function d(f){if(b(f)){return true}if(a.dom.getStyle("display").from(f)==="block"){return true}return false}return{add:function(h){var f=e.ownerDocument,g=a.dom.domNode(e).next({ignoreBlankTexts:true}),i=a.dom.domNode(e).prev({ignoreBlankTexts:true});if(g&&!d(g)){a.dom.insert(f.createElement("br")).after(e)}if(i&&!d(i)){a.dom.insert(f.createElement("br")).before(e)}},remove:function(g){var f=a.dom.domNode(e).next({ignoreBlankTexts:true}),h=a.dom.domNode(e).prev({ignoreBlankTexts:true});if(f&&b(f)){f.parentNode.removeChild(f)}if(h&&b(h)){h.parentNode.removeChild(h)}}}}})(wysihtml5);wysihtml5.dom.observe=function(a,d,e){d=typeof(d)==="string"?[d]:d;var f,b,g=0,h=d.length;for(;g<h;g++){b=d[g];if(a.addEventListener){a.addEventListener(b,e,false)}else{f=function(i){if(!("target" in i)){i.target=i.srcElement}i.preventDefault=i.preventDefault||function(){this.returnValue=false};i.stopPropagation=i.stopPropagation||function(){this.cancelBubble=true};e.call(a,i)};a.attachEvent("on"+b,f)}}return{stop:function(){var j,k=0,l=d.length;for(;k<l;k++){j=d[k];if(a.removeEventListener){a.removeEventListener(j,e,false)}else{a.detachEvent("on"+j,f)}}}}};wysihtml5.dom.parse=function(w,r){var y={"1":i,"3":k,"8":h},t="span",B=/\s+/,u={tags:{},classes:{}},s={};function z(G,D){wysihtml5.lang.object(s).merge(u).merge(D.rules).get();var E=D.context||G.ownerDocument||document,I=E.createDocumentFragment(),J=typeof(G)==="string",C=false,F,L,H;if(D.clearInternals===true){C=true}if(J){F=wysihtml5.dom.getAsDom(G,E)}else{F=G}if(s.selectors){a(F,s.selectors)}while(F.firstChild){H=F.firstChild;L=e(H,D.cleanUp,C,D.uneditableClass);if(L){I.appendChild(L)}if(H!==L){F.removeChild(H)}}if(D.unjoinNbsps){var M=wysihtml5.dom.getTextNodes(I);for(var K=M.length;K--;){M[K].nodeValue=M[K].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ")}}F.innerHTML="";F.appendChild(I);return J?wysihtml5.quirks.getCorrectInnerHTML(F):F}function e(L,C,D,N){var M=L.nodeType,J=L.childNodes,K=J.length,G=y[M],F=0,E,I,H;if(N&&M===1&&wysihtml5.dom.hasClass(L,N)){return L}I=G&&G(L,D);if(!I){if(I===false){E=L.ownerDocument.createDocumentFragment();for(F=K;F--;){if(J[F]){H=e(J[F],C,D,N);if(H){if(J[F]===H){F--}E.insertBefore(H,E.firstChild)}}}if(wysihtml5.dom.getStyle("display").from(L)==="block"){E.appendChild(L.ownerDocument.createElement("br"))}if(wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(L.nodeName.toLowerCase())&&L.parentNode.lastChild!==L){if(!L.nextSibling||L.nextSibling.nodeType!==3||!(/^\s/).test(L.nextSibling.nodeValue)){E.appendChild(L.ownerDocument.createTextNode(" "))}}if(E.normalize){E.normalize()}return E}else{return null}}for(F=0;F<K;F++){if(J[F]){H=e(J[F],C,D,N);if(H){if(J[F]===H){F--}I.appendChild(H)}}}if(C&&I.nodeName.toLowerCase()===t&&(!I.childNodes.length||((/^\s*$/gi).test(I.innerHTML)&&(D||(L.className!=="_wysihtml5-temp-placeholder"&&L.className!=="rangySelectionBoundary")))||!I.attributes.length)){E=I.ownerDocument.createDocumentFragment();while(I.firstChild){E.appendChild(I.firstChild)}if(E.normalize){E.normalize()}return E}if(I.normalize){I.normalize()}return I}function a(C,H){var G,F,D;for(G in H){if(H.hasOwnProperty(G)){if(wysihtml5.lang.object(H[G]).isFunction()){F=H[G]}else{if(typeof(H[G])==="string"&&v[H[G]]){F=v[H[G]]}}D=C.querySelectorAll(G);for(var E=D.length;E--;){F(D[E])}}}}function i(F,C){var H,D,J=s.tags,E=F.nodeName.toLowerCase(),I=F.scopeName,G;if(F._wysihtml5){return null}F._wysihtml5=1;if(F.className==="wysihtml5-temp"){return null}if(I&&I!="HTML"){E=I+":"+E}if("outerHTML" in F){if(!wysihtml5.browser.autoClosesUnclosedTags()&&F.nodeName==="P"&&F.outerHTML.slice(-4).toLowerCase()!=="</p>"){E="div"}}if(E in J){H=J[E];if(!H||H.remove){return null}else{if(H.unwrap){return false}}H=typeof(H)==="string"?{rename_tag:H}:H}else{if(F.firstChild){H={rename_tag:t}}else{return null}}if(H.one_of_type&&!m(F,s,H.one_of_type,C)){if(H.remove_action){if(H.remove_action==="unwrap"){return false}else{if(H.remove_action==="rename"){G=H.remove_action_rename_to||t}else{return null}}}else{return null}}D=F.ownerDocument.createElement(G||H.rename_tag||E);g(F,D,H,C);j(F,D,H);F=null;if(D.normalize){D.normalize()}return D}function m(E,F,H,C){var D,G;if(E.nodeName==="SPAN"&&!C&&(E.className==="_wysihtml5-temp-placeholder"||E.className==="rangySelectionBoundary")){return true}for(G in H){if(H.hasOwnProperty(G)&&F.type_definitions&&F.type_definitions[G]){D=F.type_definitions[G];if(l(E,D)){return true}}}return false}function p(C,E){var D=C.length;while(D--){if(C[D]===E){return true}}return false}function l(L,G){var J=L.getAttribute("class"),K=L.getAttribute("style"),E,M,N,C,D,F,P;if(G.methods){for(var I in G.methods){if(G.methods.hasOwnProperty(I)&&A[I]){if(A[I](L)){return true}}}}if(J&&G.classes){J=J.replace(/^\s+/g,"").replace(/\s+$/g,"").split(B);E=J.length;for(var H=0;H<E;H++){if(G.classes[J[H]]){return true}}}if(K&&G.styles){K=K.split(";");for(M in G.styles){if(G.styles.hasOwnProperty(M)){for(var O=K.length;O--;){P=K[O].split(":");if(P[0].replace(/\s/g,"").toLowerCase()===M){if(G.styles[M]===true||G.styles[M]===1||wysihtml5.lang.array(G.styles[M]).contains(P[1].replace(/\s/g,"").toLowerCase())){return true}}}}}}if(G.attrs){for(C in G.attrs){if(G.attrs.hasOwnProperty(C)){D=wysihtml5.dom.getAttribute(L,C);if(typeof(D)==="string"){if(D.search(G.attrs[C])>-1){return true}}}}}return false}function j(D,C,E){var F,G;if(E&&E.keep_styles){for(F in E.keep_styles){if(E.keep_styles.hasOwnProperty(F)){G=(F==="float")?D.style.styleFloat||D.style.cssFloat:D.style[F];if(E.keep_styles[F] instanceof RegExp&&!(E.keep_styles[F].test(G))){continue}if(F==="float"){C.style[(D.style.styleFloat)?"styleFloat":"cssFloat"]=G}else{if(D.style[F]){C.style[F]=G}}}}}}function f(E,D){var F=[];for(var C in D){if(D.hasOwnProperty(C)&&C.indexOf(E)===0){F.push(C)}}return F}function b(C,D,F,H){var E=q[F],G;if(E){if(D||(C==="alt"&&H=="IMG")){G=E(D);if(typeof(G)==="string"){return G}}}return false}function d(M,I){var F=wysihtml5.lang.object(s.attributes||{}).clone(),E=wysihtml5.lang.object(F).merge(wysihtml5.lang.object(I||{}).clone()).get(),D={},L=wysihtml5.dom.getAttributes(M),C,K,J;for(C in E){if((/\*$/).test(C)){J=f(C.slice(0,-1),L);for(var G=0,H=J.length;G<H;G++){K=b(J[G],L[J[G]],E[C],M.nodeName);if(K!==false){D[J[G]]=K}}}else{K=b(C,L[C],E[C],M.nodeName);if(K!==false){D[C]=K}}}return D}function g(T,R,U,J){var G={},W=U.set_class,C=U.add_class,D=U.add_style,V=U.set_attributes,E=s.classes,M=0,H=[],X=[],P=[],S=[],I,Q,K,O,F,N;if(V){G=wysihtml5.lang.object(V).clone()}G=wysihtml5.lang.object(G).merge(d(T,U.check_attributes)).get();if(W){H.push(W)}if(C){for(F in C){N=n[C[F]];if(!N){continue}O=N(wysihtml5.dom.getAttribute(T,F));if(typeof(O)==="string"){H.push(O)}}}if(D){for(F in D){N=o[D[F]];if(!N){continue}newStyle=N(wysihtml5.dom.getAttribute(T,F));if(typeof(newStyle)==="string"){X.push(newStyle)}}}if(typeof(E)==="string"&&E==="any"&&T.getAttribute("class")){if(s.classes_blacklist){S=T.getAttribute("class");if(S){H=H.concat(S.split(B))}I=H.length;for(;M<I;M++){K=H[M];if(!s.classes_blacklist[K]){P.push(K)}}if(P.length){G["class"]=wysihtml5.lang.array(P).unique().join(" ")}}else{G["class"]=T.getAttribute("class")}}else{if(!J){E["_wysihtml5-temp-placeholder"]=1;E._rangySelectionBoundary=1;E["wysiwyg-tmp-selected-cell"]=1}S=T.getAttribute("class");if(S){H=H.concat(S.split(B))}I=H.length;for(;M<I;M++){K=H[M];if(E[K]){P.push(K)}}if(P.length){G["class"]=wysihtml5.lang.array(P).unique().join(" ")}}if(G["class"]&&J){G["class"]=G["class"].replace("wysiwyg-tmp-selected-cell","");if((/^\s*$/g).test(G["class"])){delete G["class"]}}if(X.length){G.style=wysihtml5.lang.array(X).unique().join(" ")}for(F in G){try{R.setAttribute(F,G[F])}catch(L){}}if(G.src){if(typeof(G.width)!=="undefined"){R.setAttribute("width",G.width)}if(typeof(G.height)!=="undefined"){R.setAttribute("height",G.height)}}}var x=/\uFEFF/g;function k(E){var D=E.nextSibling;if(D&&D.nodeType===wysihtml5.TEXT_NODE){D.data=E.data.replace(x,"")+D.data.replace(x,"")}else{var C=E.data.replace(x,"");return E.ownerDocument.createTextNode(C)}}function h(C){if(s.comments){return C.ownerDocument.createComment(C.nodeValue)}}var q={url:(function(){var C=/^https?:\/\//i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),src:(function(){var C=/^(\/|https?:\/\/)/i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),href:(function(){var C=/^(#|\/|https?:\/\/|mailto:)/i;return function(D){if(!D||!D.match(C)){return null}return D.replace(C,function(E){return E.toLowerCase()})}})(),alt:(function(){var C=/[^ a-z0-9_\-]/gi;return function(D){if(!D){return""}return D.replace(C,"")}})(),numbers:(function(){var C=/\D/g;return function(D){D=(D||"").replace(C,"");return D||null}})(),any:(function(){return function(C){return C}})()};var o={align_text:(function(){var C={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(D){return C[String(D).toLowerCase()]}})(),};var n={align_img:(function(){var C={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(D){return C[String(D).toLowerCase()]}})(),align_text:(function(){var C={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(D){return C[String(D).toLowerCase()]}})(),clear_br:(function(){var C={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(D){return C[String(D).toLowerCase()]}})(),size_font:(function(){var C={"1":"wysiwyg-font-size-xx-small","2":"wysiwyg-font-size-small","3":"wysiwyg-font-size-medium","4":"wysiwyg-font-size-large","5":"wysiwyg-font-size-x-large","6":"wysiwyg-font-size-xx-large","7":"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(D){return C[String(D).charAt(0)]}})()};var A={has_visible_contet:(function(){var D,C=false,E=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(F){D=(F.innerText||F.textContent).replace(/\s/g,"");if(D&&D.length>0){return true}for(var G=E.length;G--;){if(F.querySelector(E[G])){return true}}if(F.offsetWidth&&F.offsetWidth>0&&F.offsetHeight&&F.offsetHeight>0){return true}return false}})()};var v={unwrap:function(C){wysihtml5.dom.unwrap(C)},remove:function(C){C.parentNode.removeChild(C)}};return z(w,r)};wysihtml5.dom.removeEmptyTextNodes=function(f){var a,b=wysihtml5.lang.array(f.childNodes).get(),d=b.length,e=0;for(;e<d;e++){a=b[e];if(a.nodeType===wysihtml5.TEXT_NODE&&a.data===""){a.parentNode.removeChild(a)}}};wysihtml5.dom.renameElement=function(a,e){var d=a.ownerDocument.createElement(e),b;while(b=a.firstChild){d.appendChild(b)}wysihtml5.dom.copyAttributes(["align","className"]).from(a).to(d);a.parentNode.replaceChild(d,a);return d};wysihtml5.dom.replaceWithChildNodes=function(b){if(!b.parentNode){return}if(!b.firstChild){b.parentNode.removeChild(b);return}var a=b.ownerDocument.createDocumentFragment();while(b.firstChild){a.appendChild(b.firstChild)}b.parentNode.replaceChild(a,b);b=a=null};(function(e){function b(g){return e.getStyle("display").from(g)==="block"}function d(g){return g.nodeName==="BR"}function a(g){var h=g.ownerDocument.createElement("br");g.appendChild(h)}function f(l,q){if(!l.nodeName.match(/^(MENU|UL|OL)$/)){return}var g=l.ownerDocument,i=g.createDocumentFragment(),o=wysihtml5.dom.domNode(l).prev({ignoreBlankTexts:true}),h,k,j,p,n,m;if(q){if(o&&!b(o)&&!d(o)){a(i)}while(m=(l.firstElementChild||l.firstChild)){k=m.lastChild;while(h=m.firstChild){j=h===k;p=j&&!b(h)&&!d(h);i.appendChild(h);if(p){a(i)}}m.parentNode.removeChild(m)}}else{while(m=(l.firstElementChild||l.firstChild)){if(m.querySelector&&m.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6")){while(h=m.firstChild){i.appendChild(h)}}else{n=g.createElement("p");while(h=m.firstChild){n.appendChild(h)}i.appendChild(n)}m.parentNode.removeChild(m)}}l.parentNode.replaceChild(i,l)}e.resolveList=f})(wysihtml5.dom);(function(f){var a=document,d=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],e=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],b=["referrer","write","open","close"];f.dom.Sandbox=Base.extend({constructor:function(h,g){this.callback=h||f.EMPTY_FUNCTION;this.config=f.lang.object({}).merge(g).get();this.editableArea=this._createIframe()},insertInto:function(g){if(typeof(g)==="string"){g=a.getElementById(g)}g.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var g=this.getIframe();g.parentNode.removeChild(g)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var h=this,g=a.createElement("iframe");g.className="wysihtml5-sandbox";f.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(g);if(f.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()){g.src="javascript:'<html></html>'"}g.onload=function(){g.onreadystatechange=g.onload=null;h._onLoadIframe(g)};g.onreadystatechange=function(){if(/loaded|complete/.test(g.readyState)){g.onreadystatechange=g.onload=null;h._onLoadIframe(g)}};return g},_onLoadIframe:function(j){if(!f.dom.contains(a.documentElement,j)){return}var o=this,l=j.contentWindow,k=j.contentWindow.document,g=a.characterSet||a.charset||"utf-8",n=this._getHtml({charset:g,stylesheets:this.config.stylesheets});k.open("text/html","replace");k.write(n);k.close();this.getWindow=function(){return j.contentWindow};this.getDocument=function(){return j.contentWindow.document};l.onerror=function(i,p,q){throw new Error("wysihtml5.Sandbox: "+i,p,q)};if(!f.browser.supportsSandboxedIframes()){var h,m;for(h=0,m=d.length;h<m;h++){this._unset(l,d[h])}for(h=0,m=e.length;h<m;h++){this._unset(l,e[h],f.EMPTY_FUNCTION)}for(h=0,m=b.length;h<m;h++){this._unset(k,b[h])}this._unset(k,"cookie","",true)}this.loaded=true;setTimeout(function(){o.callback(o)},0)},_getHtml:function(l){var k=l.stylesheets,g="",h=0,j;k=typeof(k)==="string"?[k]:k;if(k){j=k.length;for(;h<j;h++){g+='<link rel="stylesheet" href="'+k[h]+'">'}}l.stylesheets=g;return f.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(l)},_unset:function(i,j,l,k){try{i[j]=l}catch(h){}try{i.__defineGetter__(j,function(){return l})}catch(h){}if(k){try{i.__defineSetter__(j,function(){})}catch(h){}}if(!f.browser.crashesWhenDefineProperty(j)){try{var g={get:function(){return l}};if(k){g.set=function(){}}Object.defineProperty(i,j,g)}catch(h){}}}})})(wysihtml5);(function(b){var a=document;b.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(f,d,e){this.callback=f||b.EMPTY_FUNCTION;this.config=b.lang.object({}).merge(d).get();if(e){this.element=this._bindElement(e)}else{this.element=this._createElement()}},_createElement:function(){var d=a.createElement("div");d.className="wysihtml5-sandbox";this._loadElement(d);return d},_bindElement:function(d){d.className=(d.className&&d.className!="")?d.className+" wysihtml5-sandbox":"wysihtml5-sandbox";this._loadElement(d,true);return d},_loadElement:function(e,d){var g=this;if(!d){var f=this._getHtml();e.innerHTML=f}this.getWindow=function(){return e.ownerDocument.defaultView};this.getDocument=function(){return e.ownerDocument};this.loaded=true;setTimeout(function(){g.callback(g)},0)},_getHtml:function(d){return""}})})(wysihtml5);(function(){var a={className:"class"};wysihtml5.dom.setAttributes=function(b){return{on:function(d){for(var e in b){d.setAttribute(a[e]||e,b[e])}}}}})();wysihtml5.dom.setStyles=function(a){return{on:function(b){var e=b.style;if(typeof(a)==="string"){e.cssText+=";"+a;return}for(var d in a){if(d==="float"){e.cssFloat=a[d];e.styleFloat=a[d]}else{e[d]=a[d]}}}}};(function(a){a.simulatePlaceholder=function(d,h,e){var b="placeholder",g=function(){var i=h.element.offsetWidth>0&&h.element.offsetHeight>0;if(h.hasPlaceholderSet()){h.clear();h.element.focus();if(i){setTimeout(function(){var j=h.selection.getSelection();if(!j.focusNode||!j.anchorNode){h.selection.selectNode(h.element.firstChild||h.element)}},0)}}h.placeholderSet=false;a.removeClass(h.element,b)},f=function(){if(h.isEmpty()){h.placeholderSet=true;h.setValue(e);a.addClass(h.element,b)}};d.on("set_placeholder",f).on("unset_placeholder",g).on("focus:composer",g).on("paste:composer",g).on("blur:composer",f);f()}})(wysihtml5.dom);(function(b){var a=document.documentElement;if("textContent" in a){b.setTextContent=function(d,e){d.textContent=e};b.getTextContent=function(d){return d.textContent}}else{if("innerText" in a){b.setTextContent=function(d,e){d.innerText=e};b.getTextContent=function(d){return d.innerText}}else{b.setTextContent=function(d,e){d.nodeValue=e};b.getTextContent=function(d){return d.nodeValue}}}})(wysihtml5.dom);wysihtml5.dom.getAttribute=function(e,a){var b=!wysihtml5.browser.supportsGetAttributeCorrectly();a=a.toLowerCase();var f=e.nodeName;if(f=="IMG"&&a=="src"&&wysihtml5.dom.isLoadedImage(e)===true){return e.src}else{if(b&&"outerHTML" in e){var g=e.outerHTML.toLowerCase(),d=g.indexOf(" "+a+"=")!=-1;return d?e.getAttribute(a):null}else{return e.getAttribute(a)}}};wysihtml5.dom.getAttributes=function(e){var d=!wysihtml5.browser.supportsGetAttributeCorrectly(),f=e.nodeName,b=[],a;for(a in e.attributes){if((e.attributes.hasOwnProperty&&e.attributes.hasOwnProperty(a))||(!e.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e.attributes,a))){if(e.attributes[a].specified){if(f=="IMG"&&e.attributes[a].name.toLowerCase()=="src"&&wysihtml5.dom.isLoadedImage(e)===true){b.src=e.src}else{if(wysihtml5.lang.array(["rowspan","colspan"]).contains(e.attributes[a].name.toLowerCase())&&d){if(e.attributes[a].value!==1){b[e.attributes[a].name]=e.attributes[a].value}}else{b[e.attributes[a].name]=e.attributes[a].value}}}}}return b};wysihtml5.dom.isLoadedImage=function(b){try{return b.complete&&!b.mozMatchesSelector(":-moz-broken")}catch(a){if(b.complete&&b.readyState==="complete"){return true}}};(function(i){var a=i.dom;var d=function(j){this.el=j;this.isColspan=false;this.isRowspan=false;this.firstCol=true;this.lastCol=true;this.firstRow=true;this.lastRow=true;this.isReal=true;this.spanCollection=[];this.modified=false};var h=function(j,k){if(j){this.cell=j;this.table=a.getParentElement(j,{nodeName:["TABLE"]})}else{if(k){this.table=k;this.cell=this.table.querySelectorAll("th, td")[0]}}};function f(m,o){var p=[],n;for(var j=0,l=m.length;j<l;j++){n=m[j].querySelectorAll(o);if(n){for(var k=n.length;k--;p.unshift(n[k])){}}}return p}function g(j){j.parentNode.removeChild(j)}function b(k,j){k.parentNode.insertBefore(j,k.nextSibling)}function e(k,l){var j=k.nextSibling;while(j.nodeType!=1){j=j.nextSibling;if(!l||l==j.tagName.toLowerCase()){return j}}return null}h.prototype={addSpannedCellToMap:function(l,o,p,j,n,t){var u=[],q=p+((t)?parseInt(t,10)-1:0),m=j+((n)?parseInt(n,10)-1:0);for(var s=p;s<=q;s++){if(typeof o[s]=="undefined"){o[s]=[]}for(var k=j;k<=m;k++){o[s][k]=new d(l);o[s][k].isColspan=(n&&parseInt(n,10)>1);o[s][k].isRowspan=(t&&parseInt(t,10)>1);o[s][k].firstCol=k==j;o[s][k].lastCol=k==m;o[s][k].firstRow=s==p;o[s][k].lastRow=s==q;o[s][k].isReal=k==j&&s==p;o[s][k].spanCollection=u;u.push(o[s][k])}}},setCellAsModified:function(j){j.modified=true;if(j.spanCollection.length>0){for(var k=0,l=j.spanCollection.length;k<l;k++){j.spanCollection[k].modified=true}}},setTableMap:function(){var o=[];var s=this.getTableRows(),p,q,l,m,k,j,n,r;for(p=0;p<s.length;p++){q=s[p];l=this.getRowCells(q);j=0;if(typeof o[p]=="undefined"){o[p]=[]}for(m=0;m<l.length;m++){k=l[m];while(typeof o[p][j]!="undefined"){j++}n=a.getAttribute(k,"colspan");r=a.getAttribute(k,"rowspan");if(n||r){this.addSpannedCellToMap(k,o,p,j,n,r);j=j+((n)?parseInt(n,10):1)}else{o[p][j]=new d(k);j++}}}this.map=o;return o},getRowCells:function(m){var l=this.table.querySelectorAll("table"),k=(l)?f(l,"th, td"):[],j=m.querySelectorAll("th, td"),n=(k.length>0)?i.lang.array(j).without(k):j;return n},getTableRows:function(){var l=this.table.querySelectorAll("table"),k=(l)?f(l,"tr"):[],j=this.table.querySelectorAll("tr"),m=(k.length>0)?i.lang.array(j).without(k):j;return m},getMapIndex:function(l){var n=this.map.length,k=(this.map&&this.map[0])?this.map[0].length:0;for(var m=0;m<n;m++){for(var j=0;j<k;j++){if(this.map[m][j].el===l){return{row:m,col:j}}}}return false},getElementAtIndex:function(j){this.setTableMap();if(this.map[j.row]&&this.map[j.row][j.col]&&this.map[j.row][j.col].el){return this.map[j.row][j.col].el}return null},getMapElsTo:function(q){var k=[];this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(q);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var p=this.idx_start;this.idx_start=this.idx_end;this.idx_end=p}if(this.idx_start.col>this.idx_end.col){var o=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=o}if(this.idx_start!=null&&this.idx_end!=null){for(var n=this.idx_start.row,m=this.idx_end.row;n<=m;n++){for(var j=this.idx_start.col,l=this.idx_end.col;j<=l;j++){k.push(this.map[n][j].el)}}}return k},orderSelectionEnds:function(j){this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(j);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var l=this.idx_start;this.idx_start=this.idx_end;this.idx_end=l}if(this.idx_start.col>this.idx_end.col){var k=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=k}return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(q,p,k){var m=this.table.ownerDocument,n=m.createDocumentFragment(),l;for(var o=0;o<p;o++){l=m.createElement(q);if(k){for(var j in k){if(k.hasOwnProperty(j)){l.setAttribute(j,k[j])}}}l.appendChild(document.createTextNode("\u00a0"));n.appendChild(l)}return n},correctColIndexForUnreals:function(j,o){var n=this.map[o],k=-1;for(var l=0,m=j;l<j;l++){if(n[l].isReal){k++}}return k},getLastNewCellOnRow:function(o,p){var k=this.getRowCells(o),j,n;for(var l=0,m=k.length;l<m;l++){j=k[l];n=this.getMapIndex(j);if(n===false||(typeof p!="undefined"&&n.row!=p)){return j}}return null},removeEmptyTable:function(){var j=this.table.querySelectorAll("td, th");if(!j||j.length==0){g(this.table);return true}else{return false}},splitRowToCells:function(j){if(j.isColspan){var k=parseInt(a.getAttribute(j.el,"colspan")||1,10),l=j.el.tagName.toLowerCase();if(k>1){var m=this.createCells(l,k-1);b(j.el,m)}j.el.removeAttribute("colspan")}},getRealRowEl:function(m,n){var o=null,j=null;n=n||this.idx;for(var k=0,l=this.map[n.row].length;k<l;k++){j=this.map[n.row][k];if(j.isReal){o=a.getParentElement(j.el,{nodeName:["TR"]});if(o){return o}}}if(o===null&&m){o=a.getParentElement(this.map[n.row][n.col].el,{nodeName:["TR"]})||null}return o},injectRowAt:function(q,k,l,m,j){var p=this.getRealRowEl(false,{row:q,col:k}),o=this.createCells(m,l);if(p){var n=this.correctColIndexForUnreals(k,q);if(n>=0){b(this.getRowCells(p)[n],o)}else{p.insertBefore(o,p.firstChild)}}else{var s=this.table.ownerDocument.createElement("tr");s.appendChild(o);b(a.getParentElement(j.el,{nodeName:["TR"]}),s)}},canMerge:function(p){this.to=p;this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(this.to);if(this.idx_start.row>this.idx_end.row||(this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)){var o=this.idx_start;this.idx_start=this.idx_end;this.idx_end=o}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col;this.idx_end.col=n}for(var m=this.idx_start.row,l=this.idx_end.row;m<=l;m++){for(var j=this.idx_start.col,k=this.idx_end.col;j<=k;j++){if(this.map[m][j].isColspan||this.map[m][j].isRowspan){return false}}}return true},decreaseCellSpan:function(j,l){var k=parseInt(a.getAttribute(j.el,l),10)-1;if(k>=1){j.el.setAttribute(l,k)}else{j.el.removeAttribute(l);if(l=="colspan"){j.isColspan=false}if(l=="rowspan"){j.isRowspan=false}j.firstCol=true;j.lastCol=true;j.firstRow=true;j.lastRow=true;j.isReal=true}},removeSurplusLines:function(){var p,k,n,o,l,m,j;this.setTableMap();if(this.map){n=0;o=this.map.length;for(;n<o;n++){p=this.map[n];j=true;l=0;m=p.length;for(;l<m;l++){k=p[l];if(!(a.getAttribute(k.el,"rowspan")&&parseInt(a.getAttribute(k.el,"rowspan"),10)>1&&k.firstRow!==true)){j=false;break}}if(j){l=0;for(;l<m;l++){this.decreaseCellSpan(p[l],"rowspan")}}}var q=this.getTableRows();n=0;o=q.length;for(;n<o;n++){p=q[n];if(p.childNodes.length==0&&(/^\s*$/.test(p.textContent||p.innerText))){g(p)}}}},fillMissingCells:function(){var m=0,j=0,l=null;this.setTableMap();if(this.map){m=this.map.length;for(var n=0;n<m;n++){if(this.map[n].length>j){j=this.map[n].length}}for(var o=0;o<m;o++){for(var k=0;k<j;k++){if(this.map[o]&&!this.map[o][k]){if(k>0){this.map[o][k]=new d(this.createCells("td",1));l=this.map[o][k-1];if(l&&l.el&&l.el.parent){b(this.map[o][k-1].el,this.map[o][k].el)}}}}}}},rectify:function(){if(!this.removeEmptyTable()){this.removeSurplusLines();this.fillMissingCells();return true}else{return false}},unmerge:function(){if(this.rectify()){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx){var o=this.map[this.idx.row][this.idx.col],j=(a.getAttribute(o.el,"colspan"))?parseInt(a.getAttribute(o.el,"colspan"),10):1,k=o.el.tagName.toLowerCase();if(o.isRowspan){var n=parseInt(a.getAttribute(o.el,"rowspan"),10);if(n>1){for(var m=1,l=n-1;m<=l;m++){this.injectRowAt(this.idx.row+m,this.idx.col,j,k,o)}}o.el.removeAttribute("rowspan")}this.splitRowToCells(o)}}},merge:function(p){if(this.rectify()){if(this.canMerge(p)){var o=this.idx_end.row-this.idx_start.row+1,k=this.idx_end.col-this.idx_start.col+1;for(var n=this.idx_start.row,m=this.idx_end.row;n<=m;n++){for(var j=this.idx_start.col,l=this.idx_end.col;j<=l;j++){if(n==this.idx_start.row&&j==this.idx_start.col){if(o>1){this.map[n][j].el.setAttribute("rowspan",o)}if(k>1){this.map[n][j].el.setAttribute("colspan",k)}}else{if(!(/^\s*<br\/?>\s*$/.test(this.map[n][j].el.innerHTML.toLowerCase()))){this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[n][j].el.innerHTML}g(this.map[n][j].el)}}}this.rectify()}else{if(window.console){console.log("Do not know how to merge allready merged cells.")}}}},collapseCellToNextRow:function(j){var k=this.getMapIndex(j.el),o=k.row+1,n={row:o,col:k.col};if(o<this.map.length){var p=this.getRealRowEl(false,n);if(p!==null){var m=this.correctColIndexForUnreals(n.col,n.row);if(m>=0){b(this.getRowCells(p)[m],j.el)}else{var l=this.getLastNewCellOnRow(p,o);if(l!==null){b(l,j.el)}else{p.insertBefore(j.el,p.firstChild)}}if(parseInt(a.getAttribute(j.el,"rowspan"),10)>2){j.el.setAttribute("rowspan",parseInt(a.getAttribute(j.el,"rowspan"),10)-1)}else{j.el.removeAttribute("rowspan")}}}},removeRowCell:function(j){if(j.isReal){if(j.isRowspan){this.collapseCellToNextRow(j)}else{g(j.el)}}else{if(parseInt(a.getAttribute(j.el,"rowspan"),10)>2){j.el.setAttribute("rowspan",parseInt(a.getAttribute(j.el,"rowspan"),10)-1)}else{j.el.removeAttribute("rowspan")}}},getRowElementsByCell:function(){var j=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){var m=this.map[this.idx.row];for(var k=0,l=m.length;k<l;k++){if(m[k].isReal){j.push(m[k].el)}}}return j},getColumnElementsByCell:function(){var j=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){for(var k=0,l=this.map.length;k<l;k++){if(this.map[k][this.idx.col]&&this.map[k][this.idx.col].isReal){j.push(this.map[k][this.idx.col].el)}}}return j},removeRow:function(){var m=a.getParentElement(this.cell,{nodeName:["TR"]});if(m){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){var l=this.map[this.idx.row];for(var j=0,k=l.length;j<k;j++){if(!l[j].modified){this.setCellAsModified(l[j]);this.removeRowCell(l[j])}}}g(m)}},removeColCell:function(j){if(j.isColspan){if(parseInt(a.getAttribute(j.el,"colspan"),10)>2){j.el.setAttribute("colspan",parseInt(a.getAttribute(j.el,"colspan"),10)-1)}else{j.el.removeAttribute("colspan")}}else{if(j.isReal){g(j.el)}}},removeColumn:function(){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(this.idx!==false){for(var j=0,k=this.map.length;j<k;j++){if(!this.map[j][this.idx.col].modified){this.setCellAsModified(this.map[j][this.idx.col]);this.removeColCell(this.map[j][this.idx.col])}}}},remove:function(j){if(this.rectify()){switch(j){case"row":this.removeRow();break;case"column":this.removeColumn();break}this.rectify()}},addRow:function(p){var k=this.table.ownerDocument;this.setTableMap();this.idx=this.getMapIndex(this.cell);if(p=="below"&&a.getAttribute(this.cell,"rowspan")){this.idx.row=this.idx.row+parseInt(a.getAttribute(this.cell,"rowspan"),10)-1}if(this.idx!==false){var l=this.map[this.idx.row],m=k.createElement("tr");for(var n=0,o=l.length;n<o;n++){if(!l[n].modified){this.setCellAsModified(l[n]);this.addRowCell(l[n],m,p)}}switch(p){case"below":b(this.getRealRowEl(true),m);break;case"above":var j=a.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]});if(j){j.parentNode.insertBefore(m,j)}break}}},addRowCell:function(j,l,m){var k=(j.isColspan)?{colspan:a.getAttribute(j.el,"colspan")}:null;if(j.isReal){if(m!="above"&&j.isRowspan){j.el.setAttribute("rowspan",parseInt(a.getAttribute(j.el,"rowspan"),10)+1)}else{l.appendChild(this.createCells("td",1,k))}}else{if(m!="above"&&j.isRowspan&&j.lastRow){l.appendChild(this.createCells("td",1,k))}else{if(c.isRowspan){j.el.attr("rowspan",parseInt(a.getAttribute(j.el,"rowspan"),10)+1)}}}},add:function(j){if(this.rectify()){if(j=="below"||j=="above"){this.addRow(j)}if(j=="before"||j=="after"){this.addColumn(j)}}},addColCell:function(j,m,n){var l,k=j.el.tagName.toLowerCase();switch(n){case"before":l=(!j.isColspan||j.firstCol);break;case"after":l=(!j.isColspan||j.lastCol||(j.isColspan&&c.el==this.cell));break}if(l){switch(n){case"before":j.el.parentNode.insertBefore(this.createCells(k,1),j.el);break;case"after":b(j.el,this.createCells(k,1));break}if(j.isRowspan){this.handleCellAddWithRowspan(j,m+1,n)}}else{j.el.setAttribute("colspan",parseInt(a.getAttribute(j.el,"colspan"),10)+1)}},addColumn:function(n){var m,j;this.setTableMap();this.idx=this.getMapIndex(this.cell);if(n=="after"&&a.getAttribute(this.cell,"colspan")){this.idx.col=this.idx.col+parseInt(a.getAttribute(this.cell,"colspan"),10)-1}if(this.idx!==false){for(var k=0,l=this.map.length;k<l;k++){m=this.map[k];if(m[this.idx.col]){j=m[this.idx.col];if(!j.modified){this.setCellAsModified(j);this.addColCell(j,k,n)}}}}},handleCellAddWithRowspan:function(k,r,t){var j=parseInt(a.getAttribute(this.cell,"rowspan"),10)-1,m=a.getParentElement(k.el,{nodeName:["TR"]}),n=k.el.tagName.toLowerCase(),l,s,o=this.table.ownerDocument,q;for(var p=0;p<j;p++){l=this.correctColIndexForUnreals(this.idx.col,(r+p));m=e(m,"tr");if(m){if(l>0){switch(t){case"before":s=this.getRowCells(m);if(l>0&&this.map[r+p][this.idx.col].el!=s[l]&&l==s.length-1){b(s[l],this.createCells(n,1))}else{s[l].parentNode.insertBefore(this.createCells(n,1),s[l])}break;case"after":b(this.getRowCells(m)[l],this.createCells(n,1));break}}else{m.insertBefore(this.createCells(n,1),m.firstChild)}}else{q=o.createElement("tr");q.appendChild(this.createCells(n,1));this.table.appendChild(q)}}}};a.table={getCellsBetween:function(k,l){var j=new h(k);return j.getMapElsTo(l)},addCells:function(k,l){var j=new h(k);j.add(l)},removeCells:function(k,l){var j=new h(k);j.remove(l)},mergeCellsBetween:function(k,l){var j=new h(k);j.merge(l)},unmergeCell:function(k){var j=new h(k);j.unmerge()},orderSelectionEnds:function(k,l){var j=new h(k);return j.orderSelectionEnds(l)},indexOf:function(k){var j=new h(k);j.setTableMap();return j.getMapIndex(k)},findCell:function(l,k){var j=new h(null,l);return j.getElementAtIndex(k)},findRowByCell:function(k){var j=new h(k);return j.getRowElementsByCell()},findColumnByCell:function(k){var j=new h(k);return j.getColumnElementsByCell()},canMerge:function(k,l){var j=new h(k);return j.canMerge(l)}}})(wysihtml5);wysihtml5.dom.query=function(b,h){var j=[],g;if(b.nodeType){b=[b]}for(var a=0,f=b.length;a<f;a++){g=b[a].querySelectorAll(h);if(g){for(var d=g.length;d--;j.unshift(g[d])){}}}return j};wysihtml5.dom.compareDocumentPosition=(function(){var a=document.documentElement;if(a.compareDocumentPosition){return function(b,d){return b.compareDocumentPosition(d)}}else{return function(b,d){var m,g;if(b.nodeType===9){m=b}else{m=b.ownerDocument}if(d.nodeType===9){g=d}else{g=d.ownerDocument}if(b===d){return 0}if(b===d.ownerDocument){return 4+16}if(b.ownerDocument===d){return 2+8}if(m!==g){return 1}if(b.nodeType===2&&b.childNodes&&wysihtml5.lang.array(b.childNodes).indexOf(d)!==-1){return 4+16}if(d.nodeType===2&&d.childNodes&&wysihtml5.lang.array(d.childNodes).indexOf(b)!==-1){return 2+8}var i=b;var h=[];var j=null;while(i){if(i==d){return 2+8}h.push(i);i=i.parentNode}i=d;j=null;while(i){if(i==b){return 4+16}var e=wysihtml5.lang.array(h).indexOf(i);if(e!==-1){var k=h[e];var l=wysihtml5.lang.array(k.childNodes).indexOf(h[e-1]);var f=wysihtml5.lang.array(k.childNodes).indexOf(j);if(l>f){return 2}else{return 4}}j=i;i=i.parentNode}return 1}}})();wysihtml5.dom.unwrap=function(a){if(a.parentNode){while(a.lastChild){wysihtml5.dom.insert(a.lastChild).after(a)}a.parentNode.removeChild(a)}};wysihtml5.dom.getPastedHtml=function(a){var b;if(a.clipboardData){if(wysihtml5.lang.array(a.clipboardData.types).contains("text/html")){b=a.clipboardData.getData("text/html")}else{if(wysihtml5.lang.array(a.clipboardData.types).contains("text/plain")){b=wysihtml5.lang.string(a.clipboardData.getData("text/plain")).escapeHTML(true,true)}}}return b};wysihtml5.dom.getPastedHtmlWithDiv=function(b,e){var g=b.selection.getBookmark(),d=b.element.ownerDocument,a=d.createElement("DIV");d.body.appendChild(a);a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.setAttribute("contenteditable","true");a.focus();setTimeout(function(){b.selection.setBookmark(g);e(a.innerHTML);a.parentNode.removeChild(a)},0)};wysihtml5.quirks.cleanPastedHTML=(function(){var d=function(f){var g=wysihtml5.lang.string(f).trim(),e=g.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return new RegExp("^((?!^"+e+"$).)*$","i")};var a=function(g,e){var f=wysihtml5.lang.object(g).clone(true),i,h;for(i in f.tags){if(f.tags.hasOwnProperty(i)){if(f.tags[i].keep_styles){for(h in f.tags[i].keep_styles){if(f.tags[i].keep_styles.hasOwnProperty(h)){if(e[h]){f.tags[i].keep_styles[h]=d(e[h])}}}}}}return f};var b=function(k,f){var j,e;if(!k){return null}for(var g=0,h=k.length;g<h;g++){if(!k[g].condition){e=k[g].set}if(k[g].condition&&k[g].condition.test(f)){return k[g].set}}return e};return function(f,h){var e={color:wysihtml5.dom.getStyle("color").from(h.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(h.referenceNode)},i=a(b(h.rules,f)||{},e),g;g=wysihtml5.dom.parse(f,{rules:i,cleanUp:true,context:h.referenceNode.ownerDocument,uneditableClass:h.uneditableClass,clearInternals:true,unjoinNbsps:true});return g}})();wysihtml5.quirks.ensureProperClearing=(function(){var a=function(){var b=this;setTimeout(function(){var d=b.innerHTML.toLowerCase();if(d=="<p>&nbsp;</p>"||d=="<p>&nbsp;</p><p>&nbsp;</p>"){b.innerHTML=""}},0)};return function(b){wysihtml5.dom.observe(b.element,["cut","keydown"],a)}})();(function(b){var a="%7E";b.quirks.getCorrectInnerHTML=function(d){var g=d.innerHTML;if(g.indexOf(a)===-1){return g}var e=d.querySelectorAll("[href*='~'], [src*='~']"),j,k,h,f;for(f=0,h=e.length;f<h;f++){j=e[f].href||e[f].src;k=b.lang.string(j).replace("~").by(a);g=b.lang.string(g).replace(k).by(j)}return g}})(wysihtml5);(function(b){var a="wysihtml5-quirks-redraw";b.quirks.redraw=function(g){b.dom.addClass(g,a);b.dom.removeClass(g,a);try{var d=g.ownerDocument;d.execCommand("italic",false,null);d.execCommand("italic",false,null)}catch(f){}}})(wysihtml5);wysihtml5.quirks.tableCellsSelection=function(e,f){var d=wysihtml5.dom,m={table:null,start:null,end:null,cells:null,select:n},o="wysiwyg-tmp-selected-cell",k=null,p=null;function j(){d.observe(e,"mousedown",function(q){var r=wysihtml5.dom.getParentElement(q.target,{nodeName:["TD","TH"]});if(r){i(r)}});return m}function i(q){m.start=q;m.end=q;m.cells=[q];m.table=d.getParentElement(m.start,{nodeName:["TABLE"]});if(m.table){l();d.addClass(q,o);k=d.observe(e,"mousemove",g);p=d.observe(e,"mouseup",h);f.fire("tableselectstart").fire("tableselectstart:composer")}}function l(){if(e){var r=e.querySelectorAll("."+o);if(r.length>0){for(var q=0;q<r.length;q++){d.removeClass(r[q],o)}}}}function a(q){for(var r=0;r<q.length;r++){d.addClass(q[r],o)}}function g(s){var r=null,q=d.getParentElement(s.target,{nodeName:["TD","TH"]}),t;if(q&&m.table&&m.start){r=d.getParentElement(q,{nodeName:["TABLE"]});if(r&&r===m.table){l();t=m.end;m.end=q;m.cells=d.table.getCellsBetween(m.start,q);if(m.cells.length>1){f.composer.selection.deselect()}a(m.cells);if(m.end!==t){f.fire("tableselectchange").fire("tableselectchange:composer")}}}}function h(q){k.stop();p.stop();f.fire("tableselect").fire("tableselect:composer");setTimeout(function(){b()},0)}function b(){var q=d.observe(e.ownerDocument,"click",function(r){q.stop();if(d.getParentElement(r.target,{nodeName:["TABLE"]})!=m.table){l();m.table=null;m.start=null;m.end=null;f.fire("tableunselect").fire("tableunselect:composer")}})}function n(r,q){m.start=r;m.end=q;m.table=d.getParentElement(m.start,{nodeName:["TABLE"]});selectedCells=d.table.getCellsBetween(m.start,m.end);a(selectedCells);b();f.fire("tableselect").fire("tableselect:composer")}return j()};(function(g){var f=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,e=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,b=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,a=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i;var d=function(h){return new RegExp("(^|\\s|;)"+h+"\\s*:\\s*[^;$]+","gi")};g.quirks.styleParser={parseColor:function(p,k){var l=d(k),m=p.match(l),n=10,o,h;if(m){for(var j=m.length;j--;){m[j]=g.lang.string(m[j].split(":")[1]).trim()}o=m[m.length-1];if(f.test(o)){h=o.match(f)}else{if(e.test(o)){h=o.match(e)}else{if(b.test(o)){h=o.match(b);n=16}else{if(a.test(o)){h=o.match(a);h.shift();h.push(1);return g.lang.array(h).map(function(i,q){return(q<3)?(parseInt(i,16)*16)+parseInt(i,16):parseFloat(i)})}}}}if(h){h.shift();if(!h[3]){h.push(1)}return g.lang.array(h).map(function(i,q){return(q<3)?parseInt(i,n):parseFloat(i)})}}return false},unparseColor:function(i,h){if(h){if(h=="hex"){return(i[0].toString(16).toUpperCase())+(i[1].toString(16).toUpperCase())+(i[2].toString(16).toUpperCase())}else{if(h=="hash"){return"#"+(i[0].toString(16).toUpperCase())+(i[1].toString(16).toUpperCase())+(i[2].toString(16).toUpperCase())}else{if(h=="rgb"){return"rgb("+i[0]+","+i[1]+","+i[2]+")"}else{if(h=="rgba"){return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"}else{if(h=="csv"){return i[0]+","+i[1]+","+i[2]+","+i[3]}}}}}}if(i[3]&&i[3]!==1){return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"}else{return"rgb("+i[0]+","+i[1]+","+i[2]+")"}},parseFontSize:function(i){var h=i.match(d("font-size"));if(h){return g.lang.string(h[h.length-1].split(":")[1]).trim()}return false}}})(wysihtml5);(function(f){var b=f.dom;function a(g){var h=0;if(g.parentNode){do{h+=g.offsetTop||0;g=g.offsetParent}while(g)}return h}function e(g,h){var i=0;while(h!==g){i++;h=h.parentNode;if(!h){throw new Error("not a descendant of ancestor!")}}return i}function d(i){if(i.canSurroundContents()){return}var g=i.commonAncestorContainer,j=e(g,i.startContainer),h=e(g,i.endContainer);while(!i.canSurroundContents()){if(j>h){i.setStartBefore(i.startContainer);j=e(g,i.startContainer)}else{i.setEndAfter(i.endContainer);h=e(g,i.endContainer)}}}f.Selection=Base.extend({constructor:function(h,g,i){window.rangy.init();this.editor=h;this.composer=h.composer;this.doc=this.composer.doc;this.contain=g;this.unselectableClass=i||false},getBookmark:function(){var g=this.getRange();if(g){d(g)}return g&&g.cloneRange()},setBookmark:function(g){if(!g){return}this.setSelection(g)},setBefore:function(g){var h=rangy.createRange(this.doc);h.setStartBefore(g);h.setEndBefore(g);return this.setSelection(h)},setAfter:function(g){var h=rangy.createRange(this.doc);h.setStartAfter(g);h.setEndAfter(g);return this.setSelection(h)},selectNode:function(o,g){var p=rangy.createRange(this.doc),m=o.nodeType===f.ELEMENT_NODE,h="canHaveHTML" in o?o.canHaveHTML:(o.nodeName!=="IMG"),i=m?o.innerHTML:o.data,n=(i===""||i===f.INVISIBLE_SPACE),j=b.getStyle("display").from(o),l=(j==="block"||j==="list-item");if(n&&m&&h&&!g){try{o.innerHTML=f.INVISIBLE_SPACE}catch(k){}}if(h){p.selectNodeContents(o)}else{p.selectNode(o)}if(h&&n&&m){p.collapse(l)}else{if(h&&n){p.setStartAfter(o);p.setEndAfter(o)}}this.setSelection(p)},getSelectedNode:function(g){var i,h;if(g&&this.doc.selection&&this.doc.selection.type==="Control"){h=this.doc.selection.createRange();if(h&&h.length){return h.item(0)}}i=this.getSelection(this.doc);if(i.focusNode===i.anchorNode){return i.focusNode}else{h=this.getRange(this.doc);return h?h.commonAncestorContainer:this.doc.body}},fixSelBorders:function(){var g=this.getRange();d(g);this.setSelection(g)},getSelectedOwnNodes:function(g){var m,l=this.getOwnRanges(),k=[];for(var h=0,j=l.length;h<j;h++){k.push(l[h].commonAncestorContainer||this.doc.body)}return k},findNodesInSelection:function(l){var m=this.getOwnRanges(),k=[],g;for(var h=0,j=m.length;h<j;h++){g=m[h].getNodes([1],function(i){return f.lang.array(l).contains(i.nodeName)});k=k.concat(g)}return k},containsUneditable:function(){var k=this.getOwnUneditables(),j=this.getSelection();for(var g=0,h=k.length;g<h;g++){if(j.containsNode(k[g])){return true}}return false},deleteContents:function(){var h=this.getOwnRanges();for(var g=h.length;g--;){h[g].deleteContents()}this.setSelection(h[0])},getPreviousNode:function(h,g){if(!h){var k=this.getSelection();h=k.anchorNode}if(h===this.contain){return false}var j=h.previousSibling,i;if(j===this.contain){return false}if(j&&j.nodeType!==3&&j.nodeType!==1){j=this.getPreviousNode(j,g)}else{if(j&&j.nodeType===3&&(/^\s*$/).test(j.textContent)){j=this.getPreviousNode(j,g)}else{if(g&&j&&j.nodeType===1&&!f.lang.array(["BR","HR","IMG"]).contains(j.nodeName)&&(/^[\s]*$/).test(j.innerHTML)){j=this.getPreviousNode(j,g)}else{if(!j&&h!==this.contain){i=h.parentNode;if(i!==this.contain){j=this.getPreviousNode(i,g)}}}}}return(j!==this.contain)?j:false},getSelectionParentsByTag:function(m){var k=this.getSelectedOwnNodes(),g,l=[];for(var h=0,j=k.length;h<j;h++){g=(k[h].nodeName&&k[h].nodeName==="LI")?k[h]:f.dom.getParentElement(k[h],{nodeName:["LI"]},false,this.contain);if(g){l.push(g)}}return(l.length)?l:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var i=this.getRange(),j=i.startContainer,h=i.startOffset,g=rangy.createRange(this.doc);g.selectNodeContents(j);g.setStart(j,h);return g}},caretIsLastInSelection:function(){var i=rangy.createRange(this.doc),j=this.getSelection(),g=this.getRangeToNodeEnd().cloneContents(),h=g.textContent;return(/^\s*$/).test(h)},caretIsFirstInSelection:function(){var g=rangy.createRange(this.doc),i=this.getSelection(),h=this.getRange(),j=h.startContainer;if(j.nodeType===f.TEXT_NODE){return this.isCollapsed()&&(j.nodeType===f.TEXT_NODE&&(/^\s*$/).test(j.data.substr(0,h.startOffset)))}else{g.selectNodeContents(this.getRange().commonAncestorContainer);g.collapse(true);return(this.isCollapsed()&&(g.startContainer===i.anchorNode||g.endContainer===i.anchorNode)&&g.startOffset===i.anchorOffset)}},caretIsInTheBeginnig:function(i){var j=this.getSelection(),g=j.anchorNode,h=j.anchorOffset;if(i){return(h===0&&(g.nodeName&&g.nodeName===i.toUpperCase()||f.dom.getParentElement(g.parentNode,{nodeName:i},1)))}else{return(h===0&&!this.getPreviousNode(g,true))}},caretIsBeforeUneditable:function(){var m=this.getSelection(),j=m.anchorNode,k=m.anchorOffset;if(k===0){var l=this.getPreviousNode(j,true);if(l){var n=this.getOwnUneditables();for(var g=0,h=n.length;g<h;g++){if(l===n[g]){return n[g]}}}}return false},executeAndRestoreRangy:function(h,i){var k=this.doc.defaultView||this.doc.parentWindow,j=rangy.saveSelection(k);if(!j){h()}else{try{h()}catch(g){setTimeout(function(){throw g},0)}}rangy.restoreSelection(j)},executeAndRestore:function(n,z){var g=this.doc.body,u=z&&g.scrollTop,t=z&&g.scrollLeft,j="_wysihtml5-temp-placeholder",v='<span class="'+j+'">'+f.INVISIBLE_SPACE+"</span>",x=this.getRange(true),h,o,q,w,r,s,y,p;if(!x){n(g,g);return}if(!x.collapsed){y=x.cloneRange();s=y.createContextualFragment(v);y.collapse(false);y.insertNode(s);y.detach()}r=x.createContextualFragment(v);x.insertNode(r);if(s){h=this.contain.querySelectorAll("."+j);x.setStartBefore(h[0]);x.setEndAfter(h[h.length-1])}this.setSelection(x);try{n(x.startContainer,x.endContainer)}catch(k){setTimeout(function(){throw k},0)}h=this.contain.querySelectorAll("."+j);if(h&&h.length){p=rangy.createRange(this.doc);q=h[0].nextSibling;if(h.length>1){w=h[h.length-1].previousSibling}if(w&&q){p.setStartBefore(q);p.setEndAfter(w)}else{o=this.doc.createTextNode(f.INVISIBLE_SPACE);b.insert(o).after(h[0]);p.setStartBefore(o);p.setEndAfter(o)}this.setSelection(p);for(var m=h.length;m--;){h[m].parentNode.removeChild(h[m])}}else{this.contain.focus()}if(z){g.scrollTop=u;g.scrollLeft=t}try{h.parentNode.removeChild(h)}catch(l){}},set:function(h,i){var g=rangy.createRange(this.doc);g.setStart(h,i||0);this.setSelection(g)},insertHTML:function(h){var k=rangy.createRange(this.doc),j=this.doc.createElement("DIV"),g=this.doc.createDocumentFragment(),i;j.innerHTML=h;i=j.lastChild;while(j.firstChild){g.appendChild(j.firstChild)}this.insertNode(g);if(i){this.setAfter(i)}},insertNode:function(g){var h=this.getRange();if(h){h.insertNode(g)}},surround:function(k){var m=this.getOwnRanges(),j,l=[];if(m.length==0){return l}for(var h=m.length;h--;){j=this.doc.createElement(k.nodeName);l.push(j);if(k.className){j.className=k.className}if(k.cssStyle){j.setAttribute("style",k.cssStyle)}try{m[h].surroundContents(j);this.selectNode(j)}catch(g){j.appendChild(m[h].extractContents());m[h].insertNode(j)}}return l},deblockAndSurround:function(h){var k=this.doc.createElement("div"),i=rangy.createRange(this.doc),j,l,g;k.className=h.className;this.composer.commands.exec("formatBlock",h.nodeName,h.className);j=this.contain.querySelectorAll("."+h.className);if(j[0]){j[0].parentNode.insertBefore(k,j[0]);i.setStartBefore(j[0]);i.setEndAfter(j[j.length-1]);l=i.extractContents();while(l.firstChild){g=l.firstChild;if(g.nodeType==1&&f.dom.hasClass(g,h.className)){while(g.firstChild){k.appendChild(g.firstChild)}if(g.nodeName!=="BR"){k.appendChild(this.doc.createElement("br"))}l.removeChild(g)}else{k.appendChild(g)}}}else{k=null}return k},scrollIntoView:function(){var g=this.doc,k=5,h=g.documentElement.scrollHeight>g.documentElement.offsetHeight,j=g._wysihtml5ScrollIntoViewElement=g._wysihtml5ScrollIntoViewElement||(function(){var l=g.createElement("span");l.innerHTML=f.INVISIBLE_SPACE;return l})(),i;if(h){this.insertNode(j);i=a(j);j.parentNode.removeChild(j);if(i>=(g.body.scrollTop+g.documentElement.offsetHeight-k)){g.body.scrollTop=i}}},selectLine:function(){if(f.browser.supportsSelectionModify()){this._selectLine_W3C()}else{if(this.doc.selection){this._selectLine_MSIE()}}},_selectLine_W3C:function(){var h=this.doc.defaultView,g=h.getSelection();g.modify("move","left","lineboundary");g.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var n=this.doc.selection.createRange(),q=n.boundingTop,r=this.doc.body.scrollWidth,o,p,m,k,l;if(!n.moveToPoint){return}if(q===0){m=this.doc.createElement("span");this.insertNode(m);q=m.offsetTop;m.parentNode.removeChild(m)}q+=1;for(k=-10;k<r;k+=2){try{n.moveToPoint(k,q);break}catch(g){}}o=q;p=this.doc.selection.createRange();for(l=r;l>=0;l--){try{p.moveToPoint(l,o);break}catch(h){}}n.setEndPoint("EndToEnd",p);n.select()},getText:function(){var g=this.getSelection();return g?g.toString():""},getNodes:function(h,g){var i=this.getRange();if(i){return i.getNodes([h],g)}else{return[]}},fixRangeOverflow:function(i){if(this.contain&&this.contain.firstChild&&i){var g=i.compareNode(this.contain);if(g!==2){if(g===1){i.setStartBefore(this.contain.firstChild)}if(g===0){i.setEndAfter(this.contain.lastChild)}if(g===3){i.setStartBefore(this.contain.firstChild);i.setEndAfter(this.contain.lastChild)}}else{if(this._detectInlineRangeProblems(i)){var h=i.endContainer.previousElementSibling;if(h){i.setEnd(h,this._endOffsetForNode(h))}}}}},_endOffsetForNode:function(g){var h=document.createRange();h.selectNodeContents(g);return h.endOffset},_detectInlineRangeProblems:function(h){var g=b.compareDocumentPosition(h.startContainer,h.endContainer);return(h.endOffset==0&&g&4)},getRange:function(g){var i=this.getSelection(),h=i&&i.rangeCount&&i.getRangeAt(0);if(g!==true){this.fixRangeOverflow(h)}return h},getOwnUneditables:function(){var g=b.query(this.contain,"."+this.unselectableClass),h=b.query(g,"."+this.unselectableClass);return f.lang.array(g).without(h)},getOwnRanges:function(){var n=[],m=this.getRange(),p;if(m){n.push(m)}if(this.unselectableClass&&this.contain&&m){var q=this.getOwnUneditables(),o;if(q.length>0){for(var g=0,h=q.length;g<h;g++){p=[];for(var k=0,l=n.length;k<l;k++){if(n[k]){switch(n[k].compareNode(q[g])){case 2:break;case 3:o=n[k].cloneRange();o.setEndBefore(q[g]);p.push(o);o=n[k].cloneRange();o.setStartAfter(q[g]);p.push(o);break;default:p.push(n[k])}}n=p}}}}return n},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(g){var i=this.doc.defaultView||this.doc.parentWindow,h=rangy.getSelection(i);return h.setSingleRange(g)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},isEndToEndInNode:function(h){var j=this.getRange(),i=j.commonAncestorContainer,k=j.startContainer,g=j.endContainer;if(i.nodeType===f.TEXT_NODE){i=i.parentNode}if(k.nodeType===f.TEXT_NODE&&!(/^\s*$/).test(k.data.substr(j.startOffset))){return false}if(g.nodeType===f.TEXT_NODE&&!(/^\s*$/).test(g.data.substr(j.endOffset))){return false}while(k&&k!==i){if(k.nodeType!==f.TEXT_NODE&&!f.dom.contains(i,k)){return false}if(f.dom.domNode(k).prev({ignoreBlankTexts:true})){return false}k=k.parentNode}while(g&&g!==i){if(g.nodeType!==f.TEXT_NODE&&!f.dom.contains(i,g)){return false}if(f.dom.domNode(g).next({ignoreBlankTexts:true})){return false}g=g.parentNode}return(f.lang.array(h).contains(i.nodeName))?i:false},deselect:function(){var g=this.getSelection();g&&g.removeAllRanges()}})})(wysihtml5);(function(v,o){var e="span";var p=/\s+/g;function h(x,w,z){if(!x.className){return false}var y=x.className.match(z)||[];return y[y.length-1]===w}function j(w,y){if(!w.getAttribute||!w.getAttribute("style")){return false}var x=w.getAttribute("style").match(y);return(w.getAttribute("style").match(y))?true:false}function b(x,w,y){if(x.getAttribute("style")){s(x,y);if(x.getAttribute("style")&&!(/^\s*$/).test(x.getAttribute("style"))){x.setAttribute("style",w+";"+x.getAttribute("style"))}else{x.setAttribute("style",w)}}else{x.setAttribute("style",w)}}function a(x,w,y){if(x.className){q(x,y);x.className+=" "+w}else{x.className=w}}function q(w,x){if(w.className){w.className=w.className.replace(x,"")}}function s(w,y){var z,A=[];if(w.getAttribute("style")){z=w.getAttribute("style").split(";");for(var x=z.length;x--;){if(!z[x].match(y)&&!(/^\s*$/).test(z[x])){A.push(z[x])}}if(A.length){w.setAttribute("style",A.join(";"))}else{w.removeAttribute("style")}}}function g(w,D){var B=[],C=D.split(";"),x=w.getAttribute("style");if(x){x=x.replace(/\s/gi,"").toLowerCase();B.push(new RegExp("(^|\\s|;)"+D.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var y=C.length;y-->0;){if(!(/^\s*$/).test(C[y])){B.push(new RegExp("(^|\\s|;)"+C[y].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"))}}for(var z=0,A=B.length;z<A;z++){if(x.match(B[z])){return B[z]}}}return false}function l(x,z,y,w){if(y){return g(x,y)}else{if(w){return v.dom.hasClass(x,w)}else{return o.dom.arrayContains(z,x.tagName.toLowerCase())}}}function d(y,A,z,w){for(var x=y.length;x--;){if(!l(y[x],A,z,w)){return false}}return y.length?true:false}function r(w,z,y){var x=g(w,z);if(x){s(w,x);return"remove"}else{b(w,z,y);return"change"}}function i(w,x){return w.className.replace(p," ")==x.className.replace(p," ")}function t(w){var x=w.parentNode;while(w.firstChild){x.insertBefore(w.firstChild,w)}x.removeChild(w)}function f(y,z){if(y.attributes.length!=z.attributes.length){return false}for(var A=0,B=y.attributes.length,w,x,C;A<B;++A){w=y.attributes[A];C=w.name;if(C!="class"){x=z.attributes.getNamedItem(C);if(w.specified!=x.specified){return false}if(w.specified&&w.nodeValue!==x.nodeValue){return false}}}return true}function m(w,x){if(o.dom.isCharacterDataNode(w)){if(x==0){return !!w.previousSibling}else{if(x==w.length){return !!w.nextSibling}else{return true}}}return x>0&&x<w.childNodes.length}function u(B,y,z,x){var A;if(o.dom.isCharacterDataNode(y)){if(z==0){z=o.dom.getNodeIndex(y);y=y.parentNode}else{if(z==y.length){z=o.dom.getNodeIndex(y)+1;y=y.parentNode}else{A=o.dom.splitDataNode(y,z)}}}if(!A){if(!x||y!==x){A=y.cloneNode(false);if(A.id){A.removeAttribute("id")}var w;while((w=y.childNodes[z])){A.appendChild(w)}o.dom.insertAfter(A,y)}}return(y==B)?A:u(B,A.parentNode,o.dom.getNodeIndex(A),x)}function n(w){this.isElementMerge=(w.nodeType==v.ELEMENT_NODE);this.firstTextNode=this.isElementMerge?w.lastChild:w;this.textNodes=[this.firstTextNode]}n.prototype={doMerge:function(){var A=[],B,y,z;for(var w=0,x=this.textNodes.length;w<x;++w){B=this.textNodes[w];y=B.parentNode;A[w]=B.data;if(w){y.removeChild(B);if(!y.hasChildNodes()){y.parentNode.removeChild(y)}}}this.firstTextNode.data=z=A.join("");return z},getLength:function(){var w=this.textNodes.length,x=0;while(w--){x+=this.textNodes[w].length}return x},toString:function(){var y=[];for(var w=0,x=this.textNodes.length;w<x;++w){y[w]="'"+this.textNodes[w].data+"'"}return"[Merge("+y.join(",")+")]"}};function k(C,x,A,z,y,B,w){this.tagNames=C||[e];this.cssClass=x||((x===false)?false:"");this.similarClassRegExp=A;this.cssStyle=y||"";this.similarStyleRegExp=B;this.normalize=z;this.applyToAnyTagName=false;this.container=w}k.prototype={getAncestorWithClass:function(x){var w;while(x){w=this.cssClass?h(x,this.cssClass,this.similarClassRegExp):(this.cssStyle!=="")?false:true;if(x.nodeType==v.ELEMENT_NODE&&x.getAttribute("contenteditable")!="false"&&o.dom.arrayContains(this.tagNames,x.tagName.toLowerCase())&&w){return x}x=x.parentNode}return false},getAncestorWithStyle:function(x){var w;while(x){w=this.cssStyle?j(x,this.similarStyleRegExp):false;if(x.nodeType==v.ELEMENT_NODE&&x.getAttribute("contenteditable")!="false"&&o.dom.arrayContains(this.tagNames,x.tagName.toLowerCase())&&w){return x}x=x.parentNode}return false},getMatchingAncestor:function(y){var w=this.getAncestorWithClass(y),x=false;if(!w){w=this.getAncestorWithStyle(y);if(w){x="style"}}else{if(this.cssStyle){x="class"}}return{element:w,type:x}},postApply:function(K,E){var x=K[0],z=K[K.length-1];var B=[],w;var H=x,F=z;var I=0,G=z.length;var J,D;for(var y=0,A=K.length;y<A;++y){J=K[y];D=null;if(J&&J.parentNode){D=this.getAdjacentMergeableTextNode(J.parentNode,false)}if(D){if(!w){w=new n(D);B.push(w)}w.textNodes.push(J);if(J===x){H=w.firstTextNode;I=H.length}if(J===z){F=w.firstTextNode;G=w.getLength()}}else{w=null}}if(z&&z.parentNode){var C=this.getAdjacentMergeableTextNode(z.parentNode,true);if(C){if(!w){w=new n(z);B.push(w)}w.textNodes.push(C)}}if(B.length){for(y=0,A=B.length;y<A;++y){B[y].doMerge()}E.setStart(H,I);E.setEnd(F,G)}},getAdjacentMergeableTextNode:function(A,y){var z=(A.nodeType==v.TEXT_NODE);var x=z?A.parentNode:A;var w;var B=y?"nextSibling":"previousSibling";if(z){w=A[B];if(w&&w.nodeType==v.TEXT_NODE){return w}}else{w=x[B];if(w&&this.areElementsMergeable(A,w)){return w[y?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(w,x){return o.dom.arrayContains(this.tagNames,(w.tagName||"").toLowerCase())&&o.dom.arrayContains(this.tagNames,(x.tagName||"").toLowerCase())&&i(w,x)&&f(w,x)},createContainer:function(w){var x=w.createElement(this.tagNames[0]);if(this.cssClass){x.className=this.cssClass}if(this.cssStyle){x.setAttribute("style",this.cssStyle)}return x},applyToTextNode:function(y){var x=y.parentNode;if(x.childNodes.length==1&&o.dom.arrayContains(this.tagNames,x.tagName.toLowerCase())){if(this.cssClass){a(x,this.cssClass,this.similarClassRegExp)}if(this.cssStyle){b(x,this.cssStyle,this.similarStyleRegExp)}}else{var w=this.createContainer(o.dom.getDocument(y));y.parentNode.insertBefore(w,y);w.appendChild(y)}},isRemovable:function(w){return o.dom.arrayContains(this.tagNames,w.tagName.toLowerCase())&&v.lang.string(w.className).trim()===""&&(!w.getAttribute("style")||v.lang.string(w.getAttribute("style")).trim()==="")},undoToTextNode:function(D,A,y,z){var C=(y)?false:true,w=y||z,B=false;if(!A.containsNode(w)){var x=A.cloneRange();x.selectNode(w);if(x.isPointInRange(A.endContainer,A.endOffset)&&m(A.endContainer,A.endOffset)){u(w,A.endContainer,A.endOffset,this.container);A.setEndAfter(w)}if(x.isPointInRange(A.startContainer,A.startOffset)&&m(A.startContainer,A.startOffset)){w=u(w,A.startContainer,A.startOffset,this.container)}}if(!C&&this.similarClassRegExp){q(w,this.similarClassRegExp)}if(C&&this.similarStyleRegExp){B=(r(w,this.cssStyle,this.similarStyleRegExp)==="change")}if(this.isRemovable(w)&&!B){t(w)}},applyToRange:function(A){var D;for(var B=A.length;B--;){D=A[B].getNodes([v.TEXT_NODE]);if(!D.length){try{var z=this.createContainer(A[B].endContainer.ownerDocument);A[B].surroundContents(z);this.selectNode(A[B],z);return}catch(w){}}A[B].splitBoundaries();D=A[B].getNodes([v.TEXT_NODE]);if(D.length){var C;for(var x=0,y=D.length;x<y;++x){C=D[x];if(!this.getMatchingAncestor(C).element){this.applyToTextNode(C)}}A[B].setStart(D[0],0);C=D[D.length-1];A[B].setEnd(C,C.length);if(this.normalize){this.postApply(D,A[B])}}}},undoToRange:function(D){var G,F,x,y,w;for(var E=D.length;E--;){G=D[E].getNodes([v.TEXT_NODE]);if(G.length){D[E].splitBoundaries();G=D[E].getNodes([v.TEXT_NODE])}else{var z=D[E].endContainer.ownerDocument,C=z.createTextNode(v.INVISIBLE_SPACE);D[E].insertNode(C);D[E].selectNode(C);G=[C]}for(var A=0,B=G.length;A<B;++A){if(D[E].isValid()){F=G[A];w=this.getMatchingAncestor(F);if(w.type==="style"){this.undoToTextNode(F,D[E],false,w.element)}else{if(w.element){this.undoToTextNode(F,D[E],w.element)}}}}if(B==1){this.selectNode(D[E],G[0])}else{D[E].setStart(G[0],0);F=G[G.length-1];D[E].setEnd(F,F.length);if(this.normalize){this.postApply(G,D[E])}}}},selectNode:function(C,B){var z=B.nodeType===v.ELEMENT_NODE,w="canHaveHTML" in B?B.canHaveHTML:true,x=z?B.innerHTML:B.data,A=(x===""||x===v.INVISIBLE_SPACE);if(A&&z&&w){try{B.innerHTML=v.INVISIBLE_SPACE}catch(y){}}C.selectNodeContents(B);if(A&&z){C.collapse(false)}else{if(A){C.setStartAfter(B);C.setEndAfter(B)}}},getTextSelectedByRange:function(z,x){var A=x.cloneRange();A.selectNodeContents(z);var w=A.intersection(x);var y=w?w.toString():"";A.detach();return y},isAppliedToRange:function(B){var x=[],y="full",w,E,F;for(var C=B.length;C--;){F=B[C].getNodes([v.TEXT_NODE]);if(!F.length){w=this.getMatchingAncestor(B[C].startContainer).element;return(w)?{elements:[w],coverage:y}:false}for(var z=0,A=F.length,D;z<A;++z){D=this.getTextSelectedByRange(F[z],B[C]);w=this.getMatchingAncestor(F[z]).element;if(w&&D!=""){x.push(w);if(v.dom.getTextNodes(w,true).length===1){y="full"}else{if(y==="full"){y="inline"}}}else{if(!w){y="partial"}}}}return(x.length)?{elements:x,coverage:y}:false},toggleRange:function(y){var w=this.isAppliedToRange(y),x;if(w){if(w.coverage==="full"){this.undoToRange(y)}else{if(w.coverage==="inline"){x=d(w.elements,this.tagNames,this.cssStyle,this.cssClass);this.undoToRange(y);if(!x){this.applyToRange(y)}}else{if(!d(w.elements,this.tagNames,this.cssStyle,this.cssClass)){this.undoToRange(y)}this.applyToRange(y)}}}else{this.applyToRange(y)}}};v.selection.HTMLApplier=k})(wysihtml5,rangy);wysihtml5.Commands=Base.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.doc=this.composer.doc},support:function(a){return wysihtml5.browser.supportsCommand(this.doc,a)},exec:function(b,i){var g=wysihtml5.commands[b],a=wysihtml5.lang.array(arguments).get(),f=g&&g.exec,h=null;this.editor.fire("beforecommand:composer");if(f){a.unshift(this.composer);h=f.apply(g,a)}else{try{h=this.doc.execCommand(b,false,i)}catch(d){}}this.editor.fire("aftercommand:composer");return h},state:function(b,d){var h=wysihtml5.commands[b],a=wysihtml5.lang.array(arguments).get(),g=h&&h.state;if(g){a.unshift(this.composer);return g.apply(h,a)}else{try{return this.doc.queryCommandState(b)}catch(f){return false}}},stateValue:function(b){var e=wysihtml5.commands[b],a=wysihtml5.lang.array(arguments).get(),d=e&&e.stateValue;if(d){a.unshift(this.composer);return d.apply(e,a)}else{return false}}});wysihtml5.commands.bold={exec:function(b,a){wysihtml5.commands.formatInline.execWithToggle(b,a,"b")},state:function(b,a){return wysihtml5.commands.formatInline.state(b,a,"b")}};(function(g){var f,e="A",d=g.dom;function b(m,l){var n=m.doc,u="_wysihtml5-temp-"+(+new Date()),v=/non-matching-class/g,q=0,t,k,h,p,r,o,w,x,s;g.commands.formatInline.exec(m,f,e,u,v,f,f,true,true);k=n.querySelectorAll(e+"."+u);t=k.length;for(;q<t;q++){h=k[q];h.removeAttribute("class");for(s in l){if(s!=="text"){h.setAttribute(s,l[s])}}}o=h;if(t===1){w=d.getTextContent(h);p=!!h.querySelector("*");r=w===""||w===g.INVISIBLE_SPACE;if(!p&&r){d.setTextContent(h,l.text||h.href);x=n.createTextNode(" ");m.selection.setAfter(h);d.insert(x).after(h);o=x}}m.selection.setAfter(o)}function a(l,i,k){var o;for(var h=i.length;h--;){o=i[h].attributes;for(var n=o.length;n--;){i[h].removeAttribute(o.item(n).name)}for(var m in k){if(k.hasOwnProperty(m)){i[h].setAttribute(m,k[m])}}}}g.commands.createLink={exec:function(j,i,k){var h=this.state(j,i);if(h){j.selection.executeAndRestore(function(){a(j,h,k)})}else{k=typeof(k)==="object"?k:{href:k};b(j,k)}},state:function(i,h){return g.commands.formatInline.state(i,h,"A")}}})(wysihtml5);(function(d){var b=d.dom;function a(h,f){var k=f.length,j=0,e,g,l;for(;j<k;j++){e=f[j];g=b.getParentElement(e,{nodeName:"code"});l=b.getTextContent(e);if(l.match(b.autoLink.URL_REG_EXP)&&!g){g=b.renameElement(e,"code")}else{b.replaceWithChildNodes(e)}}}d.commands.removeLink={exec:function(g,f){var e=this.state(g,f);if(e){g.selection.executeAndRestore(function(){a(g,e)})}},state:function(f,e){return d.commands.formatInline.state(f,e,"A")}}})(wysihtml5);(function(b){var a=/wysiwyg-font-size-[0-9a-z\-]+/g;b.commands.fontSize={exec:function(e,d,f){b.commands.formatInline.execWithToggle(e,d,"span","wysiwyg-font-size-"+f,a)},state:function(e,d,f){return b.commands.formatInline.state(e,d,"span","wysiwyg-font-size-"+f,a)}}})(wysihtml5);(function(b){var a=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;b.commands.fontSizeStyle={exec:function(e,d,f){f=(typeof(f)=="object")?f.size:f;if(!(/^\s*$/).test(f)){b.commands.formatInline.execWithToggle(e,d,"span",false,false,"font-size:"+f,a)}},state:function(e,d,f){return b.commands.formatInline.state(e,d,"span",false,false,"font-size",a)},stateValue:function(e,d){var g=this.state(e,d),h,f,i=false;if(g&&b.lang.object(g).isArray()){g=g[0]}if(g){h=g.getAttribute("style");if(h){return b.quirks.styleParser.parseFontSize(h)}}return false}}})(wysihtml5);(function(b){var a=/wysiwyg-color-[0-9a-z]+/g;b.commands.foreColor={exec:function(f,e,d){b.commands.formatInline.execWithToggle(f,e,"span","wysiwyg-color-"+d,a)},state:function(f,e,d){return b.commands.formatInline.state(f,e,"span","wysiwyg-color-"+d,a)}}})(wysihtml5);(function(b){var a=/(\s|^)color\s*:\s*[^;\s]+;?/gi;b.commands.foreColorStyle={exec:function(h,g,d){var e=b.quirks.styleParser.parseColor((typeof(d)=="object")?"color:"+d.color:"color:"+d,"color"),f;if(e){f="color: rgb("+e[0]+","+e[1]+","+e[2]+");";if(e[3]!==1){f+="color: rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+");"}b.commands.formatInline.execWithToggle(h,g,"span",false,false,f,a)}},state:function(e,d){return b.commands.formatInline.state(e,d,"span",false,false,"color",a)},stateValue:function(f,e,g){var h=this.state(f,e),d;if(h&&b.lang.object(h).isArray()){h=h[0]}if(h){d=h.getAttribute("style");if(d){if(d){val=b.quirks.styleParser.parseColor(d,"color");return b.quirks.styleParser.unparseColor(val,g)}}}return false}}})(wysihtml5);(function(b){var a=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;b.commands.bgColorStyle={exec:function(h,g,d){var e=b.quirks.styleParser.parseColor((typeof(d)=="object")?"background-color:"+d.color:"background-color:"+d,"background-color"),f;if(e){f="background-color: rgb("+e[0]+","+e[1]+","+e[2]+");";if(e[3]!==1){f+="background-color: rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+");"}b.commands.formatInline.execWithToggle(h,g,"span",false,false,f,a)}},state:function(e,d){return b.commands.formatInline.state(e,d,"span",false,false,"background-color",a)},stateValue:function(f,e,g){var h=this.state(f,e),d,i=false;if(h&&b.lang.object(h).isArray()){h=h[0]}if(h){d=h.getAttribute("style");if(d){i=b.quirks.styleParser.parseColor(d,"background-color");return b.quirks.styleParser.unparseColor(i,g)}}return false}}})(wysihtml5);(function(n){var m=n.dom,l=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];function a(q,o,p){if(q.className){h(q,p);q.className=n.lang.string(q.className+" "+o).trim()}else{q.className=o}}function b(p,o,q){j(p,q);if(p.getAttribute("style")){p.setAttribute("style",n.lang.string(p.getAttribute("style")+" "+o).trim())}else{p.setAttribute("style",o)}}function h(p,o){var q=o.test(p.className);p.className=p.className.replace(o,"");if(n.lang.string(p.className).trim()==""){p.removeAttribute("class")}return q}function j(o,q){var p=q.test(o.getAttribute("style"));o.setAttribute("style",(o.getAttribute("style")||"").replace(q,""));if(n.lang.string(o.getAttribute("style")||"").trim()==""){o.removeAttribute("style")}return p}function i(p){var o=p.lastChild;if(o&&g(o)){o.parentNode.removeChild(o)}}function g(o){return o.nodeName==="BR"}function d(r,q,p,u,o){var v=q.selection.getOwnRanges();for(var t=v.length;t--;){q.selection.getSelection().removeAllRanges();q.selection.setSelection(v[t]);if(o){var s=m.observe(r,"DOMNodeInserted",function(x){var y=x.target,w;if(y.nodeType!==n.ELEMENT_NODE){return}w=m.getStyle("display").from(y);if(w.substr(0,6)!=="inline"){y.className+=" "+o}})}r.execCommand(p,false,u);if(s){s.stop()}}}function k(o,r){if(o.selection.isCollapsed()){o.selection.selectLine()}var s=o.selection.surround(r);for(var p=0,q=s.length;p<q;p++){n.dom.lineBreaks(s[p]).remove();i(s[p])}}function e(o){return !!n.lang.string(o.className).trim()}function f(o){return !!n.lang.string(o.getAttribute("style")||"").trim()}n.commands.formatBlock={exec:function(v,u,z,r,s,w,B){var y=v.doc,p=this.state(v,u,z,r,s,w,B),D=v.config.useLineBreaks,x=D?"DIV":"P",A,t,q,C,o;z=typeof(z)==="string"?z.toUpperCase():z;if(p.length){v.selection.executeAndRestoreRangy(function(){for(var E=p.length;E--;){if(s){t=h(p[E],s)}if(B){C=j(p[E],B)}if((C||t)&&z===null&&p[E].nodeName!=x){return}var F=e(p[E]),G=f(p[E]);if(!F&&!G&&(D||z==="P")){n.dom.lineBreaks(p[E]).add();m.replaceWithChildNodes(p[E])}else{m.renameElement(p[E],z==="P"?"DIV":x)}}});return}if(z===null||n.lang.array(l).contains(z)){A=v.selection.findNodesInSelection(l).concat(v.selection.getSelectedOwnNodes());v.selection.executeAndRestoreRangy(function(){for(var E=A.length;E--;){o=m.getParentElement(A[E],{nodeName:l});if(o==v.element){o=null}if(o){if(z){o=m.renameElement(o,z)}if(r){a(o,r,s)}if(w){b(o,w,B)}q=true}}});if(q){return}}k(v,{nodeName:(z||x),className:r||null,cssStyle:w||null})},state:function(r,q,v,o,p,s,z){var w=r.selection.getSelectedOwnNodes(),y=[],x;v=typeof(v)==="string"?v.toUpperCase():v;for(var t=0,u=w.length;t<u;t++){x=m.getParentElement(w[t],{nodeName:v,className:o,classRegExp:p,cssStyle:s,styleRegExp:z});if(x&&n.lang.array(y).indexOf(x)==-1){y.push(x)}}if(y.length==0){return false}return y}}})(wysihtml5);wysihtml5.commands.formatCode={exec:function(e,d,a){var f=this.state(e),b,g,h;if(f){e.selection.executeAndRestore(function(){b=f.querySelector("code");wysihtml5.dom.replaceWithChildNodes(f);if(b){wysihtml5.dom.replaceWithChildNodes(b)}})}else{g=e.selection.getRange();h=g.extractContents();f=e.doc.createElement("pre");b=e.doc.createElement("code");if(a){b.className=a}f.appendChild(b);b.appendChild(h);g.insertNode(f);e.selection.selectNode(f)}},state:function(a){var b=a.selection.getSelectedNode();if(b&&b.nodeName&&b.nodeName=="PRE"&&b.firstChild&&b.firstChild.nodeName&&b.firstChild.nodeName=="CODE"){return b}else{return wysihtml5.dom.getParentElement(b,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(b,{nodeName:"PRE"})}}};(function(f){var d={strong:"b",em:"i",b:"strong",i:"em"},e={};function b(h){var g=d[h];return g?[h.toLowerCase(),g.toLowerCase()]:[h.toLowerCase()]}function a(m,g,h,j,l,i){var k=m;if(g){k+=":"+g}if(j){k+=":"+j}if(!e[k]){e[k]=new f.selection.HTMLApplier(b(m),g,h,true,j,l,i)}return e[k]}f.commands.formatInline={exec:function(j,i,q,g,h,k,p,l,m){var o=j.selection.createRange(),n=j.selection.getOwnRanges();if(!n||n.length==0){return false}j.selection.getSelection().removeAllRanges();a(q,g,h,k,p,j.element).toggleRange(n);if(!l){o.setStart(n[0].startContainer,n[0].startOffset);o.setEnd(n[n.length-1].endContainer,n[n.length-1].endOffset);j.selection.setSelection(o);j.selection.executeAndRestore(function(){if(!m){j.cleanUp()}},true,true)}else{if(!m){j.cleanUp()}}},execWithToggle:function(j,i,n,g,h,k,m){var o=this;if(this.state(j,i,n,g,h,k,m)&&j.selection.isCollapsed()&&!j.selection.caretIsLastInSelection()&&!j.selection.caretIsFirstInSelection()){var l=o.state(j,i,n,g,h)[0];j.selection.executeAndRestoreRangy(function(){var p=l.parentNode;j.selection.selectNode(l,true);f.commands.formatInline.exec(j,i,n,g,h,k,m,true,true)})}else{if(this.state(j,i,n,g,h,k,m)&&!j.selection.isCollapsed()){j.selection.executeAndRestoreRangy(function(){f.commands.formatInline.exec(j,i,n,g,h,k,m,true,true)})}else{f.commands.formatInline.exec(j,i,n,g,h,k,m)}}},state:function(k,j,q,h,i,l,p){var m=k.doc,g=d[q]||q,o,n;if(!f.dom.hasElementWithTagName(m,q)&&!f.dom.hasElementWithTagName(m,g)){return false}if(h&&!f.dom.hasElementWithClassName(m,h)){return false}o=k.selection.getOwnRanges();if(!o||o.length===0){return false}n=a(q,h,i,l,p,k.element).isAppliedToRange(o);return(n&&n.elements)?n.elements:false}}})(wysihtml5);(function(a){a.commands.insertBlockQuote={exec:function(d,b){var h=this.state(d,b),e=d.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]),g,f;d.selection.executeAndRestore(function(){if(h){if(d.config.useLineBreaks){a.dom.lineBreaks(h).add()}a.dom.unwrap(h)}else{if(d.selection.isCollapsed()){d.selection.selectLine()}if(e){var i=e.ownerDocument.createElement("blockquote");a.dom.insert(i).after(e);i.appendChild(e)}else{d.selection.surround({nodeName:"blockquote"})}}})},state:function(d,b){var f=d.selection.getSelectedNode(),e=a.dom.getParentElement(f,{nodeName:"BLOCKQUOTE"},false,d.element);return(e)?e:false}}})(wysihtml5);wysihtml5.commands.insertHTML={exec:function(b,a,d){if(b.commands.support(a)){b.doc.execCommand(a,false,d)}else{b.selection.insertHTML(d)}},state:function(){return false}};(function(b){var a="IMG";b.commands.insertImage={exec:function(e,d,l){l=typeof(l)==="object"?l:{src:l};var f=e.doc,h=this.state(e),k,j;if(h){e.selection.setBefore(h);j=h.parentNode;j.removeChild(h);b.dom.removeEmptyTextNodes(j);if(j.nodeName==="A"&&!j.firstChild){e.selection.setAfter(j);j.parentNode.removeChild(j)}b.quirks.redraw(e.element);return}h=f.createElement(a);for(var g in l){h.setAttribute(g==="className"?"class":g,l[g])}e.selection.insertNode(h);if(b.browser.hasProblemsSettingCaretAfterImg()){k=f.createTextNode(b.INVISIBLE_SPACE);e.selection.insertNode(k);e.selection.setAfter(k)}else{e.selection.setAfter(h)}},state:function(d){var e=d.doc,g,h,f;if(!b.dom.hasElementWithTagName(e,a)){return false}g=d.selection.getSelectedNode();if(!g){return false}if(g.nodeName===a){return g}if(g.nodeType!==b.ELEMENT_NODE){return false}h=d.selection.getText();h=b.lang.string(h).trim();if(h){return false}f=d.selection.getNodes(b.ELEMENT_NODE,function(i){return i.nodeName==="IMG"});if(f.length!==1){return false}return f[0]}}})(wysihtml5);(function(b){var a="<br>"+(b.browser.needsSpaceAfterLineBreak()?" ":"");b.commands.insertLineBreak={exec:function(e,d){if(e.commands.support(d)){e.doc.execCommand(d,false,null);if(!b.browser.autoScrollsToCaret()){e.selection.scrollIntoView()}}else{e.commands.exec("insertHTML",a)}},state:function(){return false}}})(wysihtml5);wysihtml5.commands.insertOrderedList={exec:function(b,a){wysihtml5.commands.insertList.exec(b,a,"OL")},state:function(b,a){return wysihtml5.commands.insertList.state(b,a,"OL")}};wysihtml5.commands.insertUnorderedList={exec:function(b,a){wysihtml5.commands.insertList.exec(b,a,"UL")},state:function(b,a){return wysihtml5.commands.insertList.state(b,a,"UL")}};wysihtml5.commands.insertList=(function(h){var g=function(k,j){if(k&&k.nodeName){if(typeof j==="string"){j=[j]}for(var i=j.length;i--;){if(k.nodeName===j[i]){return true}}}return false};var b=function(j,k,i){var n={el:null,other:false};if(j){var m=h.dom.getParentElement(j,{nodeName:"LI"}),l=(k==="UL")?"OL":"UL";if(g(j,k)){n.el=j}else{if(g(j,l)){n={el:j,other:true}}else{if(m){if(g(m.parentNode,k)){n.el=m.parentNode}else{if(g(m.parentNode,l)){n={el:m.parentNode,other:true}}}}}}}if(n.el&&!i.element.contains(n.el)){n.el=null}return n};var f=function(j,l,i){var n=(l==="UL")?"OL":"UL",m,k;i.selection.executeAndRestore(function(){var q=d(n,i);if(q.length){for(var p=q.length;p--;){h.dom.renameElement(q[p],l.toLowerCase())}}else{k=d(["OL","UL"],i);for(var o=k.length;o--;){h.dom.resolveList(k[o],i.config.useLineBreaks)}h.dom.resolveList(j,i.config.useLineBreaks)}})};var e=function(j,k,i){var l=(k==="UL")?"OL":"UL";i.selection.executeAndRestore(function(){var n=[j].concat(d(l,i));for(var m=n.length;m--;){h.dom.renameElement(n[m],k.toLowerCase())}})};var d=function(j,i){var l=i.selection.getOwnRanges(),m=[];for(var k=l.length;k--;){m=m.concat(l[k].getNodes([1],function(n){return g(n,j)}))}return m};var a=function(j,i){i.selection.executeAndRestoreRangy(function(){var n="_wysihtml5-temp-"+new Date().getTime(),o=i.selection.deblockAndSurround({nodeName:"div",className:n}),l,m;var k=/\uFEFF/g;o.innerHTML=o.innerHTML.replace(k,"");if(o){l=h.lang.array(["","<br>",h.INVISIBLE_SPACE]).contains(o.innerHTML);m=h.dom.convertToList(o,j.toLowerCase(),i.parent.config.uneditableContainerClassname);if(l){i.selection.selectNode(m.querySelector("li"),true)}}})};return{exec:function(k,j,n){var l=k.doc,i=(n==="OL")?"insertOrderedList":"insertUnorderedList",o=k.selection.getSelectedNode(),m=b(o,n,k);if(!m.el){if(k.commands.support(i)){l.execCommand(i,false,null)}else{a(n,k)}}else{if(m.other){e(m.el,n,k)}else{f(m.el,n,k)}}},state:function(j,i,l){var m=j.selection.getSelectedNode(),k=b(m,l,j);return(k.el&&!k.other)?k.el:false}}})(wysihtml5);wysihtml5.commands.italic={exec:function(b,a){wysihtml5.commands.formatInline.execWithToggle(b,a,"i")},state:function(b,a){return wysihtml5.commands.formatInline.state(b,a,"i")}};(function(d){var a="wysiwyg-text-align-center",b=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyCenter={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,a,b)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,a,b)}}})(wysihtml5);(function(d){var a="wysiwyg-text-align-left",b=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyLeft={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,a,b)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,a,b)}}})(wysihtml5);(function(d){var a="wysiwyg-text-align-right",b=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyRight={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,a,b)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,a,b)}}})(wysihtml5);(function(d){var a="wysiwyg-text-align-justify",b=/wysiwyg-text-align-[0-9a-z]+/g;d.commands.justifyFull={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,a,b)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,a,b)}}})(wysihtml5);(function(d){var b="text-align: right;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignRightStyle={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,null,null,b,a)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,null,null,b,a)}}})(wysihtml5);(function(d){var b="text-align: left;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignLeftStyle={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,null,null,b,a)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,null,null,b,a)}}})(wysihtml5);(function(d){var b="text-align: center;",a=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;d.commands.alignCenterStyle={exec:function(f,e){return d.commands.formatBlock.exec(f,"formatBlock",null,null,null,b,a)},state:function(f,e){return d.commands.formatBlock.state(f,"formatBlock",null,null,null,b,a)}}})(wysihtml5);wysihtml5.commands.redo={exec:function(a){return a.undoManager.redo()},state:function(a){return false}};wysihtml5.commands.underline={exec:function(b,a){wysihtml5.commands.formatInline.execWithToggle(b,a,"u")},state:function(b,a){return wysihtml5.commands.formatInline.state(b,a,"u")}};wysihtml5.commands.undo={exec:function(a){return a.undoManager.undo()},state:function(a){return false}};wysihtml5.commands.createTable={exec:function(d,b,g){var a,f,e;if(g&&g.cols&&g.rows&&parseInt(g.cols,10)>0&&parseInt(g.rows,10)>0){if(g.tableStyle){e='<table style="'+g.tableStyle+'">'}else{e="<table>"}e+="<tbody>";for(f=0;f<g.rows;f++){e+="<tr>";for(a=0;a<g.cols;a++){e+="<td>&nbsp;</td>"}e+="</tr>"}e+="</tbody></table>";d.commands.exec("insertHTML",e)}},state:function(b,a){return false}};wysihtml5.commands.mergeTableCells={exec:function(b,a){if(b.tableSelection&&b.tableSelection.start&&b.tableSelection.end){if(this.state(b,a)){wysihtml5.dom.table.unmergeCell(b.tableSelection.start)}else{wysihtml5.dom.table.mergeCellsBetween(b.tableSelection.start,b.tableSelection.end)}}},state:function(b,a){if(b.tableSelection){var e=b.tableSelection.start,d=b.tableSelection.end;if(e&&d&&e==d&&((wysihtml5.dom.getAttribute(e,"colspan")&&parseInt(wysihtml5.dom.getAttribute(e,"colspan"),10)>1)||(wysihtml5.dom.getAttribute(e,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(e,"rowspan"),10)>1))){return[e]}}return false}};wysihtml5.commands.addTableCells={exec:function(b,a,e){if(b.tableSelection&&b.tableSelection.start&&b.tableSelection.end){var d=wysihtml5.dom.table.orderSelectionEnds(b.tableSelection.start,b.tableSelection.end);if(e=="before"||e=="above"){wysihtml5.dom.table.addCells(d.start,e)}else{if(e=="after"||e=="below"){wysihtml5.dom.table.addCells(d.end,e)}}setTimeout(function(){b.tableSelection.select(d.start,d.end)},0)}},state:function(b,a){return false}};wysihtml5.commands.deleteTableCells={exec:function(b,a,h){if(b.tableSelection&&b.tableSelection.start&&b.tableSelection.end){var g=wysihtml5.dom.table.orderSelectionEnds(b.tableSelection.start,b.tableSelection.end),d=wysihtml5.dom.table.indexOf(g.start),e,f=b.tableSelection.table;wysihtml5.dom.table.removeCells(g.start,h);setTimeout(function(){e=wysihtml5.dom.table.findCell(f,d);if(!e){if(h=="row"){e=wysihtml5.dom.table.findCell(f,{row:d.row-1,col:d.col})}if(h=="column"){e=wysihtml5.dom.table.findCell(f,{row:d.row,col:d.col-1})}}if(e){b.tableSelection.select(e,e)}},0)}},state:function(b,a){return false}};wysihtml5.commands.indentList={exec:function(b,a,e){var d=b.selection.getSelectionParentsByTag("LI");if(d){return this.tryToPushLiLevel(d,b.selection)}return false},state:function(b,a){return false},tryToPushLiLevel:function(d,i){var f,e,g,b,h,a=false;i.executeAndRestoreRangy(function(){for(var j=d.length;j--;){b=d[j];f=(b.parentNode.nodeName==="OL")?"OL":"UL";e=b.ownerDocument.createElement(f);g=wysihtml5.dom.domNode(b).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]});h=(g)?g.querySelector("ul, ol"):null;if(g){if(h){h.appendChild(b)}else{e.appendChild(b);g.appendChild(e)}a=true}}});return a}};wysihtml5.commands.outdentList={exec:function(b,a,e){var d=b.selection.getSelectionParentsByTag("LI");if(d){return this.tryToPullLiLevel(d,b)}return false},state:function(b,a){return false},tryToPullLiLevel:function(f,b){var h,j,i,g,k,e,a,d=false,l=this;b.selection.executeAndRestoreRangy(function(){for(var m=f.length;m--;){e=f[m];if(e.parentNode){h=e.parentNode;if(h.tagName==="OL"||h.tagName==="UL"){d=true;j=wysihtml5.dom.getParentElement(h.parentNode,{nodeName:["OL","UL"]},false,b.element);i=wysihtml5.dom.getParentElement(h.parentNode,{nodeName:["LI"]},false,b.element);if(j&&i){if(e.nextSibling){a=l.getAfterList(h,e);e.appendChild(a)}j.insertBefore(e,i.nextSibling)}else{if(e.nextSibling){a=l.getAfterList(h,e);e.appendChild(a)}for(var n=e.childNodes.length;n--;){h.parentNode.insertBefore(e.childNodes[n],h.nextSibling)}h.parentNode.insertBefore(document.createElement("br"),h.nextSibling);e.parentNode.removeChild(e)}if(h.childNodes.length===0){h.parentNode.removeChild(h)}}}}});return d},getAfterList:function(b,a){var e=b.nodeName,d=document.createElement(e);while(a.nextSibling){d.appendChild(a.nextSibling)}return d}};(function(k){var m=90,l=89,a=8,f=46,h=25,d="data-wysihtml5-selection-node",e="data-wysihtml5-selection-offset",j='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+k.INVISIBLE_SPACE+"</span>",i='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+k.INVISIBLE_SPACE+"</span>",g=k.dom;function b(n){var o;while(o=n.querySelector("._wysihtml5-temp")){o.parentNode.removeChild(o)}}k.UndoManager=k.lang.Dispatcher.extend({constructor:function(n){this.editor=n;this.composer=n.composer;this.element=this.composer.element;this.position=0;this.historyStr=[];this.historyDom=[];this.transact();this._observe()},_observe:function(){var p=this,n=this.composer.sandbox.getDocument(),o;g.observe(this.element,"keydown",function(q){if(q.altKey||(!q.ctrlKey&&!q.metaKey)){return}var t=q.keyCode,s=t===m&&!q.shiftKey,r=(t===m&&q.shiftKey)||(t===l);if(s){p.undo();q.preventDefault()}else{if(r){p.redo();q.preventDefault()}}});g.observe(this.element,"keydown",function(q){var r=q.keyCode;if(r===o){return}o=r;if(r===a||r===f){p.transact()}});this.editor.on("newword:composer",function(){p.transact()}).on("beforecommand:composer",function(){p.transact()})},transact:function(){var v=this.historyStr[this.position-1],p=this.composer.getValue(false,false),o=this.element.offsetWidth>0&&this.element.offsetHeight>0,w,s,t,q,u;if(p===v){return}var r=this.historyStr.length=this.historyDom.length=this.position;if(r>h){this.historyStr.shift();this.historyDom.shift();this.position--}this.position++;if(o){w=this.composer.selection.getRange();s=(w&&w.startContainer)?w.startContainer:this.element;t=(w&&w.startOffset)?w.startOffset:0;if(s.nodeType===k.ELEMENT_NODE){q=s}else{q=s.parentNode;u=this.getChildNodeIndex(q,s)}q.setAttribute(e,t);if(typeof(u)!=="undefined"){q.setAttribute(d,u)}}var n=this.element.cloneNode(!!p);this.historyDom.push(n);this.historyStr.push(p);if(q){q.removeAttribute(e);q.removeAttribute(d)}},undo:function(){this.transact();if(!this.undoPossible()){return}this.set(this.historyDom[--this.position-1]);this.editor.fire("undo:composer")},redo:function(){if(!this.redoPossible()){return}this.set(this.historyDom[++this.position-1]);this.editor.fire("redo:composer")},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(o){this.element.innerHTML="";var p=0,n=o.childNodes,q=o.childNodes.length;for(;p<q;p++){this.element.appendChild(n[p].cloneNode(true))}var s,r,t;if(o.hasAttribute(e)){s=o.getAttribute(e);t=o.getAttribute(d);r=this.element}else{r=this.element.querySelector("["+e+"]")||this.element;s=r.getAttribute(e);t=r.getAttribute(d);r.removeAttribute(e);r.removeAttribute(d)}if(t!==null){r=this.getChildNodeByIndex(r,+t)}this.composer.selection.set(r,s)},getChildNodeIndex:function(r,n){var p=0,o=r.childNodes,q=o.length;for(;p<q;p++){if(o[p]===n){return p}}},getChildNodeByIndex:function(o,n){return o.childNodes[n]}})})(wysihtml5);wysihtml5.views.View=Base.extend({constructor:function(b,d,a){this.parent=b;this.element=d;this.config=a;if(!this.config.noTextarea){this._observeViewChange()}},_observeViewChange:function(){var a=this;this.parent.on("beforeload",function(){a.parent.on("change_view",function(b){if(b===a.name){a.parent.currentView=a;a.show();setTimeout(function(){a.focus()},0)}else{a.hide()}})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element){return}try{this.element.focus()}catch(a){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});(function(d){var b=d.dom,a=d.browser;d.views.Composer=d.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(g,f,e){this.base(g,f,e);if(!this.config.noTextarea){this.textarea=this.parent.textarea}else{this.editableArea=f}if(this.config.contentEditableMode){this._initContentEditableArea()}else{this._initSandbox()}},clear:function(){this.element.innerHTML=a.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(f,e){var g=this.isEmpty()?"":d.quirks.getCorrectInnerHTML(this.element);if(f!==false){g=this.parent.parse(g,(e===false)?false:true)}return g},setValue:function(g,h){if(h){g=this.parent.parse(g)}try{this.element.innerHTML=g}catch(f){this.element.innerText=g}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"";if(!this.config.noTextarea&&!this.textarea.element.disabled){this.disable();this.enable()}},hide:function(){this._displayStyle=b.getStyle("display").from(this.editableArea);if(this._displayStyle==="none"){this._displayStyle=null}this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer");this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer");this.element.setAttribute("contentEditable","true")},focus:function(f){if(d.browser.doesAsyncFocus()&&this.hasPlaceholderSet()){this.clear()}this.base();var e=this.element.lastChild;if(f&&e&&this.selection){if(e.nodeName==="BR"){this.selection.setBefore(this.element.lastChild)}else{this.selection.setAfter(this.element.lastChild)}}},getTextContent:function(){return b.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==((this.config.noTextarea)?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return(/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i).test(e)||e===""||e==="<br>"||e==="<p></p>"||e==="<p><br></p>"||this.hasPlaceholderSet()},_initContentEditableArea:function(){var e=this;if(this.config.noTextarea){this.sandbox=new b.ContentEditableArea(function(){e._create()},{},this.editableArea)}else{this.sandbox=new b.ContentEditableArea(function(){e._create()});this.editableArea=this.sandbox.getContentEditable();b.insert(this.editableArea).after(this.textarea.element);this._createWysiwygFormField()}},_initSandbox:function(){var f=this;this.sandbox=new b.Sandbox(function(){f._create()},{stylesheets:this.config.stylesheets});this.editableArea=this.sandbox.getIframe();var e=this.textarea.element;b.insert(this.editableArea).after(e);this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var e=document.createElement("input");e.type="hidden";e.name="_wysihtml5_mode";e.value=1;b.insert(e).after(this.textarea.element)}},_create:function(){var g=this;this.doc=this.sandbox.getDocument();this.element=(this.config.contentEditableMode)?this.sandbox.getContentEditable():this.doc.body;if(!this.config.noTextarea){this.textarea=this.parent.textarea;this.element.innerHTML=this.textarea.getValue(true,false)}else{this.cleanUp()}this.selection=new d.Selection(this.parent,this.element,this.config.uneditableContainerClassname);this.commands=new d.Commands(this.parent);if(!this.config.noTextarea){b.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element)}b.addClass(this.element,this.config.composerClassName);if(this.config.style&&!this.config.contentEditableMode){this.style()}this.observe();var e=this.config.name;if(e){b.addClass(this.element,e);if(!this.config.contentEditableMode){b.addClass(this.editableArea,e)}}this.enable();if(!this.config.noTextarea&&this.textarea.element.disabled){this.disable()}var f=typeof(this.config.placeholder)==="string"?this.config.placeholder:((this.config.noTextarea)?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"));if(f){b.simulatePlaceholder(this.parent,this,f)}this.commands.exec("styleWithCSS",false);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();this._initLineBreaking();if(!this.config.noTextarea&&(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&!a.isIos()){setTimeout(function(){g.focus(true)},100)}if(!a.clearsContentEditableCorrectly()){d.quirks.ensureProperClearing(this)}if(this.initSync&&this.config.sync){this.initSync()}if(!this.config.noTextarea){this.textarea.hide()}this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var i=this,h=a.canDisableAutoLinking(),g=a.doesAutoLinkingInContentEditable();if(h){this.commands.exec("autoUrlDetect",false)}if(!this.config.autoLink){return}if(!g||(g&&h)){this.parent.on("newword:composer",function(){if(b.getTextContent(i.element).match(b.autoLink.URL_REG_EXP)){i.selection.executeAndRestore(function(n,k){var o=i.element.querySelectorAll("."+i.config.uneditableContainerClassname),m=false;for(var l=o.length;l--;){if(d.dom.contains(o[l],k)){m=true}}if(!m){b.autoLink(k.parentNode,[i.config.uneditableContainerClassname])}})}});b.observe(this.element,"blur",function(){b.autoLink(i.element,[i.config.uneditableContainerClassname])})}var f=this.sandbox.getDocument().getElementsByTagName("a"),j=b.autoLink.URL_REG_EXP,e=function(k){var l=d.lang.string(b.getTextContent(k)).trim();if(l.substr(0,4)==="www."){l="http://"+l}return l};b.observe(this.element,"keydown",function(k){if(!f.length){return}var m=i.selection.getSelectedNode(k.target.ownerDocument),l=b.getParentElement(m,{nodeName:"A"},4),n;if(!l){return}n=e(l);setTimeout(function(){var o=e(l);if(o===n){return}if(o.match(j)){l.setAttribute("href",o)}},0)})},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",true);if(a.supportsEvent("resizeend")){var f=["width","height"],g=f.length,e=this.element;b.observe(e,"resizeend",function(h){var m=h.target||h.srcElement,l=m.style,j=0,k;if(m.nodeName!=="IMG"){return}for(;j<g;j++){k=f[j];if(l[k]){m.setAttribute(k,parseInt(l[k],10));l[k]=""}}d.quirks.redraw(e)})}},_initUndoManager:function(){this.undoManager=new d.UndoManager(this.parent)},_initLineBreaking:function(){var g=this,h=["LI","P","H1","H2","H3","H4","H5","H6"],f=["UL","OL","MENU"];function e(j){var i=b.getParentElement(j,{nodeName:["P","DIV"]},2);if(i&&b.contains(g.element,i)){g.selection.executeAndRestore(function(){if(g.config.useLineBreaks){b.replaceWithChildNodes(i)}else{if(i.nodeName!=="P"){b.renameElement(i,"p")}}})}}if(!this.config.useLineBreaks){b.observe(this.element,["focus","keydown"],function(){if(g.isEmpty()){var i=g.doc.createElement("P");g.element.innerHTML="";g.element.appendChild(i);if(!a.displaysCaretInEmptyContentEditableCorrectly()){i.innerHTML="<br>";g.selection.setBefore(i.firstChild)}else{g.selection.selectNode(i,true)}}})}b.observe(this.element,"keydown",function(j){var k=j.keyCode;if(j.shiftKey){return}if(k!==d.ENTER_KEY&&k!==d.BACKSPACE_KEY){return}var i=b.getParentElement(g.selection.getSelectedNode(),{nodeName:h},4);if(i){setTimeout(function(){var m=g.selection.getSelectedNode(),l;if(i.nodeName==="LI"){if(!m){return}l=b.getParentElement(m,{nodeName:f},2);if(!l){e(m)}}if(k===d.ENTER_KEY&&i.nodeName.match(/^H[1-6]$/)){e(m)}},0);return}if(g.config.useLineBreaks&&k===d.ENTER_KEY&&!d.browser.insertsLineBreaksOnReturn()){j.preventDefault();g.commands.exec("insertLineBreak")}})}})})(wysihtml5);(function(j){var e=j.dom,d=document,i=window,g=d.createElement("div"),h=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],b=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],a=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",j.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"];var f=function(l){if(l.setActive){try{l.setActive()}catch(k){}}else{var m=l.style,o=d.documentElement.scrollTop||d.body.scrollTop,n=d.documentElement.scrollLeft||d.body.scrollLeft,p={position:m.position,top:m.top,left:m.left,WebkitUserSelect:m.WebkitUserSelect};e.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(l);l.focus();e.setStyles(p).on(l);if(i.scrollTo){i.scrollTo(n,o)}}};j.views.Composer.prototype.style=function(){var s=this,n=d.querySelector(":focus"),r=this.textarea.element,m=r.hasAttribute("placeholder"),q=m&&r.getAttribute("placeholder"),p=r.style.display,o=r.disabled,l;this.focusStylesHost=g.cloneNode(false);this.blurStylesHost=g.cloneNode(false);this.disabledStylesHost=g.cloneNode(false);if(m){r.removeAttribute("placeholder")}if(r===n){r.blur()}r.disabled=false;r.style.display=l="none";if((r.getAttribute("rows")&&e.getStyle("height").from(r)==="auto")||(r.getAttribute("cols")&&e.getStyle("width").from(r)==="auto")){r.style.display=l=p}e.copyStyles(b).from(r).to(this.editableArea).andTo(this.blurStylesHost);e.copyStyles(h).from(r).to(this.element).andTo(this.blurStylesHost);e.insertCSS(a).into(this.element.ownerDocument);r.disabled=true;e.copyStyles(b).from(r).to(this.disabledStylesHost);e.copyStyles(h).from(r).to(this.disabledStylesHost);r.disabled=o;r.style.display=p;f(r);r.style.display=l;e.copyStyles(b).from(r).to(this.focusStylesHost);e.copyStyles(h).from(r).to(this.focusStylesHost);r.style.display=p;e.copyStyles(["display"]).from(r).to(this.editableArea);var k=j.lang.array(b).without(["display"]);if(n){n.focus()}else{r.blur()}if(m){r.setAttribute("placeholder",q)}this.parent.on("focus:composer",function(){e.copyStyles(k).from(s.focusStylesHost).to(s.editableArea);e.copyStyles(h).from(s.focusStylesHost).to(s.element)});this.parent.on("blur:composer",function(){e.copyStyles(k).from(s.blurStylesHost).to(s.editableArea);e.copyStyles(h).from(s.blurStylesHost).to(s.element)});this.parent.observe("disable:composer",function(){e.copyStyles(k).from(s.disabledStylesHost).to(s.editableArea);e.copyStyles(h).from(s.disabledStylesHost).to(s.element)});this.parent.observe("enable:composer",function(){e.copyStyles(k).from(s.blurStylesHost).to(s.editableArea);e.copyStyles(h).from(s.blurStylesHost).to(s.element)});return this}})(wysihtml5);(function(h){var d=h.dom,a=h.browser,g={"66":"bold","73":"italic","85":"underline"};var b=function(m,n,j){var l=m.getPreviousNode(n,true),i=m.getSelectedNode();if(i.nodeType!==1&&i.parentNode!==j){i=i.parentNode}if(l){if(i.nodeType==1){var k=i.firstChild;if(l.nodeType==1){while(i.firstChild){l.appendChild(i.firstChild)}}else{while(i.firstChild){n.parentNode.insertBefore(i.firstChild,n)}}if(i.parentNode){i.parentNode.removeChild(i)}m.setBefore(k)}else{if(l.nodeType==1){l.appendChild(i)}else{n.parentNode.insertBefore(i,n)}m.setBefore(i)}}};var e=function(l,o,k,j){if(o.isCollapsed()){if(o.caretIsInTheBeginnig("LI")){l.preventDefault();j.commands.exec("outdentList")}else{if(o.caretIsInTheBeginnig()){l.preventDefault()}else{if(o.caretIsFirstInSelection()&&o.getPreviousNode()&&o.getPreviousNode().nodeName&&(/^H\d$/gi).test(o.getPreviousNode().nodeName)){var m=o.getPreviousNode();l.preventDefault();if((/^\s*$/).test(m.textContent||m.innerText)){m.parentNode.removeChild(m)}else{var n=m.ownerDocument.createRange();n.selectNodeContents(m);n.collapse(false);o.setSelection(n)}}var i=o.caretIsBeforeUneditable();if(i){l.preventDefault();b(o,i,k)}}}}else{if(o.containsUneditable()){l.preventDefault();o.deleteContents()}}};var f=function(i,j){if(!i.selection.isCollapsed()){i.selection.deleteContents()}else{if(i.selection.caretIsInTheBeginnig("LI")){if(i.commands.exec("indentList")){return}}}i.commands.exec("insertHTML","&emsp;")};h.views.Composer.prototype.observe=function(){var p=this,o=this.getValue(false,false),i=(this.sandbox.getIframe)?this.sandbox.getIframe():this.sandbox.getContentEditable(),k=this.element,l=(a.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable)?k:this.sandbox.getWindow(),n=["drop","paste","beforepaste"],m=["drop","paste","mouseup","focus","keyup"];d.observe(i,"DOMNodeRemoved",function(){clearInterval(j);p.parent.fire("destroy:composer")});if(!a.supportsMutationEvents()){var j=setInterval(function(){if(!d.contains(document.documentElement,i)){clearInterval(j);p.parent.fire("destroy:composer")}},250)}d.observe(l,m,function(){setTimeout(function(){p.parent.fire("interaction").fire("interaction:composer")},0)});if(this.config.handleTables){if(!this.tableClickHandle&&this.doc.execCommand&&h.browser.supportsCommand(this.doc,"enableObjectResizing")&&h.browser.supportsCommand(this.doc,"enableInlineTableEditing")){if(this.sandbox.getIframe){this.tableClickHandle=d.observe(i,["focus","mouseup","mouseover"],function(){p.doc.execCommand("enableObjectResizing",false,"false");p.doc.execCommand("enableInlineTableEditing",false,"false");p.tableClickHandle.stop()})}else{setTimeout(function(){p.doc.execCommand("enableObjectResizing",false,"false");p.doc.execCommand("enableInlineTableEditing",false,"false")},0)}}this.tableSelection=h.quirks.tableCellsSelection(k,p.parent)}d.observe(l,"focus",function(r){p.parent.fire("focus",r).fire("focus:composer",r);setTimeout(function(){o=p.getValue(false,false)},0)});d.observe(l,"blur",function(s){if(o!==p.getValue(false,false)){var r=s;if(typeof Object.create=="function"){r=Object.create(s,{type:{value:"change"}})}p.parent.fire("change",r).fire("change:composer",r)}p.parent.fire("blur",s).fire("blur:composer",s)});d.observe(k,"dragenter",function(){p.parent.fire("unset_placeholder")});d.observe(k,n,function(r){p.parent.fire(r.type,r).fire(r.type+":composer",r)});if(this.config.copyedFromMarking){d.observe(k,"copy",function(r){if(r.clipboardData){r.clipboardData.setData("text/html",p.config.copyedFromMarking+p.selection.getHtml());r.preventDefault()}p.parent.fire(r.type,r).fire(r.type+":composer",r)})}d.observe(k,"keyup",function(r){var s=r.keyCode;if(s===h.SPACE_KEY||s===h.ENTER_KEY){p.parent.fire("newword:composer")}});this.parent.on("paste:composer",function(){setTimeout(function(){p.parent.fire("newword:composer")},0)});if(!a.canSelectImagesInContentEditable()){d.observe(k,"mousedown",function(s){var v=s.target;var r=k.querySelectorAll("img"),u=k.querySelectorAll("."+p.config.uneditableContainerClassname+" img"),t=h.lang.array(r).without(u);if(v.nodeName==="IMG"&&h.lang.array(t).contains(v)){p.selection.selectNode(v)}})}if(!a.canSelectImagesInContentEditable()){d.observe(k,"drop",function(r){setTimeout(function(){p.selection.getSelection().removeAllRanges()},0)})}if(a.hasHistoryIssue()&&a.supportsSelectionModify()){d.observe(k,"keydown",function(r){if(!r.metaKey&&!r.ctrlKey){return}var s=r.keyCode,u=k.ownerDocument.defaultView,t=u.getSelection();if(s===37||s===39){if(s===37){t.modify("extend","left","lineboundary");if(!r.shiftKey){t.collapseToStart()}}if(s===39){t.modify("extend","right","lineboundary");if(!r.shiftKey){t.collapseToEnd()}}r.preventDefault()}})}d.observe(k,"keydown",function(s){var t=s.keyCode,r=g[t];if((s.ctrlKey||s.metaKey)&&!s.altKey&&r){p.commands.exec(r);s.preventDefault()}if(t===8){e(s,p.selection,k,p)}else{if(p.config.handleTabKey&&t===9){s.preventDefault();f(p,k)}}});d.observe(k,"keydown",function(r){var u=p.selection.getSelectedNode(true),s=r.keyCode,t;if(u&&u.nodeName==="IMG"&&(s===h.BACKSPACE_KEY||s===h.DELETE_KEY)){t=u.parentNode;t.removeChild(u);if(t.nodeName==="A"&&!t.firstChild){t.parentNode.removeChild(t)}setTimeout(function(){h.quirks.redraw(k)},0);r.preventDefault()}});if(!this.config.contentEditableMode&&a.hasIframeFocusIssue()){d.observe(i,"focus",function(){setTimeout(function(){if(p.doc.querySelector(":focus")!==p.element){p.focus()}},0)});d.observe(this.element,"blur",function(){setTimeout(function(){p.selection.getSelection().removeAllRanges()},0)})}var q={IMG:"Image: ",A:"Link: "};d.observe(k,"mouseover",function(r){var u=r.target,t=u.nodeName,v;if(t!=="A"&&t!=="IMG"){return}var s=u.hasAttribute("title");if(!s){v=q[t]+(u.getAttribute("href")||u.getAttribute("src"));u.setAttribute("title",v)}})}})(wysihtml5);(function(b){var a=400;b.views.Synchronizer=Base.extend({constructor:function(e,f,d){this.editor=e;this.textarea=f;this.composer=d;this._observe()},fromComposerToTextarea:function(d){this.textarea.setValue(b.lang.string(this.composer.getValue(false,false)).trim(),d)},fromTextareaToComposer:function(d){var e=this.textarea.getValue(false,false);if(e){this.composer.setValue(e,d)}else{this.composer.clear();this.editor.fire("set_placeholder")}},sync:function(d){if(this.editor.currentView.name==="textarea"){this.fromTextareaToComposer(d)}else{this.fromComposerToTextarea(d)}},_observe:function(){var e,h=this,d=this.textarea.element.form,f=function(){e=setInterval(function(){h.fromComposerToTextarea()},a)},g=function(){clearInterval(e);e=null};f();if(d){b.dom.observe(d,"submit",function(){h.sync(true)});b.dom.observe(d,"reset",function(){setTimeout(function(){h.fromTextareaToComposer()},0)})}this.editor.on("change_view",function(i){if(i==="composer"&&!e){h.fromTextareaToComposer(true);f()}else{if(i==="textarea"){h.fromComposerToTextarea(true);g()}}});this.editor.on("destroy:composer",g)}})})(wysihtml5);wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(b,d,a){this.base(b,d,a);this._observe()},clear:function(){this.element.value=""},getValue:function(a){var b=this.isEmpty()?"":this.element.value;if(a!==false){b=this.parent.parse(b)}return b},setValue:function(a,b){if(b){a=this.parent.parse(a)}this.element.value=a},cleanUp:function(){var a=this.parent.parse(this.element.value);this.element.value=a},hasPlaceholderSet:function(){var d=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),b=this.element.getAttribute("placeholder")||null,e=this.element.value,a=!e;return(d&&a)||(e===b)},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var a=this.element,e=this.parent,b={focusin:"focus",focusout:"blur"},d=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.on("beforeload",function(){wysihtml5.dom.observe(a,d,function(f){var g=b[f.type]||f.type;e.fire(g).fire(g+":textarea")});wysihtml5.dom.observe(a,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}});(function(d){var b;var a={name:b,style:true,toolbar:b,showToolbarAfterInit:true,autoLink:true,handleTables:true,handleTabKey:true,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:d.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:true,stylesheets:[],placeholderText:b,supportTouchDevices:true,cleanUp:true,contentEditableMode:false,uneditableContainerClassname:"wysihtml5-uneditable-container",copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};d.Editor=d.lang.Dispatcher.extend({constructor:function(f,e){this.editableElement=typeof(f)==="string"?document.getElementById(f):f;this.config=d.lang.object({}).merge(a).merge(e).get();this._isCompatible=d.browser.supported();if(this.editableElement.nodeName.toLowerCase()!="textarea"){this.config.contentEditableMode=true;this.config.noTextarea=true}if(!this.config.noTextarea){this.textarea=new d.views.Textarea(this,this.editableElement,this.config);this.currentView=this.textarea}if(!this._isCompatible||(!this.config.supportTouchDevices&&d.browser.isTouchDevice())){var g=this;setTimeout(function(){g.fire("beforeload").fire("load")},0);return}d.dom.addClass(document.body,this.config.bodyClassName);this.composer=new d.views.Composer(this,this.editableElement,this.config);this.currentView=this.composer;if(typeof(this.config.parser)==="function"){this._initParser()}this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){if(!this.config.noTextarea){this.synchronizer=new d.views.Synchronizer(this,this.textarea,this.composer)}if(this.config.toolbar){this.toolbar=new d.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit)}},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(f,e){return this.currentView.getValue(f,e)},setValue:function(e,f){this.fire("unset_placeholder");if(!e){return this.clear()}this.currentView.setValue(e,f);return this},cleanUp:function(){this.currentView.cleanUp()},focus:function(e){this.currentView.focus(e);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(f,e){var g=(this.config.contentEditableMode)?document:((this.composer)?this.composer.sandbox.getDocument():null);var h=this.config.parser(f,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:g,uneditableClass:this.config.uneditableContainerClassname,clearInternals:e});if(typeof(f)==="object"){d.quirks.redraw(f)}return h},_initParser:function(){var g=this,f,e;if(d.browser.supportsModenPaste()){this.on("paste:composer",function(h){h.preventDefault();f=d.dom.getPastedHtml(h);if(f){g._cleanAndPaste(f)}})}else{this.on("beforepaste:composer",function(h){h.preventDefault();d.dom.getPastedHtmlWithDiv(g.composer,function(i){if(i){g._cleanAndPaste(i)}})})}},_cleanAndPaste:function(f){var e=d.quirks.cleanPastedHTML(f,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.uneditableContainerClassname});this.composer.selection.deleteContents();this.composer.selection.insertHTML(e)}})})(wysihtml5);(function(g){var d=g.dom,b="wysihtml5-command-dialog-opened",f="input, select, textarea",e="[data-wysihtml5-dialog-field]",a="data-wysihtml5-dialog-field";g.toolbar.Dialog=g.lang.Dispatcher.extend({constructor:function(i,h){this.link=i;this.container=h},_observe:function(){if(this._observed){return}var n=this,j=function(o){var i=n._serialize();if(i==n.elementToChange){n.fire("edit",i)}else{n.fire("save",i)}n.hide();o.preventDefault();o.stopPropagation()};d.observe(n.link,"click",function(){if(d.hasClass(n.link,b)){setTimeout(function(){n.hide()},0)}});d.observe(this.container,"keydown",function(i){var o=i.keyCode;if(o===g.ENTER_KEY){j(i)}if(o===g.ESCAPE_KEY){n.fire("cancel");n.hide()}});d.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",j);d.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(i){n.fire("cancel");n.hide();i.preventDefault();i.stopPropagation()});var k=this.container.querySelectorAll(f),l=0,m=k.length,h=function(){clearInterval(n.interval)};for(;l<m;l++){d.observe(k[l],"change",h)}this._observed=true},_serialize:function(){var h=this.elementToChange||{},j=this.container.querySelectorAll(e),l=j.length,k=0;for(;k<l;k++){h[j[k].getAttribute(a)]=j[k].value}return h},_interpolate:function(h){var j,k,p,m=document.querySelector(":focus"),l=this.container.querySelectorAll(e),o=l.length,n=0;for(;n<o;n++){j=l[n];if(j===m){continue}if(h&&j.type==="hidden"){continue}k=j.getAttribute(a);p=(this.elementToChange&&typeof(this.elementToChange)!=="boolean")?(this.elementToChange.getAttribute(k)||""):j.defaultValue;j.value=p}},show:function(i){if(d.hasClass(this.link,b)){return}var k=this,j=this.container.querySelector(f);this.elementToChange=i;this._observe();this._interpolate();if(i){this.interval=setInterval(function(){k._interpolate(true)},500)}d.addClass(this.link,b);this.container.style.display="";this.fire("show");if(j&&!i){try{j.focus()}catch(h){}}},hide:function(){clearInterval(this.interval);this.elementToChange=null;d.removeClass(this.link,b);this.container.style.display="none";this.fire("hide")}})})(wysihtml5);(function(g){var a=g.dom;var e={position:"relative"};var f={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1};var d={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"};var b={"x-webkit-speech":"",speech:""};g.toolbar.Speech=function(l,k){var i=document.createElement("input");if(!g.browser.supportsSpeechApiOn(i)){k.style.display="none";return}var j=l.editor.textarea.element.getAttribute("lang");if(j){b.lang=j}var m=document.createElement("div");g.lang.object(f).merge({width:k.offsetWidth+"px",height:k.offsetHeight+"px"});a.insert(i).into(m);a.insert(m).into(k);a.setStyles(d).on(i);a.setAttributes(b).on(i);a.setStyles(f).on(m);a.setStyles(e).on(k);var h="onwebkitspeechchange" in i?"webkitspeechchange":"speechchange";a.observe(i,h,function(){l.execCommand("insertText",i.value);i.value=""});a.observe(i,"click",function(n){if(a.hasClass(k,"wysihtml5-command-disabled")){n.preventDefault()}n.stopPropagation()})}})(wysihtml5);(function(g){var d="wysihtml5-command-disabled",e="wysihtml5-commands-disabled",b="wysihtml5-command-active",a="wysihtml5-action-active",f=g.dom;g.toolbar.Toolbar=Base.extend({constructor:function(j,h,m){this.editor=j;this.container=typeof(h)==="string"?document.getElementById(h):h;this.composer=j.composer;this._getLinks("command");this._getLinks("action");this._observe();if(m){this.show()}if(j.config.classNameCommandDisabled!=null){d=j.config.classNameCommandDisabled}if(j.config.classNameCommandsDisabled!=null){e=j.config.classNameCommandsDisabled}if(j.config.classNameCommandActive!=null){b=j.config.classNameCommandActive}if(j.config.classNameActionActive!=null){a=j.config.classNameActionActive}var n=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),l=n.length,k=0;for(;k<l;k++){new g.toolbar.Speech(this,n[k])}},_getLinks:function(q){var n=this[q+"Links"]=g.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+q+"]")).get(),l=n.length,k=0,o=this[q+"Mapping"]={},m,j,p,r,h;for(;k<l;k++){m=n[k];p=m.getAttribute("data-wysihtml5-"+q);r=m.getAttribute("data-wysihtml5-"+q+"-value");j=this.container.querySelector("[data-wysihtml5-"+q+"-group='"+p+"']");h=this._getDialog(m,p);o[p+":"+r]={link:m,group:j,name:p,value:r,dialog:h,state:false}}},_getDialog:function(l,i){var m=this,k=this.container.querySelector("[data-wysihtml5-dialog='"+i+"']"),j,h;if(k){if(g.toolbar["Dialog_"+i]){j=new g.toolbar["Dialog_"+i](l,k)}else{j=new g.toolbar.Dialog(l,k)}j.on("show",function(){h=m.composer.selection.getBookmark();m.editor.fire("show:dialog",{command:i,dialogContainer:k,commandLink:l})});j.on("save",function(n){if(h){m.composer.selection.setBookmark(h)}m._execCommand(i,n);m.editor.fire("save:dialog",{command:i,dialogContainer:k,commandLink:l})});j.on("cancel",function(){m.editor.focus(false);m.editor.fire("cancel:dialog",{command:i,dialogContainer:k,commandLink:l})})}return j},execCommand:function(h,j){if(this.commandsDisabled){return}var i=this.commandMapping[h+":"+j];if(i&&i.dialog&&!i.state){i.dialog.show()}else{this._execCommand(h,j)}},_execCommand:function(h,i){this.editor.focus(false);this.composer.commands.exec(h,i);this._updateLinkStates()},execAction:function(h){var i=this.editor;if(h==="change_view"){if(i.textarea){if(i.currentView===i.textarea){i.fire("change_view","composer")}else{i.fire("change_view","textarea")}}}if(h=="showSource"){i.fire("showSource")}},_observe:function(){var n=this,j=this.editor,h=this.container,m=this.commandLinks.concat(this.actionLinks),l=m.length,k=0;for(;k<l;k++){if(m[k].nodeName==="A"){f.setAttributes({href:"javascript:;",unselectable:"on"}).on(m[k])}else{f.setAttributes({unselectable:"on"}).on(m[k])}}f.delegate(h,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(i){i.preventDefault()});f.delegate(h,"[data-wysihtml5-command]","click",function(p){var q=this,i=q.getAttribute("data-wysihtml5-command"),o=q.getAttribute("data-wysihtml5-command-value");n.execCommand(i,o);p.preventDefault()});f.delegate(h,"[data-wysihtml5-action]","click",function(o){var i=this.getAttribute("data-wysihtml5-action");n.execAction(i);o.preventDefault()});j.on("interaction:composer",function(){n._updateLinkStates()});j.on("focus:composer",function(){n.bookmark=null});if(this.editor.config.handleTables){j.on("tableselect:composer",function(){n.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""});j.on("tableunselect:composer",function(){n.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})}j.on("change_view",function(i){if(j.textarea){setTimeout(function(){n.commandsDisabled=(i!=="composer");n._updateLinkStates();if(n.commandsDisabled){f.addClass(h,e)}else{f.removeClass(h,e)}},0)}})},_updateLinkStates:function(){var l=this.commandMapping,j=this.actionMapping,m,n,h,k;for(m in l){k=l[m];if(this.commandsDisabled){n=false;f.removeClass(k.link,b);if(k.group){f.removeClass(k.group,b)}if(k.dialog){k.dialog.hide()}}else{n=this.composer.commands.state(k.name,k.value);f.removeClass(k.link,d);if(k.group){f.removeClass(k.group,d)}}if(k.state===n){continue}k.state=n;if(n){f.addClass(k.link,b);if(k.group){f.addClass(k.group,b)}if(k.dialog){if(typeof(n)==="object"||g.lang.object(n).isArray()){if(!k.dialog.multiselect&&g.lang.object(n).isArray()){n=n.length===1?n[0]:true;k.state=n}k.dialog.show(n)}else{k.dialog.hide()}}}else{f.removeClass(k.link,b);if(k.group){f.removeClass(k.group,b)}if(k.dialog){k.dialog.hide()}}}for(m in j){h=j[m];if(h.name==="change_view"){h.state=this.editor.currentView===this.editor.textarea;if(h.state){f.addClass(h.link,a)}else{f.removeClass(h.link,a)}}}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})})(wysihtml5);(function(a){a.toolbar.Dialog_createTable=a.toolbar.Dialog.extend({show:function(b){this.base(b)}})})(wysihtml5);(function(e){var b=e.dom,d="[data-wysihtml5-dialog-field]",a="data-wysihtml5-dialog-field";e.toolbar.Dialog_foreColorStyle=e.toolbar.Dialog.extend({multiselect:true,_serialize:function(){var f={},g=this.container.querySelectorAll(d),j=g.length,h=0;for(;h<j;h++){f[g[h].getAttribute(a)]=g[h].value}return f},_interpolate:function(f){var j,k,q,n=document.querySelector(":focus"),l=this.container.querySelectorAll(d),p=l.length,o=0,m=(this.elementToChange)?((e.lang.object(this.elementToChange).isArray())?this.elementToChange[0]:this.elementToChange):null,h=(m)?m.getAttribute("style"):null,g=(h)?e.quirks.styleParser.parseColor(h,"color"):null;for(;o<p;o++){j=l[o];if(j===n){continue}if(f&&j.type==="hidden"){continue}if(j.getAttribute(a)==="color"){if(g){if(g[3]&&g[3]!=1){j.value="rgba("+g[0]+","+g[1]+","+g[2]+","+g[3]+");"}else{j.value="rgb("+g[0]+","+g[1]+","+g[2]+");"}}else{j.value="rgb(0,0,0);"}}}}})})(wysihtml5);(function(e){var b=e.dom,d="[data-wysihtml5-dialog-field]",a="data-wysihtml5-dialog-field";e.toolbar.Dialog_fontSizeStyle=e.toolbar.Dialog.extend({multiselect:true,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(f){var i=document.querySelector(":focus"),g=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),h=(this.elementToChange)?((e.lang.object(this.elementToChange).isArray())?this.elementToChange[0]:this.elementToChange):null,k=(h)?h.getAttribute("style"):null,j=(k)?e.quirks.styleParser.parseFontSize(k):null;if(g&&g!==i&&j&&!(/^\s*$/).test(j)){g.value=j}}})})(wysihtml5);
/*

 handlebars v1.3.0

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
var Handlebars=function(){var g=function(){function d(b){this.string=b}var e;return d.prototype.toString=function(){return""+this.string},e=d}(),h=function(n){function o(b){return u[b]||"&amp;"}function p(d,e){for(var f in e){Object.prototype.hasOwnProperty.call(e,f)&&(d[f]=e[f])}}function q(b){return b instanceof t?b.toString():b||0===b?(b=""+b,w.test(b)?b.replace(v,o):b):""}function r(b){return b||0===b?z(b)&&0===b.length?!0:!1:!0}var s={},t=n,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},v=/[&<>"'`]/g,w=/[&<>"'`]/;s.extend=p;var x=Object.prototype.toString;s.toString=x;var y=function(b){return"function"==typeof b};y(/x/)&&(y=function(b){return"function"==typeof b&&"[object Function]"===x.call(b)});var y;s.isFunction=y;var z=Array.isArray||function(b){return b&&"object"==typeof b?"[object Array]"===x.call(b):!1};return s.isArray=z,s.escapeExpression=q,s.isEmpty=r,s}(g),i=function(){function d(m,n){var o;n&&n.firstLine&&(o=n.firstLine,m+=" - "+o+":"+n.firstColumn);for(var p=Error.prototype.constructor.call(this,m),q=0;q<f.length;q++){this[f[q]]=p[f[q]]}o&&(this.lineNumber=o,this.column=n.firstColumn)}var e,f=["description","fileName","lineNumber","message","name","number","stack"];return d.prototype=new Error,e=d}(),j=function(r,s){function t(d,e){this.helpers=d||{},this.partials=e||{},u(this)}function u(b){b.registerHelper("helperMissing",function(d){if(2===arguments.length){return void 0}throw new y("Missing helper: '"+d+"'")}),b.registerHelper("blockHelperMissing",function(a,f){var m=f.inverse||function(){},n=f.fn;return D(a)&&(a=a.call(this)),a===!0?n(this):a===!1||null==a?m(this):C(a)?a.length>0?b.helpers.each(a,f):m(this):n(a)}),b.registerHelper("each",function(m,n){var o,p=n.fn,q=n.inverse,I=0,J="";if(D(m)&&(m=m.call(this)),n.data&&(o=H(n.data)),m&&"object"==typeof m){if(C(m)){for(var K=m.length;K>I;I++){o&&(o.index=I,o.first=0===I,o.last=I===m.length-1),J+=p(m[I],{data:o})}}else{for(var L in m){m.hasOwnProperty(L)&&(o&&(o.key=L,o.index=I,o.first=0===I),J+=p(m[L],{data:o}),I++)}}}return 0===I&&(J=q(this)),J}),b.registerHelper("if",function(d,e){return D(d)&&(d=d.call(this)),!e.hash.includeZero&&!d||x.isEmpty(d)?e.inverse(this):e.fn(this)}),b.registerHelper("unless",function(a,d){return b.helpers["if"].call(this,a,{fn:d.inverse,inverse:d.fn,hash:d.hash})}),b.registerHelper("with",function(d,e){return D(d)&&(d=d.call(this)),x.isEmpty(d)?void 0:e.fn(d)}),b.registerHelper("log",function(a,e){var f=e.data&&null!=e.data.level?parseInt(e.data.level,10):1;b.log(f,a)})}function v(d,e){G.log(d,e)}var w={},x=r,y=s,z="1.3.0";w.VERSION=z;var A=4;w.COMPILER_REVISION=A;var B={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};w.REVISION_CHANGES=B;var C=x.isArray,D=x.isFunction,E=x.toString,F="[object Object]";w.HandlebarsEnvironment=t,t.prototype={constructor:t,logger:G,log:v,registerHelper:function(d,e,f){if(E.call(d)===F){if(f||e){throw new y("Arg not supported with multiple helpers")}x.extend(this.helpers,d)}else{f&&(e.not=f),this.helpers[d]=e}},registerPartial:function(d,e){E.call(d)===F?x.extend(this.partials,d):this.partials[d]=e}};var G={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(d,e){if(G.level<=d){var f=G.methodMap[d];"undefined"!=typeof console&&console[f]&&console[f].call(console,e)}}};w.logger=G,w.log=v;var H=function(d){var e={};return x.extend(e,d),e};return w.createFrame=H,w}(h,i),k=function(o,p,q){function r(f){var m=f&&f[0]||1,n=A;if(m!==n){if(n>m){var C=B[n],D=B[m];throw new z("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+C+") or downgrade your runtime to an older version ("+D+").")}throw new z("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+f[1]+").")}}function s(e,f){if(!f){throw new z("No environment passed to template")}var m=function(b,C,D,E,F,G){var H=f.VM.invokePartial.apply(this,arguments);if(null!=H){return H}if(f.compile){var I={helpers:E,partials:F,data:G};return F[C]=f.compile(b,{data:void 0!==G},f),F[C](D,I)}throw new z("The partial "+C+" could not be compiled when running in runtime-only mode")},n={escapeExpression:y.escapeExpression,invokePartial:m,programs:[],program:function(C,D,E){var F=this.programs[C];return E?F=u(C,D,E):F||(F=this.programs[C]=u(C,D)),F},merge:function(d,C){var D=d||C;return d&&C&&d!==C&&(D={},y.extend(D,C),y.extend(D,d)),D},programWithDepth:f.VM.programWithDepth,noop:f.VM.noop,compilerInfo:null};return function(a,b){b=b||{};var d,C,D=b.partial?b:f;b.partial||(d=b.helpers,C=b.partials);var E=e.call(n,D,a,d,C,b.data);return b.partial||f.VM.checkRevision(n.compilerInfo),E}}function t(f,m,n){var C=Array.prototype.slice.call(arguments,3),D=function(b,d){return d=d||{},m.apply(this,[b,d.data||n].concat(C))};return D.program=f,D.depth=C.length,D}function u(e,f,m){var n=function(b,C){return C=C||{},f(b,C.data||m)};return n.program=e,n.depth=0,n}function v(m,n,C,D,E,F){var G={partial:!0,helpers:D,partials:E,data:F};if(void 0===m){throw new z("The partial "+n+" could not be found")}return m instanceof Function?m(C,G):void 0}function w(){return""}var x={},y=o,z=p,A=q.COMPILER_REVISION,B=q.REVISION_CHANGES;return x.checkRevision=r,x.template=s,x.programWithDepth=t,x.program=u,x.invokePartial=v,x.noop=w,x}(h,i,j),l=function(n,o,p,q,r){var s,t=n,u=o,v=p,w=q,x=r,y=function(){var b=new t.HandlebarsEnvironment;return w.extend(b,t),b.SafeString=u,b.Exception=v,b.Utils=w,b.VM=x,b.template=function(a){return x.template(a,b)},b},z=y();return z.create=y,s=z}(j,g,i,h,k);return l}();this["wysihtml5"]=this["wysihtml5"]||{};this["wysihtml5"]["tpl"]=this["wysihtml5"]["tpl"]||{};this["wysihtml5"]["tpl"]["blockquote"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",n,f="function",e=this.escapeExpression,m=this;function j(q,p){var o="",r;o+="btn-"+e(((r=((r=((r=(q&&q.options)),r==null||r===false?r:r.toolbar)),r==null||r===false?r:r.size)),typeof r===f?r.apply(q):r));return o}function k(p,o){return' \n      <span class="fa fa-quote-left"></span>\n    '}function l(p,o){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '}a+='<li>\n  <a class="btn ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.size),{hash:{},inverse:m.noop,fn:m.program(1,j,b),data:b});if(n||n===0){a+=n}a+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.fa),{hash:{},inverse:m.program(5,l,b),fn:m.program(3,k,b),data:b});if(n||n===0){a+=n}a+="\n  </a>\n</li>\n";return a});this["wysihtml5"]["tpl"]["color"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",l,f="function",e=this.escapeExpression,k=this;function j(o,n){var m="",p;m+="btn-"+e(((p=((p=((p=(o&&o.options)),p==null||p===false?p:p.toolbar)),p==null||p===false?p:p.size)),typeof p===f?p.apply(o):p));return m}a+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';l=h["if"].call(d,((l=((l=(d&&d.options)),l==null||l===false?l:l.toolbar)),l==null||l===false?l:l.size),{hash:{},inverse:k.noop,fn:k.program(1,j,b),data:b});if(l||l===0){a+=l}a+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.black)),typeof l===f?l.apply(d):l))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.black)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.silver)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.gray)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.maroon)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.red)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.purple)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.green)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.olive)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.navy)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.blue)),typeof l===f?l.apply(d):l))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+e(((l=((l=((l=(d&&d.locale)),l==null||l===false?l:l.colours)),l==null||l===false?l:l.orange)),typeof l===f?l.apply(d):l))+"</a></li>\n  </ul>\n</li>\n";return a});this["wysihtml5"]["tpl"]["emphasis"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",m,f="function",e=this.escapeExpression,l=this;function j(p,o){var n="",q;n+="btn-"+e(((q=((q=((q=(p&&p.options)),q==null||q===false?q:q.toolbar)),q==null||q===false?q:q.size)),typeof q===f?q.apply(p):q));return n}function k(p,o){var n="",q;n+='\n    <a class="btn ';q=h["if"].call(p,((q=((q=(p&&p.options)),q==null||q===false?q:q.toolbar)),q==null||q===false?q:q.size),{hash:{},inverse:l.noop,fn:l.program(1,j,o),data:o});if(q||q===0){n+=q}n+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+e(((q=((q=((q=(p&&p.locale)),q==null||q===false?q:q.emphasis)),q==null||q===false?q:q.small)),typeof q===f?q.apply(p):q))+"</a>\n    ";return n}a+='<li>\n  <div class="btn-group">\n    <a class="btn ';m=h["if"].call(d,((m=((m=(d&&d.options)),m==null||m===false?m:m.toolbar)),m==null||m===false?m:m.size),{hash:{},inverse:l.noop,fn:l.program(1,j,b),data:b});if(m||m===0){a+=m}a+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+e(((m=((m=((m=(d&&d.locale)),m==null||m===false?m:m.emphasis)),m==null||m===false?m:m.bold)),typeof m===f?m.apply(d):m))+'</a>\n    <a class="btn ';m=h["if"].call(d,((m=((m=(d&&d.options)),m==null||m===false?m:m.toolbar)),m==null||m===false?m:m.size),{hash:{},inverse:l.noop,fn:l.program(1,j,b),data:b});if(m||m===0){a+=m}a+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+e(((m=((m=((m=(d&&d.locale)),m==null||m===false?m:m.emphasis)),m==null||m===false?m:m.italic)),typeof m===f?m.apply(d):m))+'</a>\n    <a class="btn ';m=h["if"].call(d,((m=((m=(d&&d.options)),m==null||m===false?m:m.toolbar)),m==null||m===false?m:m.size),{hash:{},inverse:l.noop,fn:l.program(1,j,b),data:b});if(m||m===0){a+=m}a+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+e(((m=((m=((m=(d&&d.locale)),m==null||m===false?m:m.emphasis)),m==null||m===false?m:m.underline)),typeof m===f?m.apply(d):m))+"</a>\n    ";m=h["if"].call(d,((m=((m=((m=(d&&d.options)),m==null||m===false?m:m.toolbar)),m==null||m===false?m:m.emphasis)),m==null||m===false?m:m.small),{hash:{},inverse:l.noop,fn:l.program(3,k,b),data:b});if(m||m===0){a+=m}a+="\n  </div>\n</li>\n";return a});this["wysihtml5"]["tpl"]["font-styles"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",n,f="function",e=this.escapeExpression,m=this;function j(q,p){var o="",r;o+="btn-"+e(((r=((r=((r=(q&&q.options)),r==null||r===false?r:r.toolbar)),r==null||r===false?r:r.size)),typeof r===f?r.apply(q):r));return o}function k(p,o){return'\n      <span class="fa fa-font"></span>\n    '}function l(p,o){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '}a+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.size),{hash:{},inverse:m.noop,fn:m.program(1,j,b),data:b});if(n||n===0){a+=n}a+='" data-toggle="dropdown">\n    ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.fa),{hash:{},inverse:m.program(5,l,b),fn:m.program(3,k,b),data:b});if(n||n===0){a+=n}a+='\n    <span class="current-font">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.normal)),typeof n===f?n.apply(d):n))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.normal)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h1)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h2)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h3)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h4)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h5)),typeof n===f?n.apply(d):n))+'</a></li>\n    <li class="dropdown-item"><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.font_styles)),n==null||n===false?n:n.h6)),typeof n===f?n.apply(d):n))+"</a></li>\n  </ul>\n</li>\n";return a});this["wysihtml5"]["tpl"]["html"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",n,f="function",e=this.escapeExpression,m=this;function j(q,p){var o="",r;o+="btn-"+e(((r=((r=((r=(q&&q.options)),r==null||r===false?r:r.toolbar)),r==null||r===false?r:r.size)),typeof r===f?r.apply(q):r));return o}function k(p,o){return'\n        <span class="fa fa-pencil"></span>\n      '}function l(p,o){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '}a+='<li>\n  <div class="btn-group">\n    <a class="btn ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.size),{hash:{},inverse:m.noop,fn:m.program(1,j,b),data:b});if(n||n===0){a+=n}a+=' btn-default" data-wysihtml5-action="change_view" title="'+e(((n=((n=((n=(d&&d.locale)),n==null||n===false?n:n.html)),n==null||n===false?n:n.edit)),typeof n===f?n.apply(d):n))+'" tabindex="-1">\n      ';n=h["if"].call(d,((n=((n=(d&&d.options)),n==null||n===false?n:n.toolbar)),n==null||n===false?n:n.fa),{hash:{},inverse:m.program(5,l,b),fn:m.program(3,k,b),data:b});if(n||n===0){a+=n}a+="\n    </a>\n  </div>\n</li>\n";return a});this["wysihtml5"]["tpl"]["image"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",o,f="function",e=this.escapeExpression,n=this;function j(q,p){return"modal-sm"}function k(r,q){var p="",s;p+="btn-"+e(((s=((s=((s=(r&&r.options)),s==null||s===false?s:s.toolbar)),s==null||s===false?s:s.size)),typeof s===f?s.apply(r):s));return p}function l(q,p){return'\n      <span class="fa fa-file-image-o"></span>\n    '}function m(q,p){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '}a+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.smallmodals),{hash:{},inverse:n.noop,fn:n.program(1,j,b),data:b});if(o||o===0){a+=o}a+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.image)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.image)),o==null||o===false?o:o.cancel)),typeof o===f?o.apply(d):o))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.image)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.size),{hash:{},inverse:n.noop,fn:n.program(3,k,b),data:b});if(o||o===0){a+=o}a+=' btn-default" data-wysihtml5-command="insertImage" title="'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.image)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'" tabindex="-1">\n    ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.fa),{hash:{},inverse:n.program(7,m,b),fn:n.program(5,l,b),data:b});if(o||o===0){a+=o}a+="\n  </a>\n</li>\n";return a});this["wysihtml5"]["tpl"]["link"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",o,f="function",e=this.escapeExpression,n=this;function j(q,p){return"modal-sm"}function k(r,q){var p="",s;p+="btn-"+e(((s=((s=((s=(r&&r.options)),s==null||s===false?s:s.toolbar)),s==null||s===false?s:s.size)),typeof s===f?s.apply(r):s));return p}function l(q,p){return'\n      <span class="fa fa-share-square-o"></span>\n    '}function m(q,p){return'\n      <span class="glyphicon glyphicon-link"></span>\n    '}a+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.smallmodals),{hash:{},inverse:n.noop,fn:n.program(1,j,b),data:b});if(o||o===0){a+=o}a+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.link)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.link)),o==null||o===false?o:o.target)),typeof o===f?o.apply(d):o))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.link)),o==null||o===false?o:o.cancel)),typeof o===f?o.apply(d):o))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.link)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.size),{hash:{},inverse:n.noop,fn:n.program(3,k,b),data:b});if(o||o===0){a+=o}a+=' btn-default" data-wysihtml5-command="createLink" title="'+e(((o=((o=((o=(d&&d.locale)),o==null||o===false?o:o.link)),o==null||o===false?o:o.insert)),typeof o===f?o.apply(d):o))+'" tabindex="-1">\n    ';o=h["if"].call(d,((o=((o=(d&&d.options)),o==null||o===false?o:o.toolbar)),o==null||o===false?o:o.fa),{hash:{},inverse:n.program(7,m,b),fn:n.program(5,l,b),data:b});if(o||o===0){a+=o}a+="\n  </a>\n</li>\n";return a});this["wysihtml5"]["tpl"]["lists"]=Handlebars.template(function(g,d,h,i,b){this.compilerInfo=[4,">= 1.0.0"];h=this.merge(h,g.helpers);b=b||{};var a="",t,f="function",e=this.escapeExpression,s=this;function j(w,v){var u="",x;u+="btn-"+e(((x=((x=((x=(w&&w.options)),x==null||x===false?x:x.toolbar)),x==null||x===false?x:x.size)),typeof x===f?x.apply(w):x));return u}function o(v,u){return'\n      <span class="fa fa-list-ul"></span>\n    '}function p(v,u){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '}function q(v,u){return'\n      <span class="fa fa-list-ol"></span>\n    '}function r(v,u){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '}function k(v,u){return'\n      <span class="fa fa-outdent"></span>\n    '}function l(v,u){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '}function m(v,u){return'\n      <span class="fa fa-indent"></span>\n    '}function n(v,u){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '}a+='<li>\n  <div class="btn-group">\n    <a class="btn ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.size),{hash:{},inverse:s.noop,fn:s.program(1,j,b),data:b});if(t||t===0){a+=t}a+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+e(((t=((t=((t=(d&&d.locale)),t==null||t===false?t:t.lists)),t==null||t===false?t:t.unordered)),typeof t===f?t.apply(d):t))+'" tabindex="-1">\n    ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.fa),{hash:{},inverse:s.program(5,p,b),fn:s.program(3,o,b),data:b});if(t||t===0){a+=t}a+='\n    </a>\n    <a class="btn ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.size),{hash:{},inverse:s.noop,fn:s.program(1,j,b),data:b});if(t||t===0){a+=t}a+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+e(((t=((t=((t=(d&&d.locale)),t==null||t===false?t:t.lists)),t==null||t===false?t:t.ordered)),typeof t===f?t.apply(d):t))+'" tabindex="-1">\n    ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.fa),{hash:{},inverse:s.program(9,r,b),fn:s.program(7,q,b),data:b});if(t||t===0){a+=t}a+='\n    </a>\n    <a class="btn ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.size),{hash:{},inverse:s.noop,fn:s.program(1,j,b),data:b});if(t||t===0){a+=t}a+=' btn-default" data-wysihtml5-command="Outdent" title="'+e(((t=((t=((t=(d&&d.locale)),t==null||t===false?t:t.lists)),t==null||t===false?t:t.outdent)),typeof t===f?t.apply(d):t))+'" tabindex="-1">\n    ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.fa),{hash:{},inverse:s.program(13,l,b),fn:s.program(11,k,b),data:b});if(t||t===0){a+=t}a+='\n    </a>\n    <a class="btn ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.size),{hash:{},inverse:s.noop,fn:s.program(1,j,b),data:b});if(t||t===0){a+=t}a+=' btn-default" data-wysihtml5-command="Indent" title="'+e(((t=((t=((t=(d&&d.locale)),t==null||t===false?t:t.lists)),t==null||t===false?t:t.indent)),typeof t===f?t.apply(d):t))+'" tabindex="-1">\n    ';t=h["if"].call(d,((t=((t=(d&&d.options)),t==null||t===false?t:t.toolbar)),t==null||t===false?t:t.fa),{hash:{},inverse:s.program(17,n,b),fn:s.program(15,m,b),data:b});if(t||t===0){a+=t}a+="\n    </a>\n  </div>\n</li>\n";return a});(function(a){if(typeof define==="function"&&define.amd){define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],a)}else{a(jQuery,wysihtml5)}}(function(a,d){var b=function(e,j){var i=function(l,m,n){if(j.tpl[l]){return j.tpl[l]({locale:m,options:n})}};var k=function(l,m){this.el=l;var o=e.extend(true,{},f,m);for(var n in o.customTemplates){if(o.customTemplates.hasOwnProperty(n)){j.tpl[n]=o.customTemplates[n]}}this.toolbar=this.createToolbar(l,o);this.editor=this.createEditor(o)};k.prototype={constructor:k,createEditor:function(l){l=l||{};l=e.extend(true,{},l);l.toolbar=this.toolbar[0];this.initializeEditor(this.el[0],l)},initializeEditor:function(m,o){var l=new j.Editor(this.el[0],o);l.on("beforeload",this.syncBootstrapDialogEvents);l.on("beforeload",this.loadParserRules);if(l.composer.editableArea.contentDocument){this.addMoreShortcuts(l,l.composer.editableArea.contentDocument.body||l.composer.editableArea.contentDocument,o.shortcuts)}else{this.addMoreShortcuts(l,l.composer.editableArea,o.shortcuts)}if(o&&o.events){for(var n in o.events){if(o.events.hasOwnProperty(n)){l.on(n,o.events[n])}}}return l},loadParserRules:function(){if(e.type(this.config.parserRules)==="string"){e.ajax({dataType:"json",url:this.config.parserRules,context:this,error:function(m,n,l){console.log(l)},success:function(l){this.config.parserRules=l;console.log("parserrules loaded")}})}if(this.config.pasteParserRulesets&&e.type(this.config.pasteParserRulesets)==="string"){e.ajax({dataType:"json",url:this.config.pasteParserRulesets,context:this,error:function(m,n,l){console.log(l)},success:function(l){this.config.pasteParserRulesets=l}})}},syncBootstrapDialogEvents:function(){var l=this;e.map(this.toolbar.commandMapping,function(m){return[m]}).filter(function(m){return m.dialog}).map(function(m){return m.dialog}).forEach(function(m){m.on("show",function(){e(this.container).modal("show")});m.on("hide",function(){e(this.container).modal("hide");setTimeout(l.composer.focus,0)});e(m.container).on("shown.bs.modal",function(){e(this).find("input, select, textarea").first().focus()})});this.on("change_view",function(){e(this.toolbar.container.children).find("a.btn").not('[data-wysihtml5-action="change_view"]').toggleClass("disabled")})},createToolbar:function(m,p){var q=this;var r=e("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"});var l=p.locale||f.locale||"en";if(!g.hasOwnProperty(l)){console.debug("Locale '"+l+"' not found. Available locales are: "+Object.keys(g)+". Falling back to 'en'.");l="en"}var o=e.extend(true,{},g.en,g[l]);for(var n in p.toolbar){if(p.toolbar[n]){r.append(i(n,o,p))}}r.find('a[data-wysihtml5-command="formatBlock"]').click(function(s){var w=s.delegateTarget||s.target||s.srcElement,t=e(w),v=t.data("wysihtml5-display-format-name"),u=t.data("wysihtml5-format-name")||t.html();if(v===undefined||v==="true"){q.toolbar.find(".current-font").text(u)}});r.find('a[data-wysihtml5-command="foreColor"]').click(function(s){var u=s.target||s.srcElement;var t=e(u);q.toolbar.find(".current-color").text(t.html())});this.el.before(r);return r},addMoreShortcuts:function(l,m,n){j.dom.observe(m,"keydown",function(q){var r=q.keyCode,o=n[r];if((q.ctrlKey||q.metaKey||q.altKey)&&o&&j.commands[o]){var p=l.toolbar.commandMapping[o+":null"];if(p&&p.dialog&&!p.state){p.dialog.show()}else{j.commands[o].exec(l.composer,o)}q.preventDefault()}})}};var h={resetDefaults:function(){e.fn.wysihtml5.defaultOptions=e.extend(true,{},e.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(l){return this.each(function(){var m=e(this);m.data("wysihtml5",new k(m,l))})},shallowExtend:function(l){var m=e.extend({},e.fn.wysihtml5.defaultOptions,l||{},e(this).data());var n=this;return h.bypassDefaults.apply(n,[m])},deepExtend:function(l){var m=e.extend(true,{},e.fn.wysihtml5.defaultOptions,l||{});var n=this;return h.bypassDefaults.apply(n,[m])},init:function(l){var m=this;return h.shallowExtend.apply(m,[l])}};e.fn.wysihtml5=function(l){if(h[l]){return h[l].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof l==="object"||!l){return h.init.apply(this,arguments)}else{e.error("Method "+l+" does not exist on jQuery.wysihtml5")}}};e.fn.wysihtml5.Constructor=k;var f=e.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":true,color:false,emphasis:{small:true},blockquote:true,lists:true,html:false,link:true,image:true,smallmodals:false},useLineBreaks:false,parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{"83":"small","75":"createLink"}};if(typeof e.fn.wysihtml5.defaultOptionsCache==="undefined"){e.fn.wysihtml5.defaultOptionsCache=e.extend(true,{},e.fn.wysihtml5.defaultOptions)}var g=e.fn.wysihtml5.locale={}};b(a,d)}));(function(a){a.commands.small={exec:function(d,b){return a.commands.formatInline.exec(d,b,"small")},state:function(d,b){return a.commands.formatInline.state(d,b,"small")}}})(wysihtml5);(function(a){if(typeof define==="function"&&define.amd){define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],a)}else{a(jQuery)}}(function(a){a.fn.wysihtml5.locale.en=a.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}));