(function(a,b,c,i){var d=a.fn.peity=function(k,j){if(h){this.each(function(){var l=a(this);var m=l.data("_peity");if(m){if(k){m.type=k}a.extend(m.opts,j)}else{m=new e(l,k,a.extend({},d.defaults[k],l.data("peity"),j));l.change(function(){m.draw()}).data("_peity",m)}m.draw()})}return this};var e=function(j,l,k){this.$el=j;this.type=l;this.opts=k};var f=e.prototype;var g=f.svgElement=function(k,j){return a(b.createElementNS("http://www.w3.org/2000/svg",k)).attr(j)};var h="createElementNS" in b&&g("svg",{})[0].createSVGRect;f.draw=function(){var j=this.opts;d.graphers[this.type].call(this,j);if(j.after){j.after.call(this,j)}};f.fill=function(){var j=this.opts.fill;return a.isFunction(j)?j:function(k,l){return j[l%j.length]}};f.prepare=function(k,j){if(!this.$svg){this.$el.hide().after(this.$svg=g("svg",{"class":"peity"}))}return this.$svg.empty().data("peity",this).attr({height:j,width:k})};f.values=function(){return a.map(this.$el.text().split(this.opts.delimiter),function(j){return parseFloat(j)})};d.defaults={};d.graphers={};d.register=function(l,j,k){this.defaults[l]=j;this.graphers[l]=k};d.register("pie",{fill:["#ff9900","#fff4dd","#ffc66e"],radius:8},function(x){if(!x.delimiter){var q=this.$el.text().match(/[^0-9\.]/);x.delimiter=q?q[0]:","}var G=a.map(this.values(),function(L){return L>0?L:0});if(x.delimiter=="/"){var D=G[0];var E=G[1];G=[D,c.max(0,E-D)]}var u=0;var w=G.length;var C=0;for(;u<w;u++){C+=G[u]}if(!C){w=2;C=1;G=[0,1]}var r=x.radius*2;var k=this.prepare(x.width||r,x.height||r);var H=k.width(),t=k.height(),n=H/2,o=t/2;var A=c.min(n,o),v=x.innerRadius;if(this.type=="donut"&&!v){v=A*0.5}var y=c.PI;var s=this.fill();var B=this.scale=function(N,M){var L=N/C*y*2-y/2;return[M*c.cos(L)+n,M*c.sin(L)+o]};var l=0;for(u=0;u<w;u++){var F=G[u],z=F/C,j;if(z==0){continue}if(z==1){if(v){var I=n-0.01,J=o-A,K=o-v;j=g("path",{d:["M",n,J,"A",A,A,0,1,1,I,J,"L",I,K,"A",v,v,0,1,0,n,K].join(" ")})}else{j=g("circle",{cx:n,cy:o,r:A})}}else{var m=l+F;var p=["M"].concat(B(l,A),"A",A,A,0,z>0.5?1:0,1,B(m,A),"L");if(v){p=p.concat(B(m,v),"A",v,v,0,z>0.5?1:0,0,B(l,v))}else{p.push(n,o)}l+=F;j=g("path",{d:p.join(" ")})}j.attr("fill",s.call(this,F,u,G));k.append(j)}});d.register("donut",a.extend(true,{},d.defaults.pie),function(j){d.graphers.pie.call(this,j)});d.register("line",{delimiter:",",fill:"#c6d9fd",height:16,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(q){var s=this.values();if(s.length==1){s.push(s[0])}var o=c.max.apply(c,q.max==i?s:s.concat(q.max)),p=c.min.apply(c,q.min==i?s:s.concat(q.min));var j=this.prepare(q.width,q.height),r=q.strokeWidth,t=j.width(),m=j.height()-r,l=o-p;var u=this.x=function(x){return x*(t/(s.length-1))};var v=this.y=function(x){var z=m;if(l){z-=((x-p)/l)*m}return z+r/2};var w=v(c.max(p,0)),k=[0,w];for(var n=0;n<s.length;n++){k.push(u(n),v(s[n]))}k.push(t,w);if(q.fill){j.append(g("polygon",{fill:q.fill,points:k.join(" ")}))}if(r){j.append(g("polyline",{fill:"none",points:k.slice(2,k.length-2).join(" "),stroke:q.stroke,"stroke-width":r,"stroke-linecap":"square"}))}});d.register("bar",{delimiter:",",fill:["#4D89F9"],height:16,min:0,padding:0.1,width:32},function(r){var u=this.values(),p=c.max.apply(c,r.max==i?u:u.concat(r.max)),q=c.min.apply(c,r.min==i?u:u.concat(r.min));var j=this.prepare(r.width,r.height),z=j.width(),n=j.height(),k=p-q,s=r.padding,l=this.fill();var B=this.x=function(w){return w*z/u.length};var E=this.y=function(w){return n-(k?((w-q)/k)*n:1)};for(var o=0;o<u.length;o++){var A=B(o+s),y=B(o+1-s)-A,t=u[o],v=E(t),C=v,D=v,m;if(!k){m=1}else{if(t<0){C=E(c.min(p,0))}else{D=E(c.max(q,0))}}m=D-C;if(m==0){m=1;if(p>0&&k){C--}}j.append(g("rect",{fill:l.call(this,t,o,u),x:A,y:C,width:y,height:m}))}})})(jQuery,document,Math);